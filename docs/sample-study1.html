<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas E. Love">
<meta name="dcterms.date" content="2024-10-29">

<title>431 Project B Sample Study 1 Report – 431 Project B</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">431 Project B</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-the-data" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">The Data</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-the-data">    
        <li>
    <a class="dropdown-item" href="./data1.html">
 <span class="dropdown-text">Data Development</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./data2.html">
 <span class="dropdown-text">Using NHANES data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./data3.html">
 <span class="dropdown-text">Using Something Else</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./register.html"> 
<span class="menu-text">Registration</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-study-1" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Study 1</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-study-1">    
        <li>
    <a class="dropdown-item" href="./study1a.html">
 <span class="dropdown-text">Required Study 1 Analyses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./study1b.html">
 <span class="dropdown-text">Study 1 Report Specifications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./study1c.html">
 <span class="dropdown-text">Study 1 Sample Report</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-study-2" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Study 2</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-study-2">    
        <li>
    <a class="dropdown-item" href="./study2a.html">
 <span class="dropdown-text">Required Study 2 Analyses</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./study2b.html">
 <span class="dropdown-text">Study 2 Report Specifications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./study2c.html">
 <span class="dropdown-text">Study 2 Sample Report</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./self_eval.html"> 
<span class="menu-text">Self-Evaluation</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./checklist.html"> 
<span class="menu-text">Checklist</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./tipsheet.html"> 
<span class="menu-text">Tip Sheet</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://thomaselove.github.io/431-2024/contact.html"> 
<span class="menu-text">Contact Us</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://thomaselove.github.io/431-2024"> 
<span class="menu-text">431 Homepage</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup-and-data-ingest" id="toc-setup-and-data-ingest" class="nav-link active" data-scroll-target="#setup-and-data-ingest"><span class="header-section-number">1</span> Setup and Data Ingest</a>
  <ul class="collapse">
  <li><a href="#initial-setup-and-package-loads" id="toc-initial-setup-and-package-loads" class="nav-link" data-scroll-target="#initial-setup-and-package-loads"><span class="header-section-number">1.1</span> Initial Setup and Package Loads</a></li>
  <li><a href="#loading-the-raw-data-into-r" id="toc-loading-the-raw-data-into-r" class="nav-link" data-scroll-target="#loading-the-raw-data-into-r"><span class="header-section-number">1.2</span> Loading the Raw Data into R</a></li>
  <li><a href="#contents-of-the-raw-tibbles" id="toc-contents-of-the-raw-tibbles" class="nav-link" data-scroll-target="#contents-of-the-raw-tibbles"><span class="header-section-number">1.3</span> Contents of the Raw Tibbles</a></li>
  <li><a href="#two-merging-steps" id="toc-two-merging-steps" class="nav-link" data-scroll-target="#two-merging-steps"><span class="header-section-number">1.4</span> Two Merging Steps</a></li>
  <li><a href="#checking-the-merge" id="toc-checking-the-merge" class="nav-link" data-scroll-target="#checking-the-merge"><span class="header-section-number">1.5</span> Checking the Merge</a></li>
  <li><a href="#selecting-only-the-variables-well-use" id="toc-selecting-only-the-variables-well-use" class="nav-link" data-scroll-target="#selecting-only-the-variables-well-use"><span class="header-section-number">1.6</span> Selecting only the variables we’ll use</a></li>
  </ul></li>
  <li><a href="#cleaning-the-data" id="toc-cleaning-the-data" class="nav-link" data-scroll-target="#cleaning-the-data"><span class="header-section-number">2</span> Cleaning the Data</a>
  <ul class="collapse">
  <li><a href="#our-survey-items" id="toc-our-survey-items" class="nav-link" data-scroll-target="#our-survey-items"><span class="header-section-number">2.1</span> Our Survey Items</a>
  <ul class="collapse">
  <li><a href="#rating-variables" id="toc-rating-variables" class="nav-link" data-scroll-target="#rating-variables"><span class="header-section-number">2.1.1</span> Rating Variables</a></li>
  <li><a href="#other-quantitative-variables" id="toc-other-quantitative-variables" class="nav-link" data-scroll-target="#other-quantitative-variables"><span class="header-section-number">2.1.2</span> Other Quantitative Variables</a></li>
  <li><a href="#binary-variables" id="toc-binary-variables" class="nav-link" data-scroll-target="#binary-variables"><span class="header-section-number">2.1.3</span> Binary Variables</a></li>
  <li><a href="#multi-categorical-variables" id="toc-multi-categorical-variables" class="nav-link" data-scroll-target="#multi-categorical-variables"><span class="header-section-number">2.1.4</span> Multi-Categorical Variables</a></li>
  </ul></li>
  <li><a href="#checking-our-quantitative-variables" id="toc-checking-our-quantitative-variables" class="nav-link" data-scroll-target="#checking-our-quantitative-variables"><span class="header-section-number">2.2</span> Checking our Quantitative Variables</a>
  <ul class="collapse">
  <li><a href="#combining-height-and-weight-into-bmi-and-specifying-na-for-implausible-values" id="toc-combining-height-and-weight-into-bmi-and-specifying-na-for-implausible-values" class="nav-link" data-scroll-target="#combining-height-and-weight-into-bmi-and-specifying-na-for-implausible-values"><span class="header-section-number">2.2.1</span> Combining <code>height</code> and <code>weight</code> into <code>bmi</code> and Specifying <code>NA</code> for Implausible Values</a></li>
  </ul></li>
  <li><a href="#checking-our-binary-variables" id="toc-checking-our-binary-variables" class="nav-link" data-scroll-target="#checking-our-binary-variables"><span class="header-section-number">2.3</span> Checking our Binary Variables</a></li>
  <li><a href="#checking-our-multi-category-variables" id="toc-checking-our-multi-category-variables" class="nav-link" data-scroll-target="#checking-our-multi-category-variables"><span class="header-section-number">2.4</span> Checking our Multi-Category Variables</a>
  <ul class="collapse">
  <li><a href="#the-grades-variable" id="toc-the-grades-variable" class="nav-link" data-scroll-target="#the-grades-variable"><span class="header-section-number">2.4.1</span> The <code>grades</code> variable</a></li>
  <li><a href="#the-medium-variable" id="toc-the-medium-variable" class="nav-link" data-scroll-target="#the-medium-variable"><span class="header-section-number">2.4.2</span> The <code>medium</code> variable</a></li>
  <li><a href="#the-fiction-variable" id="toc-the-fiction-variable" class="nav-link" data-scroll-target="#the-fiction-variable"><span class="header-section-number">2.4.3</span> The <code>fiction</code> variable</a></li>
  <li><a href="#collapsing-and-recoding-levels-of-fiction" id="toc-collapsing-and-recoding-levels-of-fiction" class="nav-link" data-scroll-target="#collapsing-and-recoding-levels-of-fiction"><span class="header-section-number">2.4.4</span> Collapsing and recoding levels of <code>fiction</code></a></li>
  </ul></li>
  <li><a href="#creating-our-analytic-tibble" id="toc-creating-our-analytic-tibble" class="nav-link" data-scroll-target="#creating-our-analytic-tibble"><span class="header-section-number">2.5</span> Creating our Analytic Tibble</a></li>
  <li><a href="#list-of-missing-values" id="toc-list-of-missing-values" class="nav-link" data-scroll-target="#list-of-missing-values"><span class="header-section-number">2.6</span> List of Missing Values</a></li>
  </ul></li>
  <li><a href="#codebook-and-data-description" id="toc-codebook-and-data-description" class="nav-link" data-scroll-target="#codebook-and-data-description"><span class="header-section-number">3</span> Codebook and Data Description</a>
  <ul class="collapse">
  <li><a href="#variable-descriptions" id="toc-variable-descriptions" class="nav-link" data-scroll-target="#variable-descriptions"><span class="header-section-number">3.1</span> Variable Descriptions</a></li>
  <li><a href="#analytic-tibble" id="toc-analytic-tibble" class="nav-link" data-scroll-target="#analytic-tibble"><span class="header-section-number">3.2</span> Analytic Tibble</a></li>
  <li><a href="#data-summary" id="toc-data-summary" class="nav-link" data-scroll-target="#data-summary"><span class="header-section-number">3.3</span> Data Summary</a>
  <ul class="collapse">
  <li><a href="#data_description" id="toc-data_description" class="nav-link" data-scroll-target="#data_description"><span class="header-section-number">3.3.1</span> <code>data_description()</code></a></li>
  <li><a href="#data_codebook" id="toc-data_codebook" class="nav-link" data-scroll-target="#data_codebook"><span class="header-section-number">3.3.2</span> <code>data_codebook()</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#analysis-a-compare-2-population-means-using-paired-samples" id="toc-analysis-a-compare-2-population-means-using-paired-samples" class="nav-link" data-scroll-target="#analysis-a-compare-2-population-means-using-paired-samples"><span class="header-section-number">4</span> Analysis A: Compare 2 Population Means using Paired Samples</a>
  <ul class="collapse">
  <li><a href="#the-question" id="toc-the-question" class="nav-link" data-scroll-target="#the-question"><span class="header-section-number">4.1</span> The Question</a></li>
  <li><a href="#describing-the-data" id="toc-describing-the-data" class="nav-link" data-scroll-target="#describing-the-data"><span class="header-section-number">4.2</span> Describing the Data</a>
  <ul class="collapse">
  <li><a href="#compute-and-summarize-the-paired-differences" id="toc-compute-and-summarize-the-paired-differences" class="nav-link" data-scroll-target="#compute-and-summarize-the-paired-differences"><span class="header-section-number">4.2.1</span> Compute and summarize the paired differences</a></li>
  <li><a href="#graphical-summaries-to-assess-normality" id="toc-graphical-summaries-to-assess-normality" class="nav-link" data-scroll-target="#graphical-summaries-to-assess-normality"><span class="header-section-number">4.2.2</span> Graphical Summaries to Assess Normality</a></li>
  <li><a href="#did-pairing-help-reduce-nuisance-variation" id="toc-did-pairing-help-reduce-nuisance-variation" class="nav-link" data-scroll-target="#did-pairing-help-reduce-nuisance-variation"><span class="header-section-number">4.2.3</span> Did Pairing Help Reduce Nuisance Variation?</a></li>
  </ul></li>
  <li><a href="#main-analysis" id="toc-main-analysis" class="nav-link" data-scroll-target="#main-analysis"><span class="header-section-number">4.3</span> Main Analysis</a>
  <ul class="collapse">
  <li><a href="#the-paired-t-test-approach" id="toc-the-paired-t-test-approach" class="nav-link" data-scroll-target="#the-paired-t-test-approach"><span class="header-section-number">4.3.1</span> The Paired t test approach</a></li>
  <li><a href="#the-wilcoxon-signed-rank-test-approach" id="toc-the-wilcoxon-signed-rank-test-approach" class="nav-link" data-scroll-target="#the-wilcoxon-signed-rank-test-approach"><span class="header-section-number">4.3.2</span> The Wilcoxon signed rank test approach</a></li>
  <li><a href="#the-bootstrap-approach-for-the-mean-from-paired-samples" id="toc-the-bootstrap-approach-for-the-mean-from-paired-samples" class="nav-link" data-scroll-target="#the-bootstrap-approach-for-the-mean-from-paired-samples"><span class="header-section-number">4.3.3</span> The Bootstrap approach for the mean from paired samples</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">4.4</span> Conclusions</a></li>
  </ul></li>
  <li><a href="#analysis-b-compare-2-population-means-using-independent-samples" id="toc-analysis-b-compare-2-population-means-using-independent-samples" class="nav-link" data-scroll-target="#analysis-b-compare-2-population-means-using-independent-samples"><span class="header-section-number">5</span> Analysis B: Compare 2 Population Means using Independent Samples</a>
  <ul class="collapse">
  <li><a href="#the-question-1" id="toc-the-question-1" class="nav-link" data-scroll-target="#the-question-1"><span class="header-section-number">5.1</span> The Question</a></li>
  <li><a href="#describing-the-data-1" id="toc-describing-the-data-1" class="nav-link" data-scroll-target="#describing-the-data-1"><span class="header-section-number">5.2</span> Describing the Data</a>
  <ul class="collapse">
  <li><a href="#a-new-data-set-including-only-those-with-bmi-data" id="toc-a-new-data-set-including-only-those-with-bmi-data" class="nav-link" data-scroll-target="#a-new-data-set-including-only-those-with-bmi-data"><span class="header-section-number">5.2.1</span> A New Data Set including only those with <code>bmi</code> data</a></li>
  <li><a href="#graphical-summaries" id="toc-graphical-summaries" class="nav-link" data-scroll-target="#graphical-summaries"><span class="header-section-number">5.2.2</span> Graphical Summaries</a></li>
  <li><a href="#numerical-summaries" id="toc-numerical-summaries" class="nav-link" data-scroll-target="#numerical-summaries"><span class="header-section-number">5.2.3</span> Numerical Summaries</a></li>
  </ul></li>
  <li><a href="#main-analysis-1" id="toc-main-analysis-1" class="nav-link" data-scroll-target="#main-analysis-1"><span class="header-section-number">5.3</span> Main Analysis</a>
  <ul class="collapse">
  <li><a href="#the-welchs-t-test-approach" id="toc-the-welchs-t-test-approach" class="nav-link" data-scroll-target="#the-welchs-t-test-approach"><span class="header-section-number">5.3.1</span> The Welch’s t test approach</a></li>
  <li><a href="#the-pooled-t-test-t-test-with-equal-variances" id="toc-the-pooled-t-test-t-test-with-equal-variances" class="nav-link" data-scroll-target="#the-pooled-t-test-t-test-with-equal-variances"><span class="header-section-number">5.3.2</span> The Pooled t test (t test with equal variances)</a></li>
  <li><a href="#the-wilcoxon-mann-whitney-rank-sum-test" id="toc-the-wilcoxon-mann-whitney-rank-sum-test" class="nav-link" data-scroll-target="#the-wilcoxon-mann-whitney-rank-sum-test"><span class="header-section-number">5.3.3</span> The Wilcoxon-Mann-Whitney rank sum test</a></li>
  <li><a href="#the-bootstrap-for-comparing-means-from-two-independent-samples" id="toc-the-bootstrap-for-comparing-means-from-two-independent-samples" class="nav-link" data-scroll-target="#the-bootstrap-for-comparing-means-from-two-independent-samples"><span class="header-section-number">5.3.4</span> The Bootstrap for comparing means from two independent samples</a></li>
  </ul></li>
  <li><a href="#conclusions-1" id="toc-conclusions-1" class="nav-link" data-scroll-target="#conclusions-1"><span class="header-section-number">5.4</span> Conclusions</a></li>
  </ul></li>
  <li><a href="#analysis-c-comparing-3-population-means-via-anova" id="toc-analysis-c-comparing-3-population-means-via-anova" class="nav-link" data-scroll-target="#analysis-c-comparing-3-population-means-via-anova"><span class="header-section-number">6</span> Analysis C: Comparing 3+ Population Means via ANOVA</a>
  <ul class="collapse">
  <li><a href="#the-question-2" id="toc-the-question-2" class="nav-link" data-scroll-target="#the-question-2"><span class="header-section-number">6.1</span> The Question</a></li>
  <li><a href="#describing-the-data-2" id="toc-describing-the-data-2" class="nav-link" data-scroll-target="#describing-the-data-2"><span class="header-section-number">6.2</span> Describing the Data</a>
  <ul class="collapse">
  <li><a href="#dropping-the-subject-with-a-missing-grades_r-value" id="toc-dropping-the-subject-with-a-missing-grades_r-value" class="nav-link" data-scroll-target="#dropping-the-subject-with-a-missing-grades_r-value"><span class="header-section-number">6.2.1</span> Dropping the subject with a missing <code>grades_r</code> value</a></li>
  <li><a href="#graphical-summaries-1" id="toc-graphical-summaries-1" class="nav-link" data-scroll-target="#graphical-summaries-1"><span class="header-section-number">6.2.2</span> Graphical Summaries</a></li>
  <li><a href="#numerical-summaries-1" id="toc-numerical-summaries-1" class="nav-link" data-scroll-target="#numerical-summaries-1"><span class="header-section-number">6.2.3</span> Numerical Summaries</a></li>
  </ul></li>
  <li><a href="#main-analysis-2" id="toc-main-analysis-2" class="nav-link" data-scroll-target="#main-analysis-2"><span class="header-section-number">6.3</span> Main Analysis</a>
  <ul class="collapse">
  <li><a href="#kruskal-wallis-test" id="toc-kruskal-wallis-test" class="nav-link" data-scroll-target="#kruskal-wallis-test"><span class="header-section-number">6.3.1</span> Kruskal-Wallis Test</a></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance"><span class="header-section-number">6.3.2</span> Analysis of Variance</a></li>
  <li><a href="#holm-approach-to-pairwise-comparisons-of-means" id="toc-holm-approach-to-pairwise-comparisons-of-means" class="nav-link" data-scroll-target="#holm-approach-to-pairwise-comparisons-of-means"><span class="header-section-number">6.3.3</span> Holm approach to Pairwise Comparisons of Means</a></li>
  <li><a href="#tukeys-honestly-significant-differences-approach-to-pairwise-comparisons-of-means" id="toc-tukeys-honestly-significant-differences-approach-to-pairwise-comparisons-of-means" class="nav-link" data-scroll-target="#tukeys-honestly-significant-differences-approach-to-pairwise-comparisons-of-means"><span class="header-section-number">6.3.4</span> Tukey’s Honestly Significant Differences approach to Pairwise Comparisons of Means</a></li>
  </ul></li>
  <li><a href="#conclusions-2" id="toc-conclusions-2" class="nav-link" data-scroll-target="#conclusions-2"><span class="header-section-number">6.4</span> Conclusions</a></li>
  </ul></li>
  <li><a href="#analysis-d-two-way-2-x-2-contingency-table" id="toc-analysis-d-two-way-2-x-2-contingency-table" class="nav-link" data-scroll-target="#analysis-d-two-way-2-x-2-contingency-table"><span class="header-section-number">7</span> Analysis D: Two-Way (2 x 2) Contingency Table</a>
  <ul class="collapse">
  <li><a href="#the-question-3" id="toc-the-question-3" class="nav-link" data-scroll-target="#the-question-3"><span class="header-section-number">7.1</span> The Question</a></li>
  <li><a href="#describing-the-data-3" id="toc-describing-the-data-3" class="nav-link" data-scroll-target="#describing-the-data-3"><span class="header-section-number">7.2</span> Describing the Data</a></li>
  <li><a href="#main-analysis-3" id="toc-main-analysis-3" class="nav-link" data-scroll-target="#main-analysis-3"><span class="header-section-number">7.3</span> Main Analysis</a>
  <ul class="collapse">
  <li><a href="#checking-assumptions" id="toc-checking-assumptions" class="nav-link" data-scroll-target="#checking-assumptions"><span class="header-section-number">7.3.1</span> Checking Assumptions</a></li>
  <li><a href="#what-if-we-wanted-to-type-in-the-table-ourselves" id="toc-what-if-we-wanted-to-type-in-the-table-ourselves" class="nav-link" data-scroll-target="#what-if-we-wanted-to-type-in-the-table-ourselves"><span class="header-section-number">7.3.2</span> What If We Wanted to Type in the Table Ourselves?</a></li>
  </ul></li>
  <li><a href="#conclusions-3" id="toc-conclusions-3" class="nav-link" data-scroll-target="#conclusions-3"><span class="header-section-number">7.4</span> Conclusions</a></li>
  </ul></li>
  <li><a href="#analysis-e-two-way-3-x-4-contingency-table" id="toc-analysis-e-two-way-3-x-4-contingency-table" class="nav-link" data-scroll-target="#analysis-e-two-way-3-x-4-contingency-table"><span class="header-section-number">8</span> Analysis E: Two-Way (3 x 4) Contingency Table</a>
  <ul class="collapse">
  <li><a href="#the-question-4" id="toc-the-question-4" class="nav-link" data-scroll-target="#the-question-4"><span class="header-section-number">8.1</span> The Question</a></li>
  <li><a href="#describing-the-data-4" id="toc-describing-the-data-4" class="nav-link" data-scroll-target="#describing-the-data-4"><span class="header-section-number">8.2</span> Describing the Data</a></li>
  <li><a href="#main-analysis-4" id="toc-main-analysis-4" class="nav-link" data-scroll-target="#main-analysis-4"><span class="header-section-number">8.3</span> Main Analysis</a>
  <ul class="collapse">
  <li><a href="#running-the-pearson-chi2-test" id="toc-running-the-pearson-chi2-test" class="nav-link" data-scroll-target="#running-the-pearson-chi2-test"><span class="header-section-number">8.3.1</span> Running the Pearson <span class="math inline">\(\chi^2\)</span> Test</a></li>
  <li><a href="#running-fishers-exact-test" id="toc-running-fishers-exact-test" class="nav-link" data-scroll-target="#running-fishers-exact-test"><span class="header-section-number">8.3.2</span> Running Fisher’s Exact Test</a></li>
  <li><a href="#checking-assumptions---the-cochran-conditions" id="toc-checking-assumptions---the-cochran-conditions" class="nav-link" data-scroll-target="#checking-assumptions---the-cochran-conditions"><span class="header-section-number">8.3.3</span> Checking Assumptions - The Cochran Conditions</a></li>
  <li><a href="#an-association-plot-for-the-3x4-table" id="toc-an-association-plot-for-the-3x4-table" class="nav-link" data-scroll-target="#an-association-plot-for-the-3x4-table"><span class="header-section-number">8.3.4</span> An Association Plot for the 3x4 Table</a></li>
  <li><a href="#a-2x3-table-after-collapsing-lumping-some-small-rows-and-columns" id="toc-a-2x3-table-after-collapsing-lumping-some-small-rows-and-columns" class="nav-link" data-scroll-target="#a-2x3-table-after-collapsing-lumping-some-small-rows-and-columns"><span class="header-section-number">8.3.5</span> A 2x3 Table, After Collapsing (Lumping) Some Small Rows and Columns</a></li>
  <li><a href="#chi-square-testing-for-the-2x3-table" id="toc-chi-square-testing-for-the-2x3-table" class="nav-link" data-scroll-target="#chi-square-testing-for-the-2x3-table"><span class="header-section-number">8.3.6</span> Chi-Square Testing for the 2x3 Table</a></li>
  </ul></li>
  <li><a href="#conclusions-4" id="toc-conclusions-4" class="nav-link" data-scroll-target="#conclusions-4"><span class="header-section-number">8.4</span> Conclusions</a></li>
  </ul></li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information"><span class="header-section-number">9</span> Session Information</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">431 Project B Sample Study 1 Report</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas E. Love </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2024-10-29</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reminders from Dr.&nbsp;Love
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Remember that each subsection should include at least one complete sentence explaining what you are doing, specifying the variables you are using and how you are using them, and then conclude with at least one complete sentence of discussion of the key conclusions you draw from the current step, and a discussion of any limitations you can describe that apply to the results.</p></li>
<li><p>If you want to download the Quarto code I used to create this document, click on the Code button near the title of this Sample Study.</p></li>
<li><p>DO NOT use my words (other than the section and subsection headings) included in this sample report in your project. Rewrite everything to make it relevant to your situation. Do not repeat my instructions back to me.</p></li>
</ol>
</div>
</div>
<section id="setup-and-data-ingest" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setup and Data Ingest</h1>
<section id="initial-setup-and-package-loads" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="initial-setup-and-package-loads"><span class="header-section-number">1.1</span> Initial Setup and Package Loads</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Epi)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xfun)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Love-431 script </span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"data/Love-431.R"</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Global options</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment=</span><span class="cn">NA</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-raw-data-into-r" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="loading-the-raw-data-into-r"><span class="header-section-number">1.2</span> Loading the Raw Data into R</h2>
<p>This document demonstrates a variety of things required in your Project B Study 1. We will demonstrate ideas using data from a 2015 class survey, gathered in three data files available on the <a href="https://github.com/THOMASELOVE/431-data/tree/main/data-and-code">431-data website</a>. The files are called:</p>
<ul>
<li><code>projectB-study1-demo-survey-2015a.xlsx</code></li>
<li><code>projectB-study1-demo-survey-2015b.csv</code></li>
<li><code>projectB-study1-demo-survey-2015c.csv</code></li>
</ul>
<p>After merging, the complete data set should include data on 21 variables for 53 subjects.</p>
<ul>
<li>I’m going to use <code>clean_names()</code> from the <code>janitor</code> package before I do the merging. It would also be OK to do this after the merge is complete.</li>
<li>I’m also going to tell R to interpret both a blank “” and an “NA” in a cell of the Excel sheet as indicating a missing value, since that’s what I need, and since that’s what <code>read_csv</code> already does, by default.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sur15_raw_a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/projectB-study1-demo-survey-2015a.xlsx"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>sur15_raw_b <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/projectB-study1-demo-survey-2015b.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>sur15_raw_c <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/projectB-study1-demo-survey-2015c.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="contents-of-the-raw-tibbles" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="contents-of-the-raw-tibbles"><span class="header-section-number">1.3</span> Contents of the Raw Tibbles</h2>
<p>We have three tibbles now, which (once we have merged them together) will contain complete data on all 53 subjects for all 21 variables.</p>
<ul>
<li><code>sur15_raw_a</code> contains data on all 21 variables for the first 20 subjects.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20 21</code></pre>
</div>
</div>
<ul>
<li><code>sur15_raw_b</code> contains data on 9 of the variables (including the subject ID code: <code>s.id</code>) for the other 33 subjects.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33  9</code></pre>
</div>
</div>
<ul>
<li><code>sur15_raw_c</code> contains data on 13 of the variables (also including the subject ID code: <code>s.id</code>) for the same 33 subjects that are in <code>sur15_raw_b</code>.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33 13</code></pre>
</div>
</div>
</section>
<section id="two-merging-steps" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="two-merging-steps"><span class="header-section-number">1.4</span> Two Merging Steps</h2>
<ol type="1">
<li>Join the columns in <code>sur15_raw_b</code> and in <code>sur15_raw_c</code> to obtain a new tibble, which I’ll call <code>sur15_last33</code>, holding information on all 21 variables for the last 33 subjects.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sur15_last33 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(sur15_raw_b, sur15_raw_c, <span class="at">by =</span> <span class="st">"s_id"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_last33)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 33 21</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Combine the rows together from <code>sur15_raw_a</code> (which has the first 20 subjects) and <code>sur15_last33</code> (which has the other 33 subjects) to create a tibble called <code>sur15_merged</code> which has all 21 variables for all 53 subjects.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sur15_merge <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sur15_raw_a, sur15_last33)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_merge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53 21</code></pre>
</div>
</div>
<p>OK. We have 53 subjects and 21 variables, as expected.</p>
</section>
<section id="checking-the-merge" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="checking-the-merge"><span class="header-section-number">1.5</span> Checking the Merge</h2>
<p>We need to perform two checks here.</p>
<ol type="1">
<li>First, we should check to ensure that the number of distinct (unique) subject identification codes (shown below) matches the number of rows. Those two values should be identical. Are they?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">n_distinct</span>(sur15_merge<span class="sc">$</span>s_id), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>          sur15_merge <span class="sc">|&gt;</span> <span class="fu">nrow</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Excellent.</p>
<ol start="2" type="1">
<li>Second, we should also check that we haven’t added any new variables. The <code>sur15_raw_a</code> tibble included all of the variable names we should have in the final result. Do the names in <code>sur15_raw_a</code> match the names in our merged tibble exactly?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">names</span>(sur15_merge), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">names</span>(sur15_raw_a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>All right. Our merge was successful.</p>
</section>
<section id="selecting-only-the-variables-well-use" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="selecting-only-the-variables-well-use"><span class="header-section-number">1.6</span> Selecting only the variables we’ll use</h2>
<p>The <code>sur15_merge</code> data includes some variables we don’t need, so we’ll prune down to the 11 variables we’ll actually use in the analyses we’ll do. This should certainly include the subject identification code, so we’ll include that, and also switch it to a character representation instead of numeric.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_merge <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">s_id =</span> <span class="fu">as.character</span>(s_id)) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s_id, r_pre, r_now, height, weight, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>         comfort_431, grades, r_before, english, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         medium, fiction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cleaning-the-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Cleaning the Data</h1>
<section id="our-survey-items" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="our-survey-items"><span class="header-section-number">2.1</span> Our Survey Items</h2>
<p>The 10 survey items that we will actually use in this demonstration are listed below.</p>
<section id="rating-variables" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="rating-variables"><span class="header-section-number">2.1.1</span> Rating Variables</h3>
<p>For each of these, subjects gave a response between 0 and 100 indicating their agreement with the statement as presented. The scale was 0 = Strongly disagree, 100 = Strongly agree.</p>
<ol type="1">
<li><code>r_pre</code>: Prior to taking 431, I was totally confident and comfortable with using R. (0 = Strongly Disagree, 100 = Strongly Agree)</li>
<li><code>r_now</code>: Right now, I am totally confident and comfortable with using R. (0 = Strongly Disagree, 100 = Strongly Agree)</li>
<li><code>comfort_431</code>: I am very comfortable with my understanding of the material discussed so far in 431.</li>
</ol>
</section>
<section id="other-quantitative-variables" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="other-quantitative-variables"><span class="header-section-number">2.1.2</span> Other Quantitative Variables</h3>
<ol start="4" type="1">
<li><code>height</code>: What is your height, in inches?</li>
<li><code>weight</code>: What is your weight, in pounds?</li>
</ol>
</section>
<section id="binary-variables" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="binary-variables"><span class="header-section-number">2.1.3</span> Binary Variables</h3>
<ol start="6" type="1">
<li><code>r_before</code>: Before taking 431, had you ever used R before? (Yes, No)</li>
<li><code>english</code>: Is English the language you speak better than any other? (Yes, No)</li>
</ol>
</section>
<section id="multi-categorical-variables" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="multi-categorical-variables"><span class="header-section-number">2.1.4</span> Multi-Categorical Variables</h3>
<ol start="8" type="1">
<li><code>grades</code>: In your graduate and undergraduate educational experience, which of the following types of assignments have you received the HIGHEST grades for?
<ul>
<li>Available responses were “A. Individual Assignments”, “B. Partner Assignments (you and 1 other student)”, and “C. Group Assignments (you and 2 or more others)”.</li>
</ul></li>
<li><code>medium</code>: Which medium do you use most to get your fictional stories (containing plot)?
<ul>
<li>Available Responses: “A. Movies”, “B. Television”, “C. Print (including books, comics, etc.)”, and “D. Other”.</li>
</ul></li>
<li><code>fiction</code>: Which type of fictional stories do you consume most?
<ul>
<li>Available Responses: “A. Comedy”, “B. Drama”, “C. Action”, “D. Horror / Thriller”, and “E. Fantasy / Science Fiction”.</li>
</ul></li>
</ol>
<p>Our analytic tibble will be called <code>sur15</code> for this demonstration.</p>
<ul>
<li>This tibble will need to contain information developed from the variables listed above, plus the subject identifying code <code>s_id</code>.</li>
<li>As we add variables to the analytic tibble, we’ll also check to see that all of the values fall in a reasonable range (with no results that fall outside of the parameters of how we are measuring the results) and we’ll identify whether there are any missing values.</li>
</ul>
<p>Note that we’ve already checked our subject identification codes to ensure that we have no missing values there and that we have a unique identifier for each row in the data back when we did the merge.</p>
</section>
</section>
<section id="checking-our-quantitative-variables" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="checking-our-quantitative-variables"><span class="header-section-number">2.2</span> Checking our Quantitative Variables</h2>
<p>We have five quantitative variables. We want to check the range (minimum and maximum) plus for each, to ensure that we have no impossible or missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r_pre, r_now, comfort_431, height, weight) <span class="sc">|&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_codebook</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>select(sur15_m, r_pre, r_now, comfort_431, height, weight) (53 rows and 5 variables, 5 shown)

ID | Name        | Type    | Missings |       Values |  N
---+-------------+---------+----------+--------------+---
1  | r_pre       | numeric | 0 (0.0%) |      [0, 90] | 53
---+-------------+---------+----------+--------------+---
2  | r_now       | numeric | 0 (0.0%) |      [0, 95] | 53
---+-------------+---------+----------+--------------+---
3  | comfort_431 | numeric | 0 (0.0%) |    [15, 100] | 53
---+-------------+---------+----------+--------------+---
4  | height      | numeric | 0 (0.0%) | [22.83, 217] | 53
---+-------------+---------+----------+--------------+---
5  | weight      | numeric | 0 (0.0%) |     [1, 320] | 53
---------------------------------------------------------</code></pre>
</div>
</div>
<ul>
<li>For the three rating variables, all values are in the range [0, 100], as they must be.</li>
<li>However, the <code>height</code> range doesn’t seem reasonable. With <code>height</code> measured in inches, do we really think there should be a height as small as 22.83 inches?</li>
<li>The <code>weight</code> minimum is also a problem. Is 1 pound a reasonable value?</li>
<li>We also want to create a body mass index from the <code>height</code> and <code>weight</code> data</li>
</ul>
<section id="combining-height-and-weight-into-bmi-and-specifying-na-for-implausible-values" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="combining-height-and-weight-into-bmi-and-specifying-na-for-implausible-values"><span class="header-section-number">2.2.1</span> Combining <code>height</code> and <code>weight</code> into <code>bmi</code> and Specifying <code>NA</code> for Implausible Values</h3>
<p>We will calculate <code>bmi</code> (body-mass index) from the available <code>height</code> (inches) and <code>weight</code> (pounds) data. The BMI formula for inches and pounds is available at http://www.bmi-calculator.net/bmi-formula.php. A reasonable range for BMI values is probably about 15 to 50.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bmi =</span> <span class="dv">703</span> <span class="sc">*</span> weight <span class="sc">/</span> height<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">reframe</span>(<span class="fu">lovedist</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
      n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    53     0  26.2  23.5  23.2  3.25 0.159  21.2  25.5  189.</code></pre>
</div>
</div>
<p>The minimum calculated <code>bmi</code> value seems impossibly low, and the highest <code>bmi</code> seems impossibly high. Let’s look at the heights and weights involved.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(height) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  s_id  height weight
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 504     22.8    140
2 530     61      140
3 513     61.4    112
4 519     62      126
5 528     62      155
6 540     62      140</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(height) <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  s_id  height weight
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 532       72    160
2 549       72    220
3 506       73    145
4 507       74    320
5 535       74    172
6 529      217    165</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(weight) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  s_id  height weight
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 550     66.5      1
2 521     63      107
3 512     65      112
4 513     61.4    112
5 552     65      120
6 526     64      121</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(weight) <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  s_id  height weight
  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 505       70    178
2 516       71    200
3 511       65    202
4 546       69    210
5 549       72    220
6 507       74    320</code></pre>
</div>
</div>
<p>The subjects with heights of 22.83 inches and 217 inches are implausible, and the subject with weight 1 pound is also not reasonable. We want to focus on actually plausible results.</p>
<ul>
<li>A reasonable guess is that no one in the class was less than about 122 centimeters, or 4 feet tall (48 inches) nor were they greater than about 213 centimeters, or 7 feet tall (84 inches) so we’re going to change any values outside that range to <code>NA</code>.</li>
<li>Similarly, it seems reasonable to assume that no one in the class was below 80 pounds (36.3 kg) or above 400 pounds (181.4 kg) so again, we’ll regard any values we see outside that range is implausible and change them to <code>NA</code>.</li>
</ul>
<p>I’ll do this by creating new variables <code>height_r</code> and <code>weight_r</code> where the <code>_r</code> (meaning “revised”) indicates to me that I’ve revised the original variable in some way without adding a lot of characters to its name.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">height_r =</span> <span class="fu">replace</span>(height, height <span class="sc">&lt;</span> <span class="dv">48</span> <span class="sc">|</span> height <span class="sc">&gt;</span> <span class="dv">84</span>, <span class="cn">NA</span>),</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">weight_r =</span> <span class="fu">replace</span>(weight, weight <span class="sc">&lt;</span> <span class="dv">80</span> <span class="sc">|</span> weight <span class="sc">&gt;</span> <span class="dv">400</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">bmi =</span> <span class="dv">703</span> <span class="sc">*</span> weight_r <span class="sc">/</span> height_r <span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(height_r, weight_r, bmi) <span class="sc">|&gt;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_codebook</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>select(sur15_m, height_r, weight_r, bmi) (53 rows and 3 variables, 3 shown)

ID | Name     | Type    | Missings |         Values |  N
---+----------+---------+----------+----------------+---
1  | height_r | numeric | 2 (3.8%) |       [61, 74] | 51
---+----------+---------+----------+----------------+---
2  | weight_r | numeric | 1 (1.9%) |     [107, 320] | 52
---+----------+---------+----------+----------------+---
3  | bmi      | numeric | 3 (5.7%) | [18.64, 41.08] | 50
--------------------------------------------------------</code></pre>
</div>
</div>
<p>So now, we have 2 missing values of <code>height_r</code>, 1 missing value of <code>weight_r</code> and we have calculated BMI results, with 3 missing values, and our ranges (minimum and maximum) for each of these variables now look OK.</p>
</section>
</section>
<section id="checking-our-binary-variables" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="checking-our-binary-variables"><span class="header-section-number">2.3</span> Checking our Binary Variables</h2>
<p>We have two binary variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(english, r_before) <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 53
Columns: 2
$ english  &lt;chr&gt; "No", "Yes", "Yes", "No", "Yes", "Yes", "Yes", "No", "Yes", "…
$ r_before &lt;chr&gt; "Yes", "No", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "N…</code></pre>
</div>
</div>
<p>I’d like those to be factors in R, rather than characters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">r_before =</span> <span class="fu">factor</span>(r_before),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">english =</span> <span class="fu">factor</span>(english))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">count</span>(r_before, english)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  r_before english     n
  &lt;fct&gt;    &lt;fct&gt;   &lt;int&gt;
1 No       No         10
2 No       Yes        18
3 Yes      No          8
4 Yes      Yes        17</code></pre>
</div>
</div>
<p>OK. No missingness, and no values out of the range of our expectations. Good.</p>
</section>
<section id="checking-our-multi-category-variables" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="checking-our-multi-category-variables"><span class="header-section-number">2.4</span> Checking our Multi-Category Variables</h2>
<p>For each of our multi-categorical variables, I’ll run a quick <code>tabyl</code> to see if we have any surprising results or missing values. Then I’ll revise each of them (as needed) to have more suitable (mostly, shorter) level names. In addition to checking for missingness and inappropriate values, we want to collapse some categories, or adjust names or labeling to mirror what we need in our analyses.</p>
<section id="the-grades-variable" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="the-grades-variable"><span class="header-section-number">2.4.1</span> The <code>grades</code> variable</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(grades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                           grades  n    percent valid_percent
                        A. Individual Assignments 40 0.75471698     0.7692308
 B. Partner Assignments (you and 1 other student)  6 0.11320755     0.1153846
  C. Group Assignments (you and 2 or more others)  6 0.11320755     0.1153846
                                             &lt;NA&gt;  1 0.01886792            NA</code></pre>
</div>
</div>
<p>For <code>grades</code>, we want to create a new factor called <code>grades_r</code> which is a factor and which has shorter level names, specifically: Individual, Partner and Group, in that order. We’ll use the <code>fct_recode</code> function from <code>forcats</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">grades_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(grades), </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Individual"</span> <span class="ot">=</span> <span class="st">"A. Individual Assignments"</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Partner"</span> <span class="ot">=</span> <span class="st">"B. Partner Assignments (you and 1 other student)"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Group"</span> <span class="ot">=</span> <span class="st">"C. Group Assignments (you and 2 or more others)"</span>))</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sanity check to ensure we coded correctly</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">count</span>(grades, grades_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  grades                                           grades_r       n
  &lt;chr&gt;                                            &lt;fct&gt;      &lt;int&gt;
1 A. Individual Assignments                        Individual    40
2 B. Partner Assignments (you and 1 other student) Partner        6
3 C. Group Assignments (you and 2 or more others)  Group          6
4 &lt;NA&gt;                                             &lt;NA&gt;           1</code></pre>
</div>
</div>
<ul>
<li>That looks like we’ve correctly renamed the values.</li>
<li>For this demonstration, we’ll allow counts as low as 5 for individual levels of a categorical variable, because of the small sample size, so I won’t collapse the levels at all.</li>
<li>We have a missing value here, so we’ll need to deal with that later.</li>
</ul>
</section>
<section id="the-medium-variable" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="the-medium-variable"><span class="header-section-number">2.4.2</span> The <code>medium</code> variable</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(medium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                   medium  n    percent
                                A. Movies 17 0.32075472
                            B. Television 22 0.41509434
 C. Print (including books, comics, etc.)  9 0.16981132
                                 D. Other  5 0.09433962</code></pre>
</div>
</div>
<ul>
<li>We have no missing values, so that’s good.</li>
<li>In this demonstration, we will require that each category have at least 5 responses, so while this just barely meets that standard, I think I will go ahead and collapse the variable down to just three categories.</li>
</ul>
<p>For the <code>medium</code> variable, we want to collapse the Print and Other levels to form a three category variable (with levels Movies, TV and Other) called <code>medium_r</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">medium_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(medium), </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Movies"</span> <span class="ot">=</span> <span class="st">"A. Movies"</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"TV"</span> <span class="ot">=</span> <span class="st">"B. Television"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"C. Print (including books, comics, etc.)"</span>,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"D. Other"</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">count</span>(medium, medium_r) <span class="co"># sanity check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  medium                                   medium_r     n
  &lt;chr&gt;                                    &lt;fct&gt;    &lt;int&gt;
1 A. Movies                                Movies      17
2 B. Television                            TV          22
3 C. Print (including books, comics, etc.) Other        9
4 D. Other                                 Other        5</code></pre>
</div>
</div>
<p>OK. Looks good now.</p>
</section>
<section id="the-fiction-variable" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="the-fiction-variable"><span class="header-section-number">2.4.3</span> The <code>fiction</code> variable</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(fiction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      fiction  n    percent
                    A. Comedy 18 0.33962264
                     B. Drama 15 0.28301887
                    C. Action  5 0.09433962
         D. Horror / Thriller  1 0.01886792
 E. Fantasy / Science Fiction 14 0.26415094</code></pre>
</div>
</div>
<ul>
<li>No signs of missing values, so that’s good.</li>
<li>With only one value in category D and only 5 in category C, we will need to do some collapsing to use this variable later.</li>
</ul>
</section>
<section id="collapsing-and-recoding-levels-of-fiction" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="collapsing-and-recoding-levels-of-fiction"><span class="header-section-number">2.4.4</span> Collapsing and recoding levels of <code>fiction</code></h3>
<p>For the <code>fiction</code> variable, we want to form a four category variable (with levels Comedy, Drama, Fantasy/SF, Other) called <code>fiction_r</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fiction_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(fiction), </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Comedy"</span> <span class="ot">=</span> <span class="st">"A. Comedy"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Drama"</span> <span class="ot">=</span> <span class="st">"B. Drama"</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Fantasy/SF"</span> <span class="ot">=</span> <span class="st">"E. Fantasy / Science Fiction"</span>,</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"C. Action"</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Other"</span> <span class="ot">=</span> <span class="st">"D. Horror / Thriller"</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">count</span>(fiction, fiction_r) <span class="co"># sanity check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  fiction                      fiction_r      n
  &lt;chr&gt;                        &lt;fct&gt;      &lt;int&gt;
1 A. Comedy                    Comedy        18
2 B. Drama                     Drama         15
3 C. Action                    Other          5
4 D. Horror / Thriller         Other          1
5 E. Fantasy / Science Fiction Fantasy/SF    14</code></pre>
</div>
</div>
<p>Actually, I’d like to reorder <code>fiction_r</code> to put Other last.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fiction_r =</span> <span class="fu">fct_relevel</span>(fiction_r, </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Comedy"</span>, <span class="st">"Drama"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"Fantasy/SF"</span>, <span class="st">"Other"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>OK. Let’s see what we have now…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tabyl</span>(medium_r, fiction_r) <span class="sc">|&gt;</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">medium_r</th>
<th style="text-align: right;">Comedy</th>
<th style="text-align: right;">Drama</th>
<th style="text-align: right;">Fantasy/SF</th>
<th style="text-align: right;">Other</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Movies</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">TV</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Other</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>OK. I wish we didn’t have that zero cell in the cross-tabulation, but we’ll leave it alone, rather than collapsing further, given our small number of observations in this demonstration.</p>
</section>
</section>
<section id="creating-our-analytic-tibble" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="creating-our-analytic-tibble"><span class="header-section-number">2.5</span> Creating our Analytic Tibble</h2>
<p>So our analytic tibble, which I’ll call <code>sur15</code> should contains only the twelve variables that appear in our code book.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="ot">&lt;-</span> sur15_m <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(s_id, r_pre, r_now, comfort_431, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>           height_r, weight_r, bmi, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>           r_before, english,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>           grades_r, medium_r, fiction_r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="list-of-missing-values" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="list-of-missing-values"><span class="header-section-number">2.6</span> List of Missing Values</h2>
<p>We can count the number of missing observations in each variable, with …</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_var_summary</span>(sur15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   variable    n_miss pct_miss
   &lt;chr&gt;        &lt;int&gt;    &lt;num&gt;
 1 bmi              3     5.66
 2 height_r         2     3.77
 3 weight_r         1     1.89
 4 grades_r         1     1.89
 5 s_id             0     0   
 6 r_pre            0     0   
 7 r_now            0     0   
 8 comfort_431      0     0   
 9 r_before         0     0   
10 english          0     0   
11 medium_r         0     0   
12 fiction_r        0     0   </code></pre>
</div>
</div>
<p>We can see the subjects who have missing values in several ways, including…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(sur15)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 3
    case n_miss pct_miss
   &lt;int&gt;  &lt;int&gt;    &lt;dbl&gt;
 1     4      2    16.7 
 2    29      2    16.7 
 3    50      2    16.7 
 4    16      1     8.33
 5     1      0     0   
 6     2      0     0   
 7     3      0     0   
 8     5      0     0   
 9     6      0     0   
10     7      0     0   
# ℹ 43 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>sur15[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(sur15)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 12
  s_id  r_pre r_now comfort_431 height_r weight_r   bmi r_before english
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  
1 504      20    80          50     NA        140  NA   Yes      No     
2 516       0    50          70     71        200  27.9 No       Yes    
3 529      25    75          85     NA        165  NA   No       Yes    
4 550       0     0          15     66.5       NA  NA   No       No     
# ℹ 3 more variables: grades_r &lt;fct&gt;, medium_r &lt;fct&gt;, fiction_r &lt;fct&gt;</code></pre>
</div>
</div>
<p>In our sample of respondents, we have:</p>
<ul>
<li>49 subjects with no missing values,</li>
<li>1 subject (<code>s_id</code> = 516) who is missing <code>grades_r</code>,</li>
<li>2 subjects (<code>s_id</code> = 504 and 529) who are missing <code>height_r</code> and <code>bmi</code>, and</li>
<li>1 subject (<code>s_id</code> = 550) who is missing <code>weight_r</code> and <code>bmi</code>.</li>
</ul>
<p>So we’ll have to keep that missingness in mind when we do work with <code>bmi</code> or <code>grades_r</code> in the analyses that follow.</p>
</section>
</section>
<section id="codebook-and-data-description" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Codebook and Data Description</h1>
<section id="variable-descriptions" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="variable-descriptions"><span class="header-section-number">3.1</span> Variable Descriptions</h2>
<p>The 12 variables in our tidy data set <code>sur15</code> for this demonstration are as follows. The Type column indicates the number of levels in each categorical (factor) variable. Recall that we have missing data in <code>height_r</code>, <code>weight_r</code>, <code>bmi</code> and <code>grades_r</code> and I’ve indicated this in the codebook table below. As for the Type information, I’m using Quant to indicate quantitative variables, and Cat-x indicates a categorical variable (factor) with x levels.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th style="text-align: center;">Type</th>
<th>Description / Levels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>s_id</code></td>
<td style="text-align: center;">ID</td>
<td>subject code (501-533)</td>
</tr>
<tr class="even">
<td><code>r_pre</code></td>
<td style="text-align: center;">Quant</td>
<td>0 (SD) - 100 (SA) with Prior to taking 431, I was totally confident and comfortable with using R.</td>
</tr>
<tr class="odd">
<td><code>r_now</code></td>
<td style="text-align: center;">Quant</td>
<td>0 (SD) - 100 (SA) with Right now, I am totally confident and comfortable with using R.</td>
</tr>
<tr class="even">
<td><code>comfort_431</code></td>
<td style="text-align: center;">Quant</td>
<td>0 (SD) - 100 (SA) with I am very comfortable with my understanding of the material discussed so far in 431.</td>
</tr>
<tr class="odd">
<td><code>height_r</code></td>
<td style="text-align: center;">Quant</td>
<td>What is your height, in inches [<strong>2 NA</strong>]</td>
</tr>
<tr class="even">
<td><code>weight_r</code></td>
<td style="text-align: center;">Quant</td>
<td>What is your weight, in pounds [<strong>1 NA</strong>]</td>
</tr>
<tr class="odd">
<td><code>bmi</code></td>
<td style="text-align: center;">Quant</td>
<td>703 x <code>weight</code>/(<code>height</code> squared) [<strong>3 NA</strong>]</td>
</tr>
<tr class="even">
<td><code>r_before</code></td>
<td style="text-align: center;">Cat-2</td>
<td>yes, no: Before taking 431, had you ever used R before?</td>
</tr>
<tr class="odd">
<td><code>english</code></td>
<td style="text-align: center;">Cat-2</td>
<td>yes, no: Is English the language you speak better than any other?</td>
</tr>
<tr class="even">
<td><code>grades_r</code></td>
<td style="text-align: center;">Cat-3</td>
<td>Individual, Partner, Group: In your graduate and undergraduate educational experience, which of the following types of assignments have you received the HIGHEST grades for? [<strong>1 NA</strong>]</td>
</tr>
<tr class="odd">
<td><code>medium_r</code></td>
<td style="text-align: center;">Cat-3</td>
<td>Movies, TV, Other: Which medium do you use most to get your fictional stories (containing plot)?</td>
</tr>
<tr class="even">
<td><code>fiction_r</code></td>
<td style="text-align: center;">Cat-4</td>
<td>Comedy, Drama, Fantasy/SF, Other: Which type of fictional stories do you consume most?</td>
</tr>
</tbody>
</table>
</section>
<section id="analytic-tibble" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="analytic-tibble"><span class="header-section-number">3.2</span> Analytic Tibble</h2>
<p>Now, I’ll prove that <code>sur15</code> is a tibble by printing it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>sur15</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 12
   s_id  r_pre r_now comfort_431 height_r weight_r   bmi r_before english
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  
 1 501       0    70          90     68.1      162  24.6 Yes      No     
 2 502       0    70          50     67        151  23.6 No       Yes    
 3 503       0    10          70     62.5      127  22.9 No       Yes    
 4 504      20    80          50     NA        140  NA   Yes      No     
 5 505      80    90          85     70        178  25.5 Yes      Yes    
 6 506       0    50          80     73        145  19.1 No       Yes    
 7 507      50    50          50     74        320  41.1 Yes      Yes    
 8 508      60    75          80     70        165  23.7 Yes      No     
 9 509       0    50          75     64        135  23.2 No       Yes    
10 510      30    30          50     69        155  22.9 No       Yes    
# ℹ 43 more rows
# ℹ 3 more variables: grades_r &lt;fct&gt;, medium_r &lt;fct&gt;, fiction_r &lt;fct&gt;</code></pre>
</div>
</div>
</section>
<section id="data-summary" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="data-summary"><span class="header-section-number">3.3</span> Data Summary</h2>
<section id="data_description" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="data_description"><span class="header-section-number">3.3.1</span> <code>data_description()</code></h3>
<p>Here’s a <code>data_description()</code> result to show some information about the distribution of each quantitative variables in the <code>sur15</code> tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_distribution</span>(sur15 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>s_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Variable    |   Mean |    SD |   IQR |            Range | Skewness | Kurtosis |  n | n_Missing
----------------------------------------------------------------------------------------------
r_pre       |  21.13 | 30.38 | 50.00 |    [0.00, 90.00] |     1.11 |    -0.29 | 53 |         0
r_now       |  56.58 | 26.84 | 38.00 |    [0.00, 95.00] |    -0.66 |    -0.52 | 53 |         0
comfort_431 |  75.94 | 18.37 | 20.00 |  [15.00, 100.00] |    -1.32 |     1.66 | 53 |         0
height_r    |  67.47 |  3.46 |  5.00 |   [61.00, 74.00] |    -0.05 |    -0.85 | 51 |         2
weight_r    | 155.74 | 33.97 | 35.00 | [107.00, 320.00] |     2.36 |     9.81 | 52 |         1
bmi         |  23.94 |  4.11 |  4.39 |   [18.64, 41.08] |     1.87 |     5.30 | 50 |         3</code></pre>
</div>
</div>
</section>
<section id="data_codebook" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="data_codebook"><span class="header-section-number">3.3.2</span> <code>data_codebook()</code></h3>
<p>And here’s the <code>data_codebook()</code> result, which adds in tabulations of the categorical variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data_codebook</span>(sur15 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>s_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>select(sur15, -s_id) (53 rows and 11 variables, 11 shown)

ID | Name        | Type        | Missings |         Values |          N
---+-------------+-------------+----------+----------------+-----------
1  | r_pre       | numeric     | 0 (0.0%) |        [0, 90] |         53
---+-------------+-------------+----------+----------------+-----------
2  | r_now       | numeric     | 0 (0.0%) |        [0, 95] |         53
---+-------------+-------------+----------+----------------+-----------
3  | comfort_431 | numeric     | 0 (0.0%) |      [15, 100] |         53
---+-------------+-------------+----------+----------------+-----------
4  | height_r    | numeric     | 2 (3.8%) |       [61, 74] |         51
---+-------------+-------------+----------+----------------+-----------
5  | weight_r    | numeric     | 1 (1.9%) |     [107, 320] |         52
---+-------------+-------------+----------+----------------+-----------
6  | bmi         | numeric     | 3 (5.7%) | [18.64, 41.08] |         50
---+-------------+-------------+----------+----------------+-----------
7  | r_before    | categorical | 0 (0.0%) |             No | 28 (52.8%)
   |             |             |          |            Yes | 25 (47.2%)
---+-------------+-------------+----------+----------------+-----------
8  | english     | categorical | 0 (0.0%) |             No | 18 (34.0%)
   |             |             |          |            Yes | 35 (66.0%)
---+-------------+-------------+----------+----------------+-----------
9  | grades_r    | categorical | 1 (1.9%) |     Individual | 40 (76.9%)
   |             |             |          |        Partner |  6 (11.5%)
   |             |             |          |          Group |  6 (11.5%)
---+-------------+-------------+----------+----------------+-----------
10 | medium_r    | categorical | 0 (0.0%) |         Movies | 17 (32.1%)
   |             |             |          |             TV | 22 (41.5%)
   |             |             |          |          Other | 14 (26.4%)
---+-------------+-------------+----------+----------------+-----------
11 | fiction_r   | categorical | 0 (0.0%) |         Comedy | 18 (34.0%)
   |             |             |          |          Drama | 15 (28.3%)
   |             |             |          |     Fantasy/SF | 14 (26.4%)
   |             |             |          |          Other |  6 (11.3%)
-----------------------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="analysis-a-compare-2-population-means-using-paired-samples" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Analysis A: Compare 2 Population Means using Paired Samples</h1>
<section id="the-question" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-question"><span class="header-section-number">4.1</span> The Question</h2>
<p>We’ll compare the <code>r_now</code> scores to <code>r_pre</code> scores. The scores are paired by subject, as each subject gives us both a <code>r_pre</code> and <code>r_now</code> score, and computing and assessing within-subject differences in comfort with R makes sense, because we are interested in the change in each person’s comfort level. We’ll generally use <code>r_now - r_pre</code> in our calculations, so that positive numbers indicate improvements in confidence. <strong>Note that we’ll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project B Study 1 work, as well.</strong></p>
<p>So, our research question might be something like:</p>
<p>What is a typical change in comfort with R experienced by students in 431 through the first couple of months in the course?</p>
</section>
<section id="describing-the-data" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="describing-the-data"><span class="header-section-number">4.2</span> Describing the Data</h2>
<section id="compute-and-summarize-the-paired-differences" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="compute-and-summarize-the-paired-differences"><span class="header-section-number">4.2.1</span> Compute and summarize the paired differences</h3>
<p>The natural first step is to compute paired differences between the <code>r_now</code> and <code>r_pre</code> samples, and then use graphical and numerical summaries to assess whether the sample (of differences) can be assumed to follow a Normal distribution. First, we’ll calculate the paired differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">r_diff =</span> r_now <span class="sc">-</span> r_pre)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span> <span class="fu">reframe</span>(<span class="fu">lovedist</span>(r_diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 10
      n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    53     0  35.5  28.7    30  37.1     0    10    60    95</code></pre>
</div>
</div>
<p>OK. It appears that we have successfully subtracted the PRE data from the NOW data, and everyone has a difference of at least zero. But we have a lot of people (8) who have a value of 0. Now, we’ll assess whether or not a Normal distribution might be a reasonable model for the data.</p>
</section>
<section id="graphical-summaries-to-assess-normality" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="graphical-summaries-to-assess-normality"><span class="header-section-number">4.2.2</span> Graphical Summaries to Assess Normality</h3>
<p>We should start by looking at the distribution of these 53 values of <code>r_diff</code>. As we’ve seen, there’s a floor effect at zero.</p>
<p>A histogram with 53 values won’t give us a lot of information. Perhaps we should focus instead on a Normal Q-Q plot and boxplot with violin? We’ll draw all three here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">x =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"slateblue"</span>, <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"R Comfort Rating Difference"</span>) </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">sample =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"slateblue"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Rating Difference"</span>) </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"n = 53"</span>, <span class="at">y =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"slateblue"</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Current - PreClass Difference in R Comfort Rating"</span>,</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Most Students Improved R Comfort Ratings during 431"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>With just 53 observations, it will be a little difficult to get a clear picture of whether a Normal approximation is reasonable or not. I would conclude that a bootstrap approach would be a better choice here than a Normal model for the paired differences, owing to the floor effect (many zeros) in the paired differences. The data are a bit skewed, although they don’t quite sneak over the 0.2 cutoff for skew<sub>1</sub>.</p>
</section>
<section id="did-pairing-help-reduce-nuisance-variation" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="did-pairing-help-reduce-nuisance-variation"><span class="header-section-number">4.2.3</span> Did Pairing Help Reduce Nuisance Variation?</h3>
<p>We would expect a strong correlation between the <code>r_pre</code> and <code>r_now</code> scores in this repeated measures analysis where each subject is assessing both their confidence before the class and then again during the class. To assess whether pairing helped reduce nuisance variation, I’ll build a scatterplot of the <code>r_pre</code> and <code>r_now</code> scores, supplemented by a Pearson correlation coefficient. Since we have so many ties in the data, with two or more points in the same place, I’ll use <code>geom_jitter</code> rather than <code>geom_point</code> to plot the points. The larger the correlation, the more that pairing will help reduce the impact of differences between subjects on the <code>r_pre</code> score on the comparison we’re trying to make.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">x =</span> r_pre, <span class="at">y =</span> r_now)) <span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">col =</span> <span class="st">"slateblue"</span>) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">formula =</span> y <span class="sc">~</span> x, <span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Jittered Scatterplot shows moderately strong relationship"</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">"especially for those starting above 0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/scatterplot_for_paired_diffs-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For people with a <code>r_pre</code> score greater than zero, we see a pretty strong linear relationship between <code>r_pre</code> and <code>r_now</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span> <span class="fu">select</span>(r_pre, r_now) <span class="sc">|&gt;</span> <span class="fu">cor</span>() <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round_half_up</span>(<span class="at">digits =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">r_pre</th>
<th style="text-align: right;">r_now</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">r_pre</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.503</td>
</tr>
<tr class="even">
<td style="text-align: left;">r_now</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The Pearson correlation is quite strong at 0.503 so that a linear model using the <code>r_pre</code> score accounts for a reasonably large fraction (25.3%) of the variation in <code>r_now</code> scores.</p>
<ul>
<li>If the Pearson correlation had been small but still positive (perhaps less than 0.2), we might conclude that pairing wouldn’t be exceptionally helpful, but if the samples are meant to be paired, we should still do a paired samples analysis, but such a small correlation would imply that an independent samples comparison would come to about the same conclusion.</li>
</ul>
</section>
</section>
<section id="main-analysis" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="main-analysis"><span class="header-section-number">4.3</span> Main Analysis</h2>
<p>As you’ll recall, we have two main methods for building confidence intervals in a paired samples analysis:</p>
<ul>
<li>The Paired t test</li>
<li>The Bootstrap, using <code>smean.cl.boot</code></li>
</ul>
<p>Let’s run each in this demonstration just so you have the code, even though, as mentioned, I’d be most interested in what the bootstrap approach suggests, owing to the modest non-Normality we see in the sample of differences. I’ll even throw in a Wilcoxon signed rank test approach here, even though I wouldn’t recommend you include that in Project B. In each case, we’ll build a 90% confidence interval for the population mean (or pseudo-median, in the case of the signed rank test) of the <code>r_now - r_pre</code> differences.</p>
<section id="the-paired-t-test-approach" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-paired-t-test-approach"><span class="header-section-number">4.3.1</span> The Paired t test approach</h3>
<p>Here is a 90% confidence interval for the population mean of the paired <code>r_now - r_pre</code> differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sur15<span class="sc">$</span>r_diff, <span class="at">conf.level =</span> .<span class="dv">90</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     35.5     28.9      42.1</code></pre>
</div>
</div>
<ul>
<li>The point estimate for the population mean of the differences is 35.45, indicating that the average subject rated agreement with the statement about confidence in R 35 points higher now than when they started the class.</li>
<li>Our 90% confidence interval for the population mean of the differences is (28.9, 42.1)</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure. We conclude from the confidence interval (which does not contain zero) that there is some evidence of a difference between the <code>r_pre</code> and <code>r_now</code> scores.</li>
<li>The assumptions of the paired t procedure are
<ul>
<li>that the matched differences are independent of each other,</li>
<li>that the matched differences represent a random sample of the population of possible matched differences,</li>
<li>and that the matched differences are drawn from a Normally distributed population. - The last of these assumptions is hard to justify given these data.</li>
</ul></li>
</ul>
</section>
<section id="the-wilcoxon-signed-rank-test-approach" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="the-wilcoxon-signed-rank-test-approach"><span class="header-section-number">4.3.2</span> The Wilcoxon signed rank test approach</h3>
<p>Here is a 90% confidence interval for the population pseudo-median of the paired <code>r_now - r_pre</code> differences, as estimated by the Wilcoxon signed rank approach.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(sur15<span class="sc">$</span>r_diff, <span class="at">conf.level =</span> .<span class="dv">90</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">exact =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1     40.0     35.0      47.5</code></pre>
</div>
</div>
<ul>
<li>The point estimate for the population pseudo-median of the differences is 40, indicating that the average subject rated agreement with the statement about confidence in R 40 points higher now than when they started the class. Note that this is meaningfully different from the sample median difference, which was 30, and that’s because there was some skew in the sample data. The interpretation of the Wilcoxon approach is easiest for data that are light-tailed or heavy-tailed, but still generally symmetric.</li>
<li>Our 90% confidence interval for the population pseudo-median of the differences is (35, 47.5)</li>
<li>Here, I’ve assumed a two-sided confidence interval and testing procedure. We conclude from the confidence interval (which does not contain zero) that there is some evidence of a meaningful difference between <code>r_pre</code> and <code>r_now</code> scores.</li>
<li>The assumptions of the Wilcoxon signed rank procedure are
<ul>
<li>that the matched differences are independent of each other,</li>
<li>that the matched differences represent a random sample of the population of possible matched differences,</li>
<li>and that the matched differences are drawn from a population that is symmetric, but potentially light-tailed, or even outlier-prone</li>
<li>The last of these assumptions is hard to justify given these data.</li>
</ul></li>
</ul>
</section>
<section id="the-bootstrap-approach-for-the-mean-from-paired-samples" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="the-bootstrap-approach-for-the-mean-from-paired-samples"><span class="header-section-number">4.3.3</span> The Bootstrap approach for the mean from paired samples</h3>
<p>Here is a 90% confidence interval for the population mean of the paired <code>r_now - r_pre</code> differences, as estimated by a bootstrap approach using a random seed of <code>431</code>. (<em>Note</em>: when you set a seed for this or other analyses in the project, pick something other than <code>431</code>.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">431</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">smean.cl.boot</span>(sur15<span class="sc">$</span>r_diff, <span class="at">conf.int =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Mean    Lower    Upper 
35.45283 28.90566 42.09623 </code></pre>
</div>
</div>
<ul>
<li>The point estimate for the population mean of the differences is 35.45, indicating that the average subject rated agreement with the statement about confidence in R 35 points higher now than when they started the class.</li>
<li>Our 90% confidence interval for the population mean of the differences is fairly close to what we got from the paired t test, as it turns out.</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure, and so we can discuss a range of reasonable estimates for the true difference in <code>r_pre</code> and <code>r_now</code> scores.</li>
<li>The assumptions of this bootstrap procedure are
<ul>
<li>that the matched differences are independent of each other, and</li>
<li>that the matched differences represent a random sample of the population of possible matched differences,</li>
</ul></li>
</ul>
</section>
</section>
<section id="conclusions" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="conclusions"><span class="header-section-number">4.4</span> Conclusions</h2>
<p>Subjects appear to improve in their comfort with R an average of 35.45 points on the 0-100 scale, with a 90% confidence interval for that average improvement of (28.9, 42.1) points. This conclusion is motivated by a bootstrap estimate to compare paired responses from students before and after the first couple of months of the course, and I feel this is the most justified approach based on my assessment of Normality in the data from these 53 students.</p>
<p>A natural next step would be to look at values of something like this over multiple years, or perhaps comparing students at more than just two stages. It would also be appealing to measure comfort with R at the earlier time, and then return to the students later, rather than asking them to remember where they were at the start a couple of months later. There are several other possible next steps here, too, depending on what population you might decide to target.</p>
</section>
</section>
<section id="analysis-b-compare-2-population-means-using-independent-samples" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analysis B: Compare 2 Population Means using Independent Samples</h1>
<section id="the-question-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="the-question-1"><span class="header-section-number">5.1</span> The Question</h2>
<p>We’ll compare <code>bmi</code> by <code>english</code> in this analysis using independent samples. We’re comparing the mean <code>bmi</code> of the population represented by respondents who speak English best to the mean <code>bmi</code> of the population represented by the respondents who speak some other language better. There is nothing to suggest that the two samples (English <code>bmi</code> and non-English <code>bmi</code> values) are paired or matched in any way. Plus, as we’ll see, there are different numbers of English and non-English preferring subjects, so there’s no way their <code>bmi</code> values could be paired. As a result, we’re going to be interested in looking at the two samples separately to help us understand issues related to hypothesis testing assumptions. <strong>Note that we’ll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project Study B work, as well.</strong></p>
<p>Our research question is:</p>
<p>Did students who speak English best have meaningfully different average body mass index values than students who speak some other language better than they speak English?</p>
</section>
<section id="describing-the-data-1" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="describing-the-data-1"><span class="header-section-number">5.2</span> Describing the Data</h2>
<p>I’ll start by looking at the range of the <code>bmi</code> data within each language group</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(english) <span class="sc">|&gt;</span> </span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">lovedist</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 11
  english     n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;fct&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 No         18     2  23.5  2.97  23.3  2.41  20.0  21.3  24.4  30.3
2 Yes        35     1  24.1  4.58  23.2  3.38  18.6  21.2  26.1  41.1</code></pre>
</div>
</div>
<p>As we have previously seen, we have three missing BMI values. We could either impute these values, or remove those cases for this analysis. In this case, I’ll assume missingness completely at random, and simply remove the three missing values.</p>
<p>So for this analysis, I’ll create a new data set called <code>sur15_B</code> that contains only the variables I will use in Analysis B, and only the cases where <code>bmi</code> is available.</p>
<section id="a-new-data-set-including-only-those-with-bmi-data" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="a-new-data-set-including-only-those-with-bmi-data"><span class="header-section-number">5.2.1</span> A New Data Set including only those with <code>bmi</code> data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sur15_B <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(bmi)) <span class="sc">|&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s_id, english, bmi)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(english) <span class="sc">|&gt;</span> </span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(<span class="fu">lovedist</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 11
  english     n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;fct&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 No         18     2  23.5  2.97  23.3  2.41  20.0  21.3  24.4  30.3
2 Yes        35     1  24.1  4.58  23.2  3.38  18.6  21.2  26.1  41.1</code></pre>
</div>
</div>
<p>Next, we’ll use graphical and numerical summaries to assess whether the samples (of Yes and No respondents, separately) can <em>each</em> be modeled appropriately by a Normal distribution.</p>
</section>
<section id="graphical-summaries" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="graphical-summaries"><span class="header-section-number">5.2.2</span> Graphical Summaries</h3>
<p>Let’s build a comparison boxplot (with notches and violins) to start. This will give me a message (which I’ll suppress here with <code>#| message: false</code> in the code chunk) about the notch exceeding the third quartile in the No group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sur15_B, <span class="fu">aes</span>(<span class="at">x =</span> english, <span class="at">y =</span> bmi, <span class="at">fill =</span> english)) <span class="sc">+</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"BMI data somewhat right skewed in each group"</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"n = 50 Students in 431: Fall 2015"</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Speaks English better than all other languages?"</span>, <span class="at">y =</span> <span class="st">"Body Mass Index"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/boxplot_for_b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There are at least a couple of candidate outliers in each group on the high end, which suggest some potential for meaningful skew.</p>
<p>We could also build a pair of Normal Q-Q plots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sur15_B, <span class="fu">aes</span>(<span class="at">sample =</span> bmi, <span class="at">col =</span> english)) <span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span> <span class="fu">geom_qq_line</span>() <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> english, <span class="at">labeller =</span> <span class="st">"label_both"</span>) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Observed BMI values"</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"BMI isn't well fit by a Normal model in either group"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/qqplots_for_b-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>There’s room for concern about whether a test that requires Normal distributions in the populations is a good choice here. With these small sample sizes, we’d probably be better off not making too many strong assumptions.</p>
</section>
<section id="numerical-summaries" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="numerical-summaries"><span class="header-section-number">5.2.3</span> Numerical Summaries</h3>
<p>We have 16 No and 34 Yes respondents to the English language question who have known BMI values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sur15_B <span class="sc">|&gt;</span> <span class="fu">group_by</span>(english) <span class="sc">|&gt;</span> <span class="fu">reframe</span>(<span class="fu">lovedist</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 11
  english     n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;fct&gt;   &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 No         16     0  23.5  2.97  23.3  2.41  20.0  21.3  24.4  30.3
2 Yes        34     0  24.1  4.58  23.2  3.38  18.6  21.2  26.1  41.1</code></pre>
</div>
</div>
<p>It looks like the right skew is large enough, at least in the Yes (speaks English best) group to warrant avoiding tests that require Normality. So again it looks like it’s not reasonable to assume Normality here, or even symmetry.</p>
</section>
</section>
<section id="main-analysis-1" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="main-analysis-1"><span class="header-section-number">5.3</span> Main Analysis</h2>
<p>As you’ll recall, we have three main methods for building confidence intervals in an independent samples analysis:</p>
<ul>
<li>Welch’s t test (t test without assuming equal variances)</li>
<li>The Pooled t test (t test with equal variances assumed)</li>
<li>The Bootstrap, using <code>bootdif</code></li>
</ul>
<p>Let’s run each here just so you have the code, even though, as mentioned, I’d be most interested in what the bootstrap approach suggests, owing to the fact that the samples aren’t well described by Normal models or even symmetric ones. I’ll even throw in a Wilcoxon Rank Sum approach here, even though I wouldn’t recommend you include that in Project B.In each case, we’ll build a 90% confidence interval for the population mean (or another measure of central tendency, in the case of the Rank Sum test) comparing <code>bmi</code> for people who answered Yes and No to the question about English being the language they speak best.</p>
<section id="the-welchs-t-test-approach" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="the-welchs-t-test-approach"><span class="header-section-number">5.3.1</span> The Welch’s t test approach</h3>
<p>With a somewhat unbalanced design (16 No and 34 Yes), the assumption of equal population variances will probably require us to look at the sample variances.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sur15_B <span class="sc">|&gt;</span> <span class="fu">group_by</span>(english) <span class="sc">|&gt;</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">mean =</span> <span class="fu">mean</span>(bmi), <span class="at">variance =</span> <span class="fu">var</span>(bmi))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  english     n  mean variance
  &lt;fct&gt;   &lt;int&gt; &lt;dbl&gt;    &lt;dbl&gt;
1 No         16  23.5     8.83
2 Yes        34  24.1    21.0 </code></pre>
</div>
</div>
<p>That’s a pretty substantial difference in variance with the Yes group a good deal more than 50% larger than the No group, so we might expect the Welch t test and pooled t test to look fairly different, and that would motivate me to focus on the Welch approach over the pooled t test. Of course, neither is a great choice here, due to the samples showing some non-Normality. Regardless, here is a 90% confidence interval for the difference between the “No” group and the “Yes” group population mean <code>bmi</code> based on Welch’s test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(bmi <span class="sc">~</span> english, <span class="at">data =</span> sur15_B, <span class="at">conf.level =</span> <span class="fl">0.90</span>) <span class="sc">|&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1   -0.617    -2.43      1.20</code></pre>
</div>
</div>
<ul>
<li>The point estimates for the two population <code>bmi</code> means are 23.52 for No and 24.14 for Yes, so the average student who speaks English best has a BMI estimated to be about 0.62 points higher than the average for a student who speaks another language better than English, based on our samples.</li>
<li>Our 90% confidence interval for the difference (English - non-English) of the population means is (-1.2, 2.4).</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure. We conclude from the confidence interval (which contains zero) only that the difference between the true means of the English and non-English <code>bmi</code> levels is neither clearly positive nor negative.</li>
<li>The assumptions of the Welch’s t test are
<ul>
<li>that the samples in each group are drawn independently of each other,</li>
<li>that the samples in each group represent a random sample of the population of interest,</li>
<li>and that the samples in each group are drawn from a Normally distributed population.</li>
</ul></li>
<li>The last of these assumptions is hard to justify given these data.</li>
</ul>
</section>
<section id="the-pooled-t-test-t-test-with-equal-variances" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="the-pooled-t-test-t-test-with-equal-variances"><span class="header-section-number">5.3.2</span> The Pooled t test (t test with equal variances)</h3>
<p>The pooled t test, of course, actually adds an assumption (that either the sample sizes or the population variances are equal) to the assumptions of the Welch test. As mentioned above, the large difference in the sample variances and sample sizes makes this test unattractive, in addition to the problems with assuming Normality. Regardless, here is a 90% confidence interval for the difference between the non-English and English population mean <code>bmi</code> based on the pooled t test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(bmi <span class="sc">~</span> english, <span class="at">data =</span> sur15_B, <span class="at">conf.level =</span> .<span class="dv">90</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">estimate =</span> estimate1 <span class="sc">-</span> estimate2) <span class="sc">|&gt;</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1   -0.617    -2.72      1.49</code></pre>
</div>
</div>
<ul>
<li>The point estimates for the two population <code>bmi</code> means are still 23.52 for No and 24.14 for Yes, so the average student who speaks English best has a BMI estimated to be about 0.62 points higher than the average for a student who speaks another language better than English, based on our samples.</li>
<li>Our 90% confidence interval for the difference (English - non-English) of the population means is now (-1.5, 2.7) based on the pooled t procedure.</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure. We conclude again that there is no strong evidence to conclude a meaningful difference between the true means of the English and non-English <code>bmi</code> levels.</li>
<li>The assumptions of the pooled t test are
<ul>
<li>that the samples in each group are drawn independently of each other,</li>
<li>that the samples in each group represent a random sample of the population of interest,</li>
<li>the samples in each group are drawn from a Normally distributed population,</li>
<li><em>and</em> that either the sample sizes or the population variances are equal.</li>
</ul></li>
<li>The Normality assumption remains hard to justify given these data, so we should look at alternatives.</li>
</ul>
</section>
<section id="the-wilcoxon-mann-whitney-rank-sum-test" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="the-wilcoxon-mann-whitney-rank-sum-test"><span class="header-section-number">5.3.3</span> The Wilcoxon-Mann-Whitney rank sum test</h3>
<p>The first test we’ll look that doesn’t require Normality is the Wilcoxon-Mann-Whitney rank sum test. The main problem with this approach is that it doesn’t estimate the difference in population means, but rather it estimates a location shift for the distribution as a whole. Here is a 90% confidence interval for the difference between the non-English and English population <code>bmi</code> distributions based on the rank sum approach.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(bmi <span class="sc">~</span> english, <span class="at">data =</span> sur15_B,</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf.level =</span> .<span class="dv">90</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>() <span class="sc">|&gt;</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  estimate conf.low conf.high
     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1   -0.126    -1.89      1.41</code></pre>
</div>
</div>
<ul>
<li>The estimated location shift in population <code>bmi</code> across the two language groups is 0.13.</li>
<li>Our 90% confidence interval for the location shift (English - non-English) of the populations is (-1.4, 1.9).</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure. We see potential true locations of the difference between English and non-English <code>bmi</code> levels that include both positive and negative values.
<ul>
<li>The assumptions of the rank sum test are
<ul>
<li>that the samples in each group are drawn independently of each other,</li>
<li><em>and</em> that the samples in each group represent a random sample of the population of interest,</li>
<li>and that the data in each population (English and non-English) are symmetric.</li>
</ul></li>
</ul></li>
</ul>
<p>That last assumption is difficult to justify.</p>
</section>
<section id="the-bootstrap-for-comparing-means-from-two-independent-samples" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="the-bootstrap-for-comparing-means-from-two-independent-samples"><span class="header-section-number">5.3.4</span> The Bootstrap for comparing means from two independent samples</h3>
<p>The other approach we have for independent samples comparisons that doesn’t require Normality is the bootstrap, and specifically, the <code>bootdif</code> function. This approach returns to estimating the difference in population means, but gives a different answer depending on the choice of random number seed. Here is a 90% confidence interval for the difference between the English and non-English population <code>bmi</code> distributions based on the bootstrap using a seed of <code>431</code>. (<em>Note</em>: when you set a seed for this or other analyses in the project, pick something other than <code>431</code>.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">431</span>) </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bootdif</span>(sur15_B<span class="sc">$</span>bmi, sur15_B<span class="sc">$</span>english, <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The population mean BMI in those who said Yes is estimated to be about 0.62 points higher than the population mean BMI for those who said No, based on our samples. So the mean differences’ point estimate is 0.62</li>
<li>Our 90% confidence interval for the difference (Yes - No) of the population means is (-1.12, 2.34).</li>
<li>Here, I’ve assumed a two-sided confidence interval procedure. We conclude from the confidence interval that the difference between the true means of the English and non-English <code>bmi</code> levels could be either positive or negative, according to our analysis.</li>
<li>The assumptions of this bootstrap procedure are:
<ul>
<li>that the samples in each group are drawn independently of each other,</li>
<li><em>and</em> that the samples in each group represent a random sample of the population of interest.</li>
</ul></li>
</ul>
<p>So, I think the bootstrap procedure would be most appropriate here, due to the non-Normality (and in particular the asymmetry) in the samples.</p>
</section>
</section>
<section id="conclusions-1" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="conclusions-1"><span class="header-section-number">5.4</span> Conclusions</h2>
<p>We find a range of possible values which crosses zero for the difference between the population mean BMI for those who speak English best and those who speak another language best, based on our sample of respondents with complete data on BMI. This conclusion is motivated by a bootstrap estimate to compare the two groups (English and non-English) with complete data on BMI. I feel this is the most justified approach based on the apparent skew in the data (particularly among those who speak English best) in these students.</p>
<p>Then, if this were an actual Project B Study 1, I’d discuss the other issues that go into a conclusion, including limitations of this study and suggestions about logical next steps. But I’ll be lazy and skip that for now.</p>
</section>
</section>
<section id="analysis-c-comparing-3-population-means-via-anova" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Analysis C: Comparing 3+ Population Means via ANOVA</h1>
<section id="the-question-2" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="the-question-2"><span class="header-section-number">6.1</span> The Question</h2>
<p>We’ll compare <code>comfort_431</code> by <code>grades_r</code> in this analysis, using the analysis of variance, and related tools. We’re comparing the mean <code>comfort_431</code> scores of the population represented by the respondents who got their best grades_r on individual work, to the population represented by the respondents who got their best grades_r with a partner, to the population represented by the respondents who got their best grades_r on group work. There is no link between subjects across the three <code>grades_r</code> groups, so the samples are independent. Plus, as we’ll see, there are different numbers of subjects in the three <code>grades_r</code> groups, so there’s no way their <code>comfort_431</code> values could be matched. As a result, we’re going to be interested in looking at the three samples separately to help us understand issues related to hypothesis testing assumptions. <strong>Note that we’ll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project B Study 1 work, as well.</strong></p>
<p>If this were an actual Study 1, rather than a demonstration, I’d build a research question here, but I won’t.</p>
</section>
<section id="describing-the-data-2" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="describing-the-data-2"><span class="header-section-number">6.2</span> Describing the Data</h2>
<p>I’ll start by looking at the range of the <code>comfort_431</code> data within each <code>grades_r</code> group.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(grades_r) <span class="sc">|&gt;</span> <span class="fu">reframe</span>(<span class="fu">lovedist</span>(comfort_431))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 11
  grades_r       n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;fct&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Individual    40     0  79.0  15.3    80  14.8    35  73.8    90   100
2 Partner        6     0  53.3  26.8    60  25.9    15  35      70    85
3 Group          6     0  79.5  16.1    85  10.4    50  76      88    95
4 &lt;NA&gt;           1     0  70    NA      70   0      70  70      70    70</code></pre>
</div>
</div>
<p>We have only 6 respondents in each of the Partner and Group <code>grades_r</code> categories, so that will make it difficult to say much about the distributions of <code>comfort_431</code> in those populations.</p>
<section id="dropping-the-subject-with-a-missing-grades_r-value" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="dropping-the-subject-with-a-missing-grades_r-value"><span class="header-section-number">6.2.1</span> Dropping the subject with a missing <code>grades_r</code> value</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(sur15<span class="sc">$</span>grades_r) <span class="sc">|&gt;</span> <span class="fu">html</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: 󅒐
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>

<title> Descriptives</title>
<span style="font-weight:bold">sur15$grades_r</span><div style="float: right; text-align: right;"><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAoAAAANCAMAAACn6Q83AAAACVBMVEUAAADMzMz////1iUV5AAAAH0lEQVQImWNgYIQBBgYmGCCNSbYJYC4DA8gEsCkMDAA5cADEv6lXIAAAAABJRU5ErkJggg==" alt="image"></div>
<style>
 .hmisctable677061 {
 border: none;
 font-size: 85%;
 }
 .hmisctable677061 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable677061 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table data-quarto-disable-processing="true" class="hmisctable677061">
 <tbody><tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>52</td><td>1</td><td>3</td></tr>
 </tbody></table>

<pre style="font-size:85%;"> Value      Individual    Partner      Group
 Frequency          40          6          6
 Proportion      0.769      0.115      0.115 </pre>

</div>
</div>
<p>As you can see, we have one subject with a missing value for the <code>grades_r</code> variable. We’ll drop that subject for the remainder of Analysis 2 (and also for Analysis 3 to come). While I’m at it, I’ll also select only those variables that we might use in Analysis C. That combined effort will yield the new data frame: <code>sur15_C</code>, which I will use for the remainder of Analysis C.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>sur15_C <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(grades_r)) <span class="sc">|&gt;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s_id, grades_r, comfort_431)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="graphical-summaries-1" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="graphical-summaries-1"><span class="header-section-number">6.2.2</span> Graphical Summaries</h3>
<p>Since we are exploring the distributions of three independent samples, I’ll plot each of the groups in a comparison boxplot, as a start.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sur15_C, <span class="fu">aes</span>(<span class="at">x =</span> grades_r, <span class="at">y =</span> comfort_431, <span class="at">fill =</span> grades_r)) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comfort with 431 by Type of Assignment that produces best grades_r"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Comfort with 431 Materials (0-100)"</span>,</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/comparison_boxplot_analysis_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Notice that the boxplot notches would have been messy (they extend outside the levels of the boxes) in this case due to the small numbers of subjects in the Partner and Group <code>grades_r</code> groups.</li>
</ul>
<p>The sample sizes are so small that histograms for those two levels of the <code>grades_r</code> factor (Partner and Group) tell us nothing of substantial value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sur15_C, <span class="fu">aes</span>(<span class="at">x =</span> comfort_431)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> grades_r), <span class="at">bins =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> grades_r, <span class="at">labeller =</span> <span class="st">"label_both"</span>) <span class="sc">+</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comfort with 431 by Type of Assignment that produces best grades_r"</span>,</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Comfort with 431 Materials (0-100)"</span>,</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/comparison_histograms_analysis_2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>In addition, the Individual data look as though they may be either skewed to the left a bit or at least have one potential outlier.</li>
<li>With these tiny sample sizes (less than 10 observations) these plots don’t really help much. All of the values in each group are within the stated response levels (0-100) but otherwise, there’s not a lot to go on. ANOVA is quite robust, so we’ll run it, but I expect that a Kruskal-Wallis approach may also be useful here.</li>
</ul>
</section>
<section id="numerical-summaries-1" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="numerical-summaries-1"><span class="header-section-number">6.2.3</span> Numerical Summaries</h3>
<p>With just six observations in the Partner and Group <code>grades_r</code> levels, there’s not much to see in numerical summaries, either.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>sur15_C <span class="sc">|&gt;</span> <span class="fu">group_by</span>(grades_r) <span class="sc">|&gt;</span> <span class="fu">reframe</span>(<span class="fu">lovedist</span>(comfort_431))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 11
  grades_r       n  miss  mean    sd   med   mad   min   q25   q75   max
  &lt;fct&gt;      &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Individual    40     0  79.0  15.3    80  14.8    35  73.8    90   100
2 Partner        6     0  53.3  26.8    60  25.9    15  35      70    85
3 Group          6     0  79.5  16.1    85  10.4    50  76      88    95</code></pre>
</div>
</div>
<p>We have 40 Individual, 6 Partner and 6 Group subjects with known comfort levels.</p>
<p>The conclusion I draw from all of this is that we need to run both ANOVA and Kruskal-Wallis approaches, but that we probably can’t trust either of them too much, with such small sample sizes in the non-Individual <code>grades_r</code> levels. Anything below 10 subjects is just too small, and, practically, I’d consider collapsing the groups to <code>Individual</code> vs.&nbsp;<code>All Other</code>. But for this demonstration, I’ll press on.</p>
</section>
</section>
<section id="main-analysis-2" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="main-analysis-2"><span class="header-section-number">6.3</span> Main Analysis</h2>
<p>As you’ll recall, we have at least two available methods for building statistical inferences when comparing more than two independent samples.</p>
<ul>
<li>Analysis of Variance</li>
<li>The Kruskal-Wallis Test</li>
</ul>
<p>There is also a bootstrap approach but we’ll defer discussion of that until 432.</p>
<p>Let’s run both methods here just so you have the code, even though we don’t have large enough data samples in the <code>Partner</code> and <code>Group</code> levels to justify statistical inference at all. In each case, we’ll build hypothesis tests, and compare the distributions of <code>comfort_431</code> across levels of <code>grades_r</code> using a 90% confidence level.</p>
<section id="kruskal-wallis-test" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="kruskal-wallis-test"><span class="header-section-number">6.3.1</span> Kruskal-Wallis Test</h3>
<p>I’ll start with the Kruskal-Wallis test, which at least doesn’t require me to assume Normality in the three populations. The null hypothesis here is that there is no location shift in the distributions of comfort in 431 across the three levels of <code>grades_r</code>. Put another way, the location parameters of the distributions are the same across the three <code>grades_r</code> levels. The Kruskal-Wallis test is the extension of the Wilcoxon-Mann-Whitney rank sum test to studies involving more than two independent samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(comfort_431 <span class="sc">~</span> grades_r, <span class="at">data =</span> sur15_C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  comfort_431 by grades_r
Kruskal-Wallis chi-squared = 6.8034, df = 2, p-value = 0.03332</code></pre>
</div>
</div>
<ul>
<li>This result suggests only that the separation we observe between the <code>comfort_431</code> scores for the three <code>grades_r</code> categories is consistent with some true differences between those groups.</li>
<li>The assumptions of the Kruskal-Wallis test are the same as those of the Wilcoxon-Mann-Whitney rank sum test, specifically that
<ul>
<li>that the samples in each category are drawn independently of each other,</li>
<li><em>and</em> that the samples in each category represent a random sample of the population of interest,</li>
</ul></li>
</ul>
<p>The main problem here is that the sample size is so small that we can’t tell whether this result is truly more or less reasonable than an ANOVA approach. We really need a minimum of 15 observations (and ideally more like 30) in each group to let our histograms and boxplots have any chance to be informative on these points. So let’s look at the ANOVA results.</p>
</section>
<section id="analysis-of-variance" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="analysis-of-variance"><span class="header-section-number">6.3.2</span> Analysis of Variance</h3>
<p>The Analysis of Variance compares the means of <code>comfort_431</code> in the three <code>grades_r</code> populations. We can run the analysis using either of two approaches, each of which we’ll show in what follows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(comfort_431 <span class="sc">~</span> grades_r, <span class="at">data =</span> sur15_C) <span class="sc">|&gt;</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: comfort_431
          Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
grades_r   2  3504.1 1752.05  6.1301 0.004207 **
Residuals 49 14004.7  285.81                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Here, we’d conclude only that the results we have are not particularly consistent with an assumption that there are no differences between the population mean <code>comfort_431</code> scores for the three <code>grades_r</code> categories.</li>
<li>The <code>grades_r</code> account for <span class="math inline">\(\eta^2 = \frac{3504.1}{3504.1 + 14004.7} = 0.2\)</span> or 20% of the variation in <code>comfort_431</code> scores in our sample.</li>
<li>The natural next question is to try to identify which pairs of <code>grades_r</code> categories show larger estimated differences, and we’ll tackle that in a moment with Bonferroni/Holm and Tukey HSD approaches.</li>
<li>ANOVA is the natural extension of the pooled t test for two independent samples, and so it has the same set of assumptions when we compare population means across multiple categories (here, the three <code>grades_r</code> categories)…
<ul>
<li>that the samples in each category are drawn independently of each other,</li>
<li>that the samples in each category represent a random sample of the population of interest,</li>
<li>the samples in each category are drawn from a Normally distributed population,</li>
<li><em>and</em> that either the sample sizes or the population variances are equal across the categories.</li>
</ul></li>
</ul>
<p>The main problem here is that the sample size is so small that we can’t tell whether this result is truly reasonable or not. We really need a minimum of 15 observations (and ideally more like 30) in each group to let our histograms and boxplots have any chance to be informative on these points. We’ll move on to looking at the pairwise comparisons, though, in this demonstration.</p>
</section>
<section id="holm-approach-to-pairwise-comparisons-of-means" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="holm-approach-to-pairwise-comparisons-of-means"><span class="header-section-number">6.3.3</span> Holm approach to Pairwise Comparisons of Means</h3>
<p>We have two approaches available for dealing with multiple comparisons. If we had not pre-planned the full set of pairwise comparisons of <code>comfort_431</code> across the <code>grades_r</code> categories, or if we wanted to use a fairly conservative approach, we could apply a Holm correction to our comparisons. This works reasonably well even with an unbalanced design, such as we have here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(sur15_C<span class="sc">$</span>comfort_431, sur15_C<span class="sc">$</span>grades_r, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust =</span> <span class="st">"holm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  sur15_C$comfort_431 and sur15_C$grades_r 

        Individual Partner
Partner 0.0034     -      
Group   0.9411     0.0200 

P value adjustment method: holm </code></pre>
</div>
</div>
<ul>
<li>Our process detects positive differences between the mean of the Partner category and the means of the other two categories, but suggests that the difference between Individual and Group means covers both positive and negative values.</li>
<li>The assumptions here include the ANOVA assumptions, which are no more or less justified than they were before. We do not, however, require that our pairwise comparisons be pre-planned.</li>
<li>You can learn more about the Holm method <a href="https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method">on its Wikipedia page</a>.</li>
</ul>
</section>
<section id="tukeys-honestly-significant-differences-approach-to-pairwise-comparisons-of-means" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="tukeys-honestly-significant-differences-approach-to-pairwise-comparisons-of-means"><span class="header-section-number">6.3.4</span> Tukey’s Honestly Significant Differences approach to Pairwise Comparisons of Means</h3>
<p>The Tukey HSD approach requires us to use the <code>aov</code> approach to specifying the ANOVA model, as opposed to the <code>anova with lm</code> approach we took above. The results for <code>aov</code> are identical, as you can see below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>(sur15_C<span class="sc">$</span>comfort_431 <span class="sc">~</span> sur15_C<span class="sc">$</span>grades_r) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Df Sum Sq Mean Sq F value  Pr(&gt;F)   
sur15_C$grades_r  2   3504  1752.0    6.13 0.00421 **
Residuals        49  14005   285.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now, we run the Tukey HSD comparisons, both in a plot and table of results. As specified previously, we’ll use a 90% confidence level across the set of comparisons.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(sur15_C<span class="sc">$</span>comfort_431 <span class="sc">~</span> sur15_C<span class="sc">$</span>grades_r), <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    90% family-wise confidence level

Fit: aov(formula = sur15_C$comfort_431 ~ sur15_C$grades_r)

$`sur15_C$grades_r`
                        diff        lwr       upr     p adj
Partner-Individual -25.61667 -41.169906 -10.06343 0.0031728
Group-Individual     0.55000 -15.003240  16.10324 0.9969604
Group-Partner       26.16667   5.655662  46.67767 0.0265110</code></pre>
</div>
</div>
<p>The confidence intervals suggest that the mean Partner scores are lower than both the mean Individual and Group scores, while the Group and Individual scores show differences from each other that could have either sign.</p>
<p>Note that in the plot below, we see these results a bit more clearly after we adjust the margins of the plot and use the <code>las = 1</code> bit at the end of the plotting call to get the x and y axis labels to be horizontal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>mar.default <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.1</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> mar.default <span class="sc">+</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(sur15_C<span class="sc">$</span>comfort_431 <span class="sc">~</span> sur15_C<span class="sc">$</span>grades_r),</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.level =</span> <span class="fl">0.90</span>), <span class="at">las =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/plot_Tukey_HSD_analysis2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> mar.default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="conclusions-2" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="conclusions-2"><span class="header-section-number">6.4</span> Conclusions</h2>
<p>Our conclusions are:</p>
<ul>
<li>that the sample size is just too small in the non-Individual <code>grades_r</code> categories to draw very firm conclusions, but</li>
<li>despite this, there appears to be evidence of some difference in <code>comfort_431</code> across the three <code>grades_r</code> categories, according to either an ANOVA or Kruskal-Wallis approach, at the 90% confidence level, and</li>
<li>specifically, it appears from our 90% pairwise confidence intervals that the population means of the Group and Individual comfort levels are comparable and both are higher than the population mean of the Partner comfort levels.</li>
</ul>
<p>Note that I’ve made no effort here to write these conclusions in the format we’re looking for in your Study 1 work.</p>
</section>
</section>
<section id="analysis-d-two-way-2-x-2-contingency-table" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Analysis D: Two-Way (2 x 2) Contingency Table</h1>
<section id="the-question-3" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="the-question-3"><span class="header-section-number">7.1</span> The Question</h2>
<p>We’ll look at the association of <code>r_before</code> with <code>english</code> in this analysis. The <code>r_before</code> variable and the <code>english</code> variable each have two levels, and suppose we are interested in whether <code>english</code> has an impact on <code>r_before</code>, so we’ll build a contingency table with <code>english</code> in the rows and <code>r_before</code> in the columns. <strong>Note that we’ll use a 90% confidence level and the add 2 successes and 2 failures Bayesian augmentation, and I encourage you to do this in your actual Project B Study 1 work, as well.</strong> I’ll remind you that in your Project B, we’re requiring you to have a minimum number of observations within each cell of the table that I cannot meet here with this tiny sample size.</p>
<p>If this were an actual Study 1, rather than a demonstration, I’d build a research question here, but I have decided to leave that work to you.</p>
</section>
<section id="describing-the-data-3" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="describing-the-data-3"><span class="header-section-number">7.2</span> Describing the Data</h2>
<p>Let’s look at the 2x2 table we get.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sur15<span class="sc">$</span>english, sur15<span class="sc">$</span>r_before)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
      No Yes
  No  10   8
  Yes 18  17</code></pre>
</div>
</div>
<p>Those names could use some work, I think.</p>
<ul>
<li>The row names, in order, should be something like “English” (where “Yes” is now) and “Not English” with “English” first</li>
<li>The column names, respectively, should be “Prior R user” and “No Prior R”, with “Prior R User” first.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>sur15_D <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s_id, english, r_before) <span class="sc">|&gt;</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">english_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(english),</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Not English"</span> <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"English"</span> <span class="ot">=</span> <span class="st">"Yes"</span>),</span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">english_r =</span> <span class="fu">fct_relevel</span>(english_r, <span class="st">"English"</span>),</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_before_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(r_before),</span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"No Prior R"</span> <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Prior R user"</span> <span class="ot">=</span> <span class="st">"Yes"</span>),</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_before_r =</span> <span class="fu">fct_relevel</span>(r_before_r, <span class="st">"Prior R user"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>sur15_D <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(english_r, r_before_r) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   english_r Prior R user No Prior R
     English           17         18
 Not English            8         10</code></pre>
</div>
</div>
</section>
<section id="main-analysis-3" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="main-analysis-3"><span class="header-section-number">7.3</span> Main Analysis</h2>
<p>I <strong>strongly encourage</strong> you to use the Bayesian augmentation where we add two successes and add two failures, as recommended in Agresti and Coull, and to use 90% confidence levels. To accomplish this I’ll use the <code>twoby2</code> function in the <code>Epi</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">table</span>(sur15_D<span class="sc">$</span>english_r, sur15_D<span class="sc">$</span>r_before_r)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">twoby2</span>(t1 <span class="sc">+</span> <span class="dv">2</span>, <span class="at">conf.level =</span> <span class="fl">0.90</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 by 2 table analysis: 
------------------------------------------------------ 
Outcome   : Prior R user 
Comparing : English vs. Not English 

            Prior R user No Prior R    P(Prior R user) 90% conf. interval
English               19         20             0.4872    0.3593   0.6167
Not English           10         12             0.4545    0.2918   0.6276

                                   90% conf. interval
             Relative Risk: 1.0718    0.6701   1.7143
         Sample Odds Ratio: 1.1400    0.4730   2.7473
Conditional MLE Odds Ratio: 1.1376    0.4174   3.1320
    Probability difference: 0.0326   -0.1791   0.2375

             Exact P-value: 1.0000 
        Asymptotic P-value: 0.8064 
------------------------------------------------------</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># uses Bayesian augmentation, 90% confidence level</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note what I did to add two observations to each cell of the table. We can draw conclusions now about:</p>
<ul>
<li>The individual probabilities of being a prior R user in the English and non-English groups, and 90% confidence intervals for each at the top of the output, so that, for instance, we estimate the probability of prior R usage among subjects for whom English is not their best language at 0.45, with 90% confidence interval (0.29, 0.63).</li>
<li>The relative risk of Prior R use given English vs.&nbsp;Prior R use given non-English, which is estimated to be 1.07, and based on its 90% confidence interval is clearly not detectably different from 1 at <span class="math inline">\(\alpha = 0.10\)</span>.</li>
<li>The odds ratio describing the odds of Prior R use given English vs.&nbsp;Non-English, which is estimated to be 1.14, and is clearly not detectably different from 1 at <span class="math inline">\(\alpha = 0.10\)</span>.</li>
<li>The difference in probability of Prior R use for English vs.&nbsp;non-English subjects, which is estimated to be 0.033, with a 90% confidence interval of (-0.18, 0.24) and is not detectably different from 0 at <span class="math inline">\(\alpha = 0.10\)</span>.</li>
<li>The chi-square test of independence, which assesses the null hypothesis of no association between language preference and prior R usage, using either Fisher’s exact test or the Pearson chi-square test (labeled asymptotic here.) The evidence does not let us reject the null hypothesis.</li>
</ul>
<section id="checking-assumptions" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="checking-assumptions"><span class="header-section-number">7.3.1</span> Checking Assumptions</h3>
<p>Since each cell in our (non-augmented) 2x2 table is at least 5, R throws no warning messages. We should be reasonably comfortable with the chi-square test of independence here. If every cell was 10 or more, we’d be even more comfortable.</p>
</section>
<section id="what-if-we-wanted-to-type-in-the-table-ourselves" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="what-if-we-wanted-to-type-in-the-table-ourselves"><span class="header-section-number">7.3.2</span> What If We Wanted to Type in the Table Ourselves?</h3>
<p>With the <code>twobytwo</code> function available in the <code>Love-boost.R</code> script, we can directly obtain 90% confidence intervals. For example, suppose we had the following data, pulled from our 2016 survey:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;">2016 Survey</th>
<th style="text-align: right;">Drank Tea Recently</th>
<th style="text-align: right;">Didn’t Drink Tea</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Not Born in US</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: right;">US Born</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">18</td>
</tr>
</tbody>
</table>
<p>Suppose we wanted to use <code>twobytwo</code> and the +2/+4 Bayesian augmentation (adding 2 to the count in each cell of our 2x2 table) and a 90% confidence interval for this comparison, to see whether the population proportions who drank tea recently differ between those born in and out of the US.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">twobytwo</span>(<span class="dv">21</span><span class="sc">+</span><span class="dv">2</span>, <span class="dv">10</span><span class="sc">+</span><span class="dv">2</span>, <span class="dv">20</span><span class="sc">+</span><span class="dv">2</span>, <span class="dv">18</span><span class="sc">+</span><span class="dv">2</span>,</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Not US Born"</span>, <span class="st">"US Born"</span>, <span class="st">"Drank Tea"</span>, <span class="st">"No Tea"</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">conf.level =</span> <span class="fl">0.90</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2 by 2 table analysis: 
------------------------------------------------------ 
Outcome   : Drank Tea 
Comparing : Not US Born vs. US Born 

            Drank Tea No Tea    P(Drank Tea) 90% conf. interval
Not US Born        23     12          0.6571    0.5162   0.7749
US Born            22     20          0.5238    0.3982   0.6465

                                   90% conf. interval
             Relative Risk: 1.2545    0.9160   1.7181
         Sample Odds Ratio: 1.7424    0.8024   3.7839
Conditional MLE Odds Ratio: 1.7299    0.7276   4.1948
    Probability difference: 0.1333   -0.0512   0.3036

             Exact P-value: 0.2561 
        Asymptotic P-value: 0.2389 
------------------------------------------------------</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusions-3" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="conclusions-3"><span class="header-section-number">7.4</span> Conclusions</h2>
<p>Our primary conclusions about the study we’ve done here in Analysis D should be motivated by the fact that the 90% confidence intervals for the RR and the OR cross 1, and that the probability difference isn’t detectably different from 0, either, with 90% confidence.</p>
<p>Then we’d write more about limitations and opportunities for further work, were this an actual Study 1, instead of just a demonstration.</p>
</section>
</section>
<section id="analysis-e-two-way-3-x-4-contingency-table" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Analysis E: Two-Way (3 x 4) Contingency Table</h1>
<section id="the-question-4" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="the-question-4"><span class="header-section-number">8.1</span> The Question</h2>
<p>We’ll look at the association of two categorical factors we created earlier: <code>medium_r</code> and <code>fiction_r</code> in this analysis. We’re interested in whether there is an association between the ways in which subjects consumed their fiction, and the type of fiction they most enjoy. The <code>medium_r</code> data have three levels, and the <code>fiction_r</code> data have four levels. <strong>Note that we’ll use a 90% confidence level and I encourage you to do this in your actual Project B Study 1 work, as well.</strong></p>
<p>If this were an actual Study 1, rather than a demonstration, I’d build a research question here, but I have decided to leave that work to you.</p>
</section>
<section id="describing-the-data-4" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="describing-the-data-4"><span class="header-section-number">8.2</span> Describing the Data</h2>
<p>Let’s store this initial table of interest as <code>table_E1</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>table_E1 <span class="ot">&lt;-</span> <span class="fu">table</span>(sur15<span class="sc">$</span>medium_r, sur15<span class="sc">$</span>fiction_r)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>table_E1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         Comedy Drama Fantasy/SF Other
  Movies      4     5          6     2
  TV         11     5          2     4
  Other       3     5          6     0</code></pre>
</div>
</div>
<p>We could add the marginal totals, I suppose.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="sc">|&gt;</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(medium_r, fiction_r) <span class="sc">|&gt;</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> medium_r Comedy Drama Fantasy/SF Other Total
   Movies      4     5          6     2    17
       TV     11     5          2     4    22
    Other      3     5          6     0    14
    Total     18    15         14     6    53</code></pre>
</div>
</div>
<p>Note that we don’t meet the Cochran conditions here. In particular, we still have a 0 cell, and that might motivate us to consider collapsing or removing the “Other” category from the <code>fiction_r</code> variable.</p>
<p><strong>NOTE</strong>: In doing your project B, I would only proceed once I’d identified variables (after whatever collapsing you decide to do) that meet the Cochran conditions (described below.)</p>
<p>I’ll leave it alone for now, and see what happens, returning to this later. The research question, if I’d written would need to address whether which medium (Movies, TV or other) you like is associated with which genre (Comedy, Drama, Fantasy/SF) you prefer.</p>
</section>
<section id="main-analysis-4" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="main-analysis-4"><span class="header-section-number">8.3</span> Main Analysis</h2>
<section id="running-the-pearson-chi2-test" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="running-the-pearson-chi2-test"><span class="header-section-number">8.3.1</span> Running the Pearson <span class="math inline">\(\chi^2\)</span> Test</h3>
<p>We’ll run the Pearson <span class="math inline">\(\chi^2\)</span> test using:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(table_E1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in stats::chisq.test(x, y, ...): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table_E1
X-squared = 10.322, df = 6, p-value = 0.1117</code></pre>
</div>
</div>
<p>Note the warning, because our table does not meet the Cochran conditions.</p>
</section>
<section id="running-fishers-exact-test" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="running-fishers-exact-test"><span class="header-section-number">8.3.2</span> Running Fisher’s Exact Test</h3>
<p><strong>NOTE</strong>: In doing your project B, I would only proceed once I’d identified variables (after whatever collapsing you decide to do) that meet the Cochran conditions (described below.) I would not run Fisher’s test.</p>
<p>Given a small overall sample size, the <code>fisher.test</code> command will also produce a Fisher’s exact test, which may be a little more appropriate here, given the presence of cells with small counts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(table_E1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  table_E1
p-value = 0.0983
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Based on the Fisher test, we would get only a slightly different conclusion than the Pearson test. However,</p>
<ol type="a">
<li>Our conclusions are quite dependent on the choice of <span class="math inline">\(\alpha\)</span> level.</li>
<li>Neither test is really appropriate, since we have very small cell counts, including a zero.</li>
</ol>
</section>
<section id="checking-assumptions---the-cochran-conditions" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="checking-assumptions---the-cochran-conditions"><span class="header-section-number">8.3.3</span> Checking Assumptions - The Cochran Conditions</h3>
<p>The “Cochran conditions”, which require that we have:</p>
<ul>
<li>no cells with 0 counts</li>
<li>at least 80% of the cells in our table with counts of 5 or higher</li>
<li>expected counts in each cell of the table should be 5 or more</li>
</ul>
<p>We don’t meet those Cochran conditions here. In addition, since each cell in our 3x4 table is NOT at least 5, R throws a warning message when we run the Pearson <span class="math inline">\(\chi^2\)</span> test, and since we don’t meet the Cochran conditions, the <code>fisher.test</code> results are questionable, as well. We should consider whether collapsing or deleting some of the rows or columns might be more reasonable. And we’ll do this next.</p>
</section>
<section id="an-association-plot-for-the-3x4-table" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="an-association-plot-for-the-3x4-table"><span class="header-section-number">8.3.4</span> An Association Plot for the 3x4 Table</h3>
<p>The <code>assocplot</code> function in R produces a plot that indicates deviations from the assumption of independence of rows and columns in a two-way table. For instance, using our original table, we have:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assocplot</span>(table_E1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/assoc_plot_table_E1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We can see that the independence model really doesn’t work well for the cells with larger shapes here, which we note especially in the Fantasy/SF category, and to some extent in the Comedy category.</p>
<p><strong>Hint</strong>: Finding a better scheme for visualizing a contingency table’s relationship to independence (or simply the table itself), especially if it’s using the <code>gt</code> package, would be a good idea to explore further in Analysis E, too, especially if you’re looking to learn to build savvy tables. But this is not necessary, certainly.</p>
</section>
<section id="a-2x3-table-after-collapsing-lumping-some-small-rows-and-columns" class="level3" data-number="8.3.5">
<h3 data-number="8.3.5" class="anchored" data-anchor-id="a-2x3-table-after-collapsing-lumping-some-small-rows-and-columns"><span class="header-section-number">8.3.5</span> A 2x3 Table, After Collapsing (Lumping) Some Small Rows and Columns</h3>
<p>Suppose we instead decided to drop down to a study of TV vs.&nbsp;Other media (combining Movies and Other) and also collapsed the Fantasy/SF and Other columns (so the remaining subjects form a 2x3 table), in an effort to remove zero cells, and reduce the incidence of cells with counts below 5.</p>
<p>First, we’ll combine the Movies and Other groups to create <code>medium_2</code> from <code>medium_r</code> using <code>fct_recode</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">medium_2 =</span> <span class="fu">fct_recode</span>(medium_r, </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Not TV"</span> <span class="ot">=</span> <span class="st">"Movies"</span>,</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"TV"</span> <span class="ot">=</span> <span class="st">"TV"</span>,</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Not TV"</span> <span class="ot">=</span> <span class="st">"Other"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or, we can use the <code>fct_lump</code> function to lump together the two categories with the smallest overall counts directly, in creating <code>fiction_3</code> from <code>fiction_r</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>sur15 <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fiction_3 =</span> <span class="fu">fct_lump</span>(fiction_r, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s call the collapsed table <code>table_E2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>table_E2 <span class="ot">&lt;-</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table</span>(sur15<span class="sc">$</span>medium_2, sur15<span class="sc">$</span>fiction_3)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>table_E2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
         Comedy Drama Other
  Not TV      7    10    14
  TV         11     5     6</code></pre>
</div>
</div>
<p>This new 2x3 table loses some fidelity, but gains in that each cell now contains at least 5 subjects. I’ll remind you that in your Project B, we’re requiring you to have even more than that in each cell.</p>
</section>
<section id="chi-square-testing-for-the-2x3-table" class="level3" data-number="8.3.6">
<h3 data-number="8.3.6" class="anchored" data-anchor-id="chi-square-testing-for-the-2x3-table"><span class="header-section-number">8.3.6</span> Chi-Square Testing for the 2x3 Table</h3>
<p>And here are the results from chi-square testing…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(table_E2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  table_E2
X-squared = 4.3528, df = 2, p-value = 0.1135</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(table_E2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  table_E2
p-value = 0.1483
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>For the project, once all of the cells have at least 5 observations, I recommend the use of the Pearson approach, unless the table is square (# of rows = # of columns), in which case the Fisher test is also a reasonable choice. Generally, the Fisher test is more appropriate when the sample sizes are small. In this case, of course, it doesn’t matter much after collapsing cells and forming this 2x3 table. We’ll close with the association plot for this smaller table, which suggests that the independence model inverts its errors for Comedy as compared to the other two categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assocplot</span>(table_E2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="sample-study1_files/figure-html/table_E2_assocplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusions-4" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="conclusions-4"><span class="header-section-number">8.4</span> Conclusions</h2>
<p>Using the collapsed <code>table_E2</code> to meet the Cochran conditions, and either the Pearson or Fisher test we detect no strong association between the favorite consumption method and favorite genre. I’d also spend a bit of time talking about the results of the <code>assocplot</code>, I think, or at least make some effort to indicate where the independence assumption holds less well, even though it doesn’t reach the point where we can reject it with 90% confidence.</p>
<p>Again, it’s your job to identify and discuss your conclusions, as expected in the instructions for Project B Study 1. This is just a demonstration.</p>
</section>
</section>
<section id="session-information" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Session Information</h1>
<p>End your report with the session information, in its own section. This will be Section 8 for you, but it’s Section 9 for me because I did all five analyses, whereas you will only do four.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">session_info</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.1 (2024-06-14 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 22631)

Locale:
  LC_COLLATE=English_United States.utf8 
  LC_CTYPE=English_United States.utf8   
  LC_MONETARY=English_United States.utf8
  LC_NUMERIC=C                          
  LC_TIME=English_United States.utf8    

Package version:
  askpass_1.2.1          backports_1.5.0        base64enc_0.1-3       
  bayestestR_0.15.0      bit_4.5.0              bit64_4.5.2           
  blob_1.2.4             broom_1.0.7            bslib_0.8.0           
  cachem_1.1.0           callr_3.7.6            cellranger_1.1.0      
  checkmate_2.3.2        cli_3.6.3              clipr_0.8.0           
  cluster_2.1.6          cmprsk_2.2-12          coda_0.19-4.1         
  codetools_0.2-20       colorspace_2.1-1       compiler_4.4.1        
  conflicted_1.2.0       correlation_0.8.6      cpp11_0.5.0           
  crayon_1.5.3           curl_5.2.3             data.table_1.16.2     
  datasets_4.4.1         datawizard_0.13.0      DBI_1.2.3             
  dbplyr_2.5.0           digest_0.6.37          dplyr_1.1.4           
  dtplyr_1.3.1           easystats_0.7.3        effectsize_0.8.9      
  emmeans_1.10.5         Epi_2.56               estimability_1.5.1    
  etm_1.1.1              evaluate_1.0.1         fansi_1.0.6           
  farver_2.1.2           fastmap_1.2.0          fontawesome_0.5.2     
  forcats_1.0.0          foreign_0.8-87         Formula_1.2-5         
  fs_1.6.4               gargle_1.5.2           generics_0.1.3        
  ggformula_0.12.0       ggplot2_3.5.1          ggridges_0.5.6        
  glue_1.8.0             googledrive_2.1.1      googlesheets4_1.1.1   
  graphics_4.4.1         grDevices_4.4.1        grid_4.4.1            
  gridExtra_2.3          gtable_0.3.6           haven_2.5.4           
  highr_0.11             Hmisc_5.2-0            hms_1.1.3             
  htmlTable_2.4.3        htmltools_0.5.8.1      htmlwidgets_1.6.4     
  httr_1.4.7             ids_1.0.1              insight_0.20.5        
  isoband_0.2.7          janitor_2.2.0          jquerylib_0.1.4       
  jsonlite_1.8.9         knitr_1.48             labeling_0.4.3        
  labelled_2.13.0        lattice_0.22-6         lifecycle_1.0.4       
  lubridate_1.9.3        magrittr_2.0.3         MASS_7.3-61           
  Matrix_1.7-0           memoise_2.0.1          methods_4.4.1         
  mgcv_1.9-1             mime_0.12              modelbased_0.8.9      
  modelr_0.1.11          mosaic_1.9.1           mosaicCore_0.9.4.0    
  mosaicData_0.20.4      multcomp_1.4-26        munsell_0.5.1         
  mvtnorm_1.3-1          naniar_1.1.0           nlme_3.1-164          
  nnet_7.3-19            norm_1.0.11.1          numDeriv_2016.8-1.1   
  openssl_2.2.2          parallel_4.4.1         parameters_0.23.0     
  patchwork_1.3.0        performance_0.12.4     pillar_1.9.0          
  pkgconfig_2.0.3        plyr_1.8.9             prettyunits_1.2.0     
  processx_3.8.4         progress_1.2.3         ps_1.8.0              
  purrr_1.0.2            R6_2.5.1               ragg_1.3.3            
  rappdirs_0.3.3         RColorBrewer_1.1.3     Rcpp_1.0.13           
  RcppArmadillo_14.0.2.1 readr_2.1.5            readxl_1.4.3          
  rematch_2.0.0          rematch2_2.1.2         report_0.5.9          
  reprex_2.1.1           rlang_1.1.4            rmarkdown_2.28        
  rpart_4.1.23           rstudioapi_0.17.1      rvest_1.0.4           
  sandwich_3.1-1         sass_0.4.9             scales_1.3.0          
  see_0.9.0              selectr_0.4.2          snakecase_0.11.1      
  splines_4.4.1          stats_4.4.1            stringi_1.8.4         
  stringr_1.5.1          survival_3.7-0         sys_3.4.3             
  systemfonts_1.1.0      textshaping_0.4.0      TH.data_1.1-2         
  tibble_3.2.1           tidyr_1.3.1            tidyselect_1.2.1      
  tidyverse_2.0.0        timechange_0.3.0       tinytex_0.53          
  tools_4.4.1            tzdb_0.4.0             UpSetR_1.4.0          
  utf8_1.2.4             utils_4.4.1            uuid_1.2.1            
  vctrs_0.6.5            viridis_0.6.5          viridisLite_0.4.2     
  visdat_0.6.0           vroom_1.6.5            withr_3.0.2           
  xfun_0.48              xml2_1.3.6             xtable_1.8-4          
  yaml_2.3.10            zoo_1.8-12            </code></pre>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb142" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "431 Project B Sample Study 1 Report"</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Thomas E. Love"</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> last-modified</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: simplex</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="co">    date-format: iso</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb142-12"><a href="#cb142-12" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb142-13"><a href="#cb142-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-14"><a href="#cb142-14" aria-hidden="true" tabindex="-1"></a>:::{.callout-important}</span>
<span id="cb142-15"><a href="#cb142-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-16"><a href="#cb142-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reminders from Dr. Love </span></span>
<span id="cb142-17"><a href="#cb142-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-18"><a href="#cb142-18" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Remember that each subsection should include at least one complete sentence explaining what you are doing, specifying the variables you are using and how you are using them, and then conclude with at least one complete sentence of discussion of the key conclusions you draw from the current step, and a discussion of any limitations you can describe that apply to the results.</span>
<span id="cb142-19"><a href="#cb142-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-20"><a href="#cb142-20" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>If you want to download the Quarto code I used to create this document, click on the Code button near the title of this Sample Study.</span>
<span id="cb142-21"><a href="#cb142-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-22"><a href="#cb142-22" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>DO NOT use my words (other than the section and subsection headings) included in this sample report in your project. Rewrite everything to make it relevant to your situation. Do not repeat my instructions back to me. </span>
<span id="cb142-23"><a href="#cb142-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-24"><a href="#cb142-24" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb142-25"><a href="#cb142-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-26"><a href="#cb142-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-27"><a href="#cb142-27" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup and Data Ingest</span></span>
<span id="cb142-28"><a href="#cb142-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-29"><a href="#cb142-29" aria-hidden="true" tabindex="-1"></a><span class="fu">## Initial Setup and Package Loads </span></span>
<span id="cb142-30"><a href="#cb142-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-33"><a href="#cb142-33" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-34"><a href="#cb142-34" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb142-35"><a href="#cb142-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-36"><a href="#cb142-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb142-37"><a href="#cb142-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Epi)</span>
<span id="cb142-38"><a href="#cb142-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb142-39"><a href="#cb142-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb142-40"><a href="#cb142-40" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb142-41"><a href="#cb142-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb142-42"><a href="#cb142-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb142-43"><a href="#cb142-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb142-44"><a href="#cb142-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb142-45"><a href="#cb142-45" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xfun)</span>
<span id="cb142-46"><a href="#cb142-46" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span>
<span id="cb142-47"><a href="#cb142-47" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) </span>
<span id="cb142-48"><a href="#cb142-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-49"><a href="#cb142-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Load Love-431 script </span></span>
<span id="cb142-50"><a href="#cb142-50" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"data/Love-431.R"</span>)</span>
<span id="cb142-51"><a href="#cb142-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-52"><a href="#cb142-52" aria-hidden="true" tabindex="-1"></a><span class="do">## Global options</span></span>
<span id="cb142-53"><a href="#cb142-53" aria-hidden="true" tabindex="-1"></a>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">comment=</span><span class="cn">NA</span>)</span>
<span id="cb142-54"><a href="#cb142-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-55"><a href="#cb142-55" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb142-56"><a href="#cb142-56" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-57"><a href="#cb142-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-58"><a href="#cb142-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading the Raw Data into R </span></span>
<span id="cb142-59"><a href="#cb142-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-60"><a href="#cb142-60" aria-hidden="true" tabindex="-1"></a>This document demonstrates a variety of things required in your Project B Study 1. We will demonstrate ideas using data from a 2015 class survey, gathered in three data files available on the <span class="co">[</span><span class="ot">431-data website</span><span class="co">](https://github.com/THOMASELOVE/431-data/tree/main/data-and-code)</span>. The files are called:</span>
<span id="cb142-61"><a href="#cb142-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-62"><a href="#cb142-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`projectB-study1-demo-survey-2015a.xlsx`</span></span>
<span id="cb142-63"><a href="#cb142-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`projectB-study1-demo-survey-2015b.csv`</span></span>
<span id="cb142-64"><a href="#cb142-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`projectB-study1-demo-survey-2015c.csv`</span></span>
<span id="cb142-65"><a href="#cb142-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-66"><a href="#cb142-66" aria-hidden="true" tabindex="-1"></a>After merging, the complete data set should include data on 21 variables for 53 subjects. </span>
<span id="cb142-67"><a href="#cb142-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-68"><a href="#cb142-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I'm going to use <span class="in">`clean_names()`</span> from the <span class="in">`janitor`</span> package before I do the merging. It would also be OK to do this after the merge is complete.</span>
<span id="cb142-69"><a href="#cb142-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>I'm also going to tell R to interpret both a blank "" and an "NA" in a cell of the Excel sheet as indicating a missing value, since that's what I need, and since that's what <span class="in">`read_csv`</span> already does, by default.</span>
<span id="cb142-70"><a href="#cb142-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-73"><a href="#cb142-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-74"><a href="#cb142-74" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb142-75"><a href="#cb142-75" aria-hidden="true" tabindex="-1"></a>sur15_raw_a <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/projectB-study1-demo-survey-2015a.xlsx"</span>, </span>
<span id="cb142-76"><a href="#cb142-76" aria-hidden="true" tabindex="-1"></a>                      <span class="at">na =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"NA"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb142-77"><a href="#cb142-77" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb142-78"><a href="#cb142-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-79"><a href="#cb142-79" aria-hidden="true" tabindex="-1"></a>sur15_raw_b <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/projectB-study1-demo-survey-2015b.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb142-80"><a href="#cb142-80" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb142-81"><a href="#cb142-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-82"><a href="#cb142-82" aria-hidden="true" tabindex="-1"></a>sur15_raw_c <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/projectB-study1-demo-survey-2015c.csv"</span>) <span class="sc">|&gt;</span></span>
<span id="cb142-83"><a href="#cb142-83" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>()</span>
<span id="cb142-84"><a href="#cb142-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-85"><a href="#cb142-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-86"><a href="#cb142-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## Contents of the Raw Tibbles</span></span>
<span id="cb142-87"><a href="#cb142-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-88"><a href="#cb142-88" aria-hidden="true" tabindex="-1"></a>We have three tibbles now, which (once we have merged them together) will contain complete data on all 53 subjects for all 21 variables.</span>
<span id="cb142-89"><a href="#cb142-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-90"><a href="#cb142-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`sur15_raw_a`</span> contains data on all 21 variables for the first 20 subjects.</span>
<span id="cb142-91"><a href="#cb142-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-94"><a href="#cb142-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-95"><a href="#cb142-95" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_a)</span>
<span id="cb142-96"><a href="#cb142-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-97"><a href="#cb142-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-98"><a href="#cb142-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`sur15_raw_b`</span> contains data on 9 of the variables (including the subject ID code: <span class="in">`s.id`</span>) for the other 33 subjects.</span>
<span id="cb142-99"><a href="#cb142-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-102"><a href="#cb142-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-103"><a href="#cb142-103" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_b)</span>
<span id="cb142-104"><a href="#cb142-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-105"><a href="#cb142-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-106"><a href="#cb142-106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`sur15_raw_c`</span> contains data on 13 of the variables (also including the subject ID code: <span class="in">`s.id`</span>) for the same 33 subjects that are in <span class="in">`sur15_raw_b`</span>.</span>
<span id="cb142-107"><a href="#cb142-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-110"><a href="#cb142-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-111"><a href="#cb142-111" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(sur15_raw_c)</span>
<span id="cb142-112"><a href="#cb142-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-113"><a href="#cb142-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-114"><a href="#cb142-114" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two Merging Steps</span></span>
<span id="cb142-115"><a href="#cb142-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-116"><a href="#cb142-116" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Join the columns in <span class="in">`sur15_raw_b`</span> and in <span class="in">`sur15_raw_c`</span> to obtain a new tibble, which I'll call <span class="in">`sur15_last33`</span>, holding information on all 21 variables for the last 33 subjects.</span>
<span id="cb142-117"><a href="#cb142-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-118"><a href="#cb142-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge_step1}</span></span>
<span id="cb142-119"><a href="#cb142-119" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_last33 &lt;- inner_join(sur15_raw_b, sur15_raw_c, by = "s_id")</span></span>
<span id="cb142-120"><a href="#cb142-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-121"><a href="#cb142-121" aria-hidden="true" tabindex="-1"></a><span class="in">dim(sur15_last33)</span></span>
<span id="cb142-122"><a href="#cb142-122" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-123"><a href="#cb142-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-124"><a href="#cb142-124" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Combine the rows together from <span class="in">`sur15_raw_a`</span> (which has the first 20 subjects) and <span class="in">`sur15_last33`</span> (which has the other 33 subjects) to create a tibble called <span class="in">`sur15_merged`</span> which has all 21 variables for all 53 subjects.</span>
<span id="cb142-125"><a href="#cb142-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-126"><a href="#cb142-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r merge_step2}</span></span>
<span id="cb142-127"><a href="#cb142-127" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_merge &lt;- bind_rows(sur15_raw_a, sur15_last33)</span></span>
<span id="cb142-128"><a href="#cb142-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-129"><a href="#cb142-129" aria-hidden="true" tabindex="-1"></a><span class="in">dim(sur15_merge)</span></span>
<span id="cb142-130"><a href="#cb142-130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-131"><a href="#cb142-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-132"><a href="#cb142-132" aria-hidden="true" tabindex="-1"></a>OK. We have 53 subjects and 21 variables, as expected. </span>
<span id="cb142-133"><a href="#cb142-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-134"><a href="#cb142-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking the Merge</span></span>
<span id="cb142-135"><a href="#cb142-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-136"><a href="#cb142-136" aria-hidden="true" tabindex="-1"></a>We need to perform two checks here.</span>
<span id="cb142-137"><a href="#cb142-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-138"><a href="#cb142-138" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>First, we should check to ensure that the number of distinct (unique) subject identification codes (shown below) matches the number of rows. Those two values should be identical. Are they?</span>
<span id="cb142-139"><a href="#cb142-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-142"><a href="#cb142-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-143"><a href="#cb142-143" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">n_distinct</span>(sur15_merge<span class="sc">$</span>s_id), </span>
<span id="cb142-144"><a href="#cb142-144" aria-hidden="true" tabindex="-1"></a>          sur15_merge <span class="sc">|&gt;</span> <span class="fu">nrow</span>())</span>
<span id="cb142-145"><a href="#cb142-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-146"><a href="#cb142-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-147"><a href="#cb142-147" aria-hidden="true" tabindex="-1"></a>Excellent.</span>
<span id="cb142-148"><a href="#cb142-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-149"><a href="#cb142-149" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Second, we should also check that we haven't added any new variables. The <span class="in">`sur15_raw_a`</span> tibble included all of the variable names we should have in the final result. Do the names in <span class="in">`sur15_raw_a`</span> match the names in our merged tibble exactly?</span>
<span id="cb142-150"><a href="#cb142-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-153"><a href="#cb142-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-154"><a href="#cb142-154" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">names</span>(sur15_merge), </span>
<span id="cb142-155"><a href="#cb142-155" aria-hidden="true" tabindex="-1"></a>          <span class="fu">names</span>(sur15_raw_a))</span>
<span id="cb142-156"><a href="#cb142-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-157"><a href="#cb142-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-158"><a href="#cb142-158" aria-hidden="true" tabindex="-1"></a>All right. Our merge was successful.</span>
<span id="cb142-159"><a href="#cb142-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-160"><a href="#cb142-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## Selecting only the variables we'll use</span></span>
<span id="cb142-161"><a href="#cb142-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-162"><a href="#cb142-162" aria-hidden="true" tabindex="-1"></a>The <span class="in">`sur15_merge`</span> data includes some variables we don't need, so we'll prune down to the 11 variables we'll actually use in the analyses we'll do. This should certainly include the subject identification code, so we'll include that, and also switch it to a character representation instead of numeric.</span>
<span id="cb142-163"><a href="#cb142-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-164"><a href="#cb142-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variable_selection}</span></span>
<span id="cb142-165"><a href="#cb142-165" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_merge |&gt;</span></span>
<span id="cb142-166"><a href="#cb142-166" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(s_id = as.character(s_id)) |&gt;</span></span>
<span id="cb142-167"><a href="#cb142-167" aria-hidden="true" tabindex="-1"></a><span class="in">  select(s_id, r_pre, r_now, height, weight, </span></span>
<span id="cb142-168"><a href="#cb142-168" aria-hidden="true" tabindex="-1"></a><span class="in">         comfort_431, grades, r_before, english, </span></span>
<span id="cb142-169"><a href="#cb142-169" aria-hidden="true" tabindex="-1"></a><span class="in">         medium, fiction)</span></span>
<span id="cb142-170"><a href="#cb142-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-171"><a href="#cb142-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-172"><a href="#cb142-172" aria-hidden="true" tabindex="-1"></a><span class="fu"># Cleaning the Data</span></span>
<span id="cb142-173"><a href="#cb142-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-174"><a href="#cb142-174" aria-hidden="true" tabindex="-1"></a><span class="fu">## Our Survey Items</span></span>
<span id="cb142-175"><a href="#cb142-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-176"><a href="#cb142-176" aria-hidden="true" tabindex="-1"></a>The 10 survey items that we will actually use in this demonstration are listed below. </span>
<span id="cb142-177"><a href="#cb142-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-178"><a href="#cb142-178" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rating Variables</span></span>
<span id="cb142-179"><a href="#cb142-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-180"><a href="#cb142-180" aria-hidden="true" tabindex="-1"></a>For each of these, subjects gave a response between 0 and 100 indicating their agreement with the statement as presented. The scale was 0 = Strongly disagree, 100 = Strongly agree.</span>
<span id="cb142-181"><a href="#cb142-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-182"><a href="#cb142-182" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="in">`r_pre`</span>: Prior to taking 431, I was totally confident and comfortable with using R. (0 = Strongly Disagree, 100 = Strongly Agree)</span>
<span id="cb142-183"><a href="#cb142-183" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="in">`r_now`</span>: Right now, I am totally confident and comfortable with using R. (0 = Strongly Disagree, 100 = Strongly Agree)</span>
<span id="cb142-184"><a href="#cb142-184" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="in">`comfort_431`</span>: I am very comfortable with my understanding of the material discussed so far in 431.</span>
<span id="cb142-185"><a href="#cb142-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-186"><a href="#cb142-186" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other Quantitative Variables</span></span>
<span id="cb142-187"><a href="#cb142-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-188"><a href="#cb142-188" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span><span class="in">`height`</span>: What is your height, in inches?</span>
<span id="cb142-189"><a href="#cb142-189" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span><span class="in">`weight`</span>: What is your weight, in pounds?</span>
<span id="cb142-190"><a href="#cb142-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-191"><a href="#cb142-191" aria-hidden="true" tabindex="-1"></a><span class="fu">### Binary Variables</span></span>
<span id="cb142-192"><a href="#cb142-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-193"><a href="#cb142-193" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span><span class="in">`r_before`</span>: Before taking 431, had you ever used R before? (Yes, No)</span>
<span id="cb142-194"><a href="#cb142-194" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span><span class="in">`english`</span>: Is English the language you speak better than any other? (Yes, No)</span>
<span id="cb142-195"><a href="#cb142-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-196"><a href="#cb142-196" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multi-Categorical Variables</span></span>
<span id="cb142-197"><a href="#cb142-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-198"><a href="#cb142-198" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span><span class="in">`grades`</span>: In your graduate and undergraduate educational experience, which of the following types of assignments have you received the HIGHEST grades for?</span>
<span id="cb142-199"><a href="#cb142-199" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Available responses were "A. Individual Assignments", "B. Partner Assignments (you and 1 other student)", and "C. Group Assignments (you and 2 or more others)".</span>
<span id="cb142-200"><a href="#cb142-200" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span><span class="in">`medium`</span>: Which medium do you use most to get your fictional stories (containing plot)?</span>
<span id="cb142-201"><a href="#cb142-201" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Available Responses: "A. Movies", "B. Television", "C. Print (including books, comics, etc.)", and "D. Other".</span>
<span id="cb142-202"><a href="#cb142-202" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span><span class="in">`fiction`</span>: Which type of fictional stories do you consume most?</span>
<span id="cb142-203"><a href="#cb142-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span>Available Responses: "A. Comedy", "B. Drama", "C. Action", "D. Horror / Thriller", and "E. Fantasy / Science Fiction".</span>
<span id="cb142-204"><a href="#cb142-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-205"><a href="#cb142-205" aria-hidden="true" tabindex="-1"></a>Our analytic tibble will be called <span class="in">`sur15`</span> for this demonstration. </span>
<span id="cb142-206"><a href="#cb142-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-207"><a href="#cb142-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This tibble will need to contain information developed from the variables listed above, plus the subject identifying code <span class="in">`s_id`</span>.</span>
<span id="cb142-208"><a href="#cb142-208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As we add variables to the analytic tibble, we'll also check to see that all of the values fall in a reasonable range (with no results that fall outside of the parameters of how we are measuring the results) and we'll identify whether there are any missing values. </span>
<span id="cb142-209"><a href="#cb142-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-210"><a href="#cb142-210" aria-hidden="true" tabindex="-1"></a>Note that we've already checked our subject identification codes to ensure that we have no missing values there and that we have a unique identifier for each row in the data back when we did the merge.</span>
<span id="cb142-211"><a href="#cb142-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-212"><a href="#cb142-212" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking our Quantitative Variables</span></span>
<span id="cb142-213"><a href="#cb142-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-214"><a href="#cb142-214" aria-hidden="true" tabindex="-1"></a>We have five quantitative variables. We want to check the range (minimum and maximum) plus  for each, to ensure that we have no impossible or missing values.</span>
<span id="cb142-215"><a href="#cb142-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-218"><a href="#cb142-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-219"><a href="#cb142-219" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb142-220"><a href="#cb142-220" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb142-221"><a href="#cb142-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(r_pre, r_now, comfort_431, height, weight) <span class="sc">|&gt;</span></span>
<span id="cb142-222"><a href="#cb142-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_codebook</span>()</span>
<span id="cb142-223"><a href="#cb142-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-224"><a href="#cb142-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-225"><a href="#cb142-225" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For the three rating variables, all values are in the range <span class="co">[</span><span class="ot">0, 100</span><span class="co">]</span>, as they must be.</span>
<span id="cb142-226"><a href="#cb142-226" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>However, the <span class="in">`height`</span> range doesn't seem reasonable. With <span class="in">`height`</span> measured in inches, do we really think there should be a height as small as 22.83 inches?</span>
<span id="cb142-227"><a href="#cb142-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`weight`</span> minimum is also a problem. Is 1 pound a reasonable value?</span>
<span id="cb142-228"><a href="#cb142-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We also want to create a body mass index from the <span class="in">`height`</span> and <span class="in">`weight`</span> data</span>
<span id="cb142-229"><a href="#cb142-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-230"><a href="#cb142-230" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combining `height` and `weight` into `bmi` and Specifying `NA` for Implausible Values</span></span>
<span id="cb142-231"><a href="#cb142-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-232"><a href="#cb142-232" aria-hidden="true" tabindex="-1"></a>We will calculate <span class="in">`bmi`</span> (body-mass index) from the available <span class="in">`height`</span> (inches) and <span class="in">`weight`</span> (pounds) data. The BMI formula for inches and pounds is available at http://www.bmi-calculator.net/bmi-formula.php. A reasonable range for BMI values is probably about 15 to 50.</span>
<span id="cb142-233"><a href="#cb142-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-234"><a href="#cb142-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r creating_bmi}</span></span>
<span id="cb142-235"><a href="#cb142-235" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb142-236"><a href="#cb142-236" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-237"><a href="#cb142-237" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(bmi = 703 * weight / height^2)</span></span>
<span id="cb142-238"><a href="#cb142-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-239"><a href="#cb142-239" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; reframe(lovedist(bmi))</span></span>
<span id="cb142-240"><a href="#cb142-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-241"><a href="#cb142-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-242"><a href="#cb142-242" aria-hidden="true" tabindex="-1"></a>The minimum calculated <span class="in">`bmi`</span> value seems impossibly low, and the highest <span class="in">`bmi`</span> seems impossibly high. Let's look at the heights and weights involved. </span>
<span id="cb142-243"><a href="#cb142-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-246"><a href="#cb142-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-247"><a href="#cb142-247" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(height) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb142-248"><a href="#cb142-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-249"><a href="#cb142-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-252"><a href="#cb142-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-253"><a href="#cb142-253" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(height) <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span>
<span id="cb142-254"><a href="#cb142-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-255"><a href="#cb142-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-258"><a href="#cb142-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-259"><a href="#cb142-259" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(weight) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb142-260"><a href="#cb142-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-261"><a href="#cb142-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-264"><a href="#cb142-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-265"><a href="#cb142-265" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(s_id, height, weight) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(weight) <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span>
<span id="cb142-266"><a href="#cb142-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-267"><a href="#cb142-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-268"><a href="#cb142-268" aria-hidden="true" tabindex="-1"></a>The subjects with heights of 22.83 inches and 217 inches are implausible, and the subject with weight 1 pound is also not reasonable. We want to focus on actually plausible results.</span>
<span id="cb142-269"><a href="#cb142-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-270"><a href="#cb142-270" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>A reasonable guess is that no one in the class was less than about 122 centimeters, or 4 feet tall (48 inches) nor were they greater than about 213 centimeters, or 7 feet tall (84 inches) so we're going to change any values outside that range to <span class="in">`NA`</span>.</span>
<span id="cb142-271"><a href="#cb142-271" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Similarly, it seems reasonable to assume that no one in the class was below 80 pounds (36.3 kg) or above 400 pounds (181.4 kg) so again, we'll regard any values we see outside that range is implausible and change them to <span class="in">`NA`</span>.</span>
<span id="cb142-272"><a href="#cb142-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-273"><a href="#cb142-273" aria-hidden="true" tabindex="-1"></a>I'll do this by creating new variables <span class="in">`height_r`</span> and <span class="in">`weight_r`</span> where the <span class="in">`_r`</span> (meaning "revised") indicates to me that I've revised the original variable in some way without adding a lot of characters to its name.</span>
<span id="cb142-274"><a href="#cb142-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-275"><a href="#cb142-275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r recode_implausible_height_weight_as_NA1}</span></span>
<span id="cb142-276"><a href="#cb142-276" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb142-277"><a href="#cb142-277" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-278"><a href="#cb142-278" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(height_r = replace(height, height &lt; 48 | height &gt; 84, NA),</span></span>
<span id="cb142-279"><a href="#cb142-279" aria-hidden="true" tabindex="-1"></a><span class="in">           weight_r = replace(weight, weight &lt; 80 | weight &gt; 400, NA)) |&gt;</span></span>
<span id="cb142-280"><a href="#cb142-280" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(bmi = 703 * weight_r / height_r ^2)</span></span>
<span id="cb142-281"><a href="#cb142-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-282"><a href="#cb142-282" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; select(height_r, weight_r, bmi) |&gt;</span></span>
<span id="cb142-283"><a href="#cb142-283" aria-hidden="true" tabindex="-1"></a><span class="in">  data_codebook()</span></span>
<span id="cb142-284"><a href="#cb142-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-285"><a href="#cb142-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-286"><a href="#cb142-286" aria-hidden="true" tabindex="-1"></a>So now, we have 2 missing values of <span class="in">`height_r`</span>, 1 missing value of <span class="in">`weight_r`</span> and we have calculated BMI results, with 3 missing values, and our ranges (minimum and maximum) for each of these variables now look OK. </span>
<span id="cb142-287"><a href="#cb142-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-288"><a href="#cb142-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking our Binary Variables</span></span>
<span id="cb142-289"><a href="#cb142-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-290"><a href="#cb142-290" aria-hidden="true" tabindex="-1"></a>We have two binary variables.</span>
<span id="cb142-291"><a href="#cb142-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-294"><a href="#cb142-294" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-295"><a href="#cb142-295" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span> <span class="fu">select</span>(english, r_before) <span class="sc">|&gt;</span> <span class="fu">glimpse</span>()</span>
<span id="cb142-296"><a href="#cb142-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-297"><a href="#cb142-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-298"><a href="#cb142-298" aria-hidden="true" tabindex="-1"></a>I'd like those to be factors in R, rather than characters. </span>
<span id="cb142-299"><a href="#cb142-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-300"><a href="#cb142-300" aria-hidden="true" tabindex="-1"></a><span class="in">```{r change_order_no-yes_variables}</span></span>
<span id="cb142-301"><a href="#cb142-301" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-302"><a href="#cb142-302" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(r_before = factor(r_before),</span></span>
<span id="cb142-303"><a href="#cb142-303" aria-hidden="true" tabindex="-1"></a><span class="in">           english = factor(english))</span></span>
<span id="cb142-304"><a href="#cb142-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-305"><a href="#cb142-305" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; count(r_before, english)</span></span>
<span id="cb142-306"><a href="#cb142-306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-307"><a href="#cb142-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-308"><a href="#cb142-308" aria-hidden="true" tabindex="-1"></a>OK. No missingness, and no values out of the range of our expectations. Good.</span>
<span id="cb142-309"><a href="#cb142-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-310"><a href="#cb142-310" aria-hidden="true" tabindex="-1"></a><span class="fu">## Checking our Multi-Category Variables</span></span>
<span id="cb142-311"><a href="#cb142-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-312"><a href="#cb142-312" aria-hidden="true" tabindex="-1"></a>For each of our multi-categorical variables, I'll run a quick <span class="in">`tabyl`</span> to see if we have any surprising results or missing values. Then I'll revise each of them (as needed) to have more suitable (mostly, shorter) level names. In addition to checking for missingness and inappropriate values, we want to collapse some categories, or adjust names or labeling to mirror what we need in our analyses.</span>
<span id="cb142-313"><a href="#cb142-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-314"><a href="#cb142-314" aria-hidden="true" tabindex="-1"></a><span class="fu">### The `grades` variable</span></span>
<span id="cb142-315"><a href="#cb142-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-318"><a href="#cb142-318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-319"><a href="#cb142-319" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb142-320"><a href="#cb142-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(grades)</span>
<span id="cb142-321"><a href="#cb142-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-322"><a href="#cb142-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-323"><a href="#cb142-323" aria-hidden="true" tabindex="-1"></a>For <span class="in">`grades`</span>, we want to create a new factor called <span class="in">`grades_r`</span> which is a factor and which has shorter level names, specifically: Individual, Partner and Group, in that order. We'll use the <span class="in">`fct_recode`</span> function from <span class="in">`forcats`</span>:</span>
<span id="cb142-324"><a href="#cb142-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-325"><a href="#cb142-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r recode_grades_information}</span></span>
<span id="cb142-326"><a href="#cb142-326" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt; </span></span>
<span id="cb142-327"><a href="#cb142-327" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(grades_r = fct_recode(factor(grades), </span></span>
<span id="cb142-328"><a href="#cb142-328" aria-hidden="true" tabindex="-1"></a><span class="in">        "Individual" = "A. Individual Assignments",</span></span>
<span id="cb142-329"><a href="#cb142-329" aria-hidden="true" tabindex="-1"></a><span class="in">        "Partner" = "B. Partner Assignments (you and 1 other student)",</span></span>
<span id="cb142-330"><a href="#cb142-330" aria-hidden="true" tabindex="-1"></a><span class="in">        "Group" = "C. Group Assignments (you and 2 or more others)"))</span></span>
<span id="cb142-331"><a href="#cb142-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-332"><a href="#cb142-332" aria-hidden="true" tabindex="-1"></a><span class="in"># sanity check to ensure we coded correctly</span></span>
<span id="cb142-333"><a href="#cb142-333" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; count(grades, grades_r)</span></span>
<span id="cb142-334"><a href="#cb142-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-335"><a href="#cb142-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-336"><a href="#cb142-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>That looks like we've correctly renamed the values.</span>
<span id="cb142-337"><a href="#cb142-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For this demonstration, we'll allow counts as low as 5 for individual levels of a categorical variable, because of the small sample size, so I won't collapse the levels at all. </span>
<span id="cb142-338"><a href="#cb142-338" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We have a missing value here, so we'll need to deal with that later.</span>
<span id="cb142-339"><a href="#cb142-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-340"><a href="#cb142-340" aria-hidden="true" tabindex="-1"></a><span class="fu">### The `medium` variable</span></span>
<span id="cb142-341"><a href="#cb142-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-344"><a href="#cb142-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-345"><a href="#cb142-345" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb142-346"><a href="#cb142-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(medium)</span>
<span id="cb142-347"><a href="#cb142-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-348"><a href="#cb142-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-349"><a href="#cb142-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We have no missing values, so that's good.</span>
<span id="cb142-350"><a href="#cb142-350" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In this demonstration, we will require that each category have at least 5 responses, so while this just barely meets that standard, I think I will go ahead and collapse the variable down to just three categories.</span>
<span id="cb142-351"><a href="#cb142-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-352"><a href="#cb142-352" aria-hidden="true" tabindex="-1"></a>For the <span class="in">`medium`</span> variable, we want to collapse the Print and Other levels to form a three category variable (with levels Movies, TV and Other) called <span class="in">`medium_r`</span>.</span>
<span id="cb142-353"><a href="#cb142-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-354"><a href="#cb142-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapsing_medium_factor}</span></span>
<span id="cb142-355"><a href="#cb142-355" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-356"><a href="#cb142-356" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(medium_r = fct_recode(factor(medium), </span></span>
<span id="cb142-357"><a href="#cb142-357" aria-hidden="true" tabindex="-1"></a><span class="in">                                 "Movies" = "A. Movies",</span></span>
<span id="cb142-358"><a href="#cb142-358" aria-hidden="true" tabindex="-1"></a><span class="in">                                 "TV" = "B. Television",</span></span>
<span id="cb142-359"><a href="#cb142-359" aria-hidden="true" tabindex="-1"></a><span class="in">                                 "Other" = "C. Print (including books, comics, etc.)",</span></span>
<span id="cb142-360"><a href="#cb142-360" aria-hidden="true" tabindex="-1"></a><span class="in">                                 "Other" = "D. Other"))</span></span>
<span id="cb142-361"><a href="#cb142-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-362"><a href="#cb142-362" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; count(medium, medium_r) # sanity check</span></span>
<span id="cb142-363"><a href="#cb142-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-364"><a href="#cb142-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-365"><a href="#cb142-365" aria-hidden="true" tabindex="-1"></a>OK. Looks good now.</span>
<span id="cb142-366"><a href="#cb142-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-367"><a href="#cb142-367" aria-hidden="true" tabindex="-1"></a><span class="fu">### The `fiction` variable</span></span>
<span id="cb142-368"><a href="#cb142-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-371"><a href="#cb142-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-372"><a href="#cb142-372" aria-hidden="true" tabindex="-1"></a>sur15_m <span class="sc">|&gt;</span></span>
<span id="cb142-373"><a href="#cb142-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tabyl</span>(fiction)</span>
<span id="cb142-374"><a href="#cb142-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-375"><a href="#cb142-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-376"><a href="#cb142-376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>No signs of missing values, so that's good.</span>
<span id="cb142-377"><a href="#cb142-377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With only one value in category D and only 5 in category C, we will need to do some collapsing to use this variable later.</span>
<span id="cb142-378"><a href="#cb142-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-379"><a href="#cb142-379" aria-hidden="true" tabindex="-1"></a><span class="fu">### Collapsing and recoding levels of `fiction`</span></span>
<span id="cb142-380"><a href="#cb142-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-381"><a href="#cb142-381" aria-hidden="true" tabindex="-1"></a>For the <span class="in">`fiction`</span> variable, we want to form a four category variable (with levels Comedy, Drama, Fantasy/SF, Other) called <span class="in">`fiction_r`</span>.</span>
<span id="cb142-382"><a href="#cb142-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-383"><a href="#cb142-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r collapsing_fiction_factor}</span></span>
<span id="cb142-384"><a href="#cb142-384" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-385"><a href="#cb142-385" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(fiction_r = fct_recode(factor(fiction), </span></span>
<span id="cb142-386"><a href="#cb142-386" aria-hidden="true" tabindex="-1"></a><span class="in">                                 "Comedy" = "A. Comedy",</span></span>
<span id="cb142-387"><a href="#cb142-387" aria-hidden="true" tabindex="-1"></a><span class="in">                               "Drama" = "B. Drama",</span></span>
<span id="cb142-388"><a href="#cb142-388" aria-hidden="true" tabindex="-1"></a><span class="in">                               "Fantasy/SF" = "E. Fantasy / Science Fiction",</span></span>
<span id="cb142-389"><a href="#cb142-389" aria-hidden="true" tabindex="-1"></a><span class="in">                               "Other" = "C. Action",</span></span>
<span id="cb142-390"><a href="#cb142-390" aria-hidden="true" tabindex="-1"></a><span class="in">                               "Other" = "D. Horror / Thriller"))</span></span>
<span id="cb142-391"><a href="#cb142-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-392"><a href="#cb142-392" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt; count(fiction, fiction_r) # sanity check</span></span>
<span id="cb142-393"><a href="#cb142-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-394"><a href="#cb142-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-395"><a href="#cb142-395" aria-hidden="true" tabindex="-1"></a>Actually, I'd like to reorder <span class="in">`fiction_r`</span> to put Other last.</span>
<span id="cb142-396"><a href="#cb142-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-397"><a href="#cb142-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r reorder_fiction4c_Other_last}</span></span>
<span id="cb142-398"><a href="#cb142-398" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m &lt;- sur15_m |&gt;</span></span>
<span id="cb142-399"><a href="#cb142-399" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(fiction_r = fct_relevel(fiction_r, </span></span>
<span id="cb142-400"><a href="#cb142-400" aria-hidden="true" tabindex="-1"></a><span class="in">                                   "Comedy", "Drama",</span></span>
<span id="cb142-401"><a href="#cb142-401" aria-hidden="true" tabindex="-1"></a><span class="in">                                   "Fantasy/SF", "Other"))</span></span>
<span id="cb142-402"><a href="#cb142-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-403"><a href="#cb142-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-404"><a href="#cb142-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-405"><a href="#cb142-405" aria-hidden="true" tabindex="-1"></a>OK. Let's see what we have now...</span>
<span id="cb142-406"><a href="#cb142-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-407"><a href="#cb142-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r revised_values_medium_fiction}</span></span>
<span id="cb142-408"><a href="#cb142-408" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_m |&gt;</span></span>
<span id="cb142-409"><a href="#cb142-409" aria-hidden="true" tabindex="-1"></a><span class="in">    tabyl(medium_r, fiction_r) |&gt;</span></span>
<span id="cb142-410"><a href="#cb142-410" aria-hidden="true" tabindex="-1"></a><span class="in">    kable()</span></span>
<span id="cb142-411"><a href="#cb142-411" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-412"><a href="#cb142-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-413"><a href="#cb142-413" aria-hidden="true" tabindex="-1"></a>OK. I wish we didn't have that zero cell in the cross-tabulation, but we'll leave it alone, rather than collapsing further, given our small number of observations in this demonstration.</span>
<span id="cb142-414"><a href="#cb142-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-415"><a href="#cb142-415" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating our Analytic Tibble</span></span>
<span id="cb142-416"><a href="#cb142-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-417"><a href="#cb142-417" aria-hidden="true" tabindex="-1"></a>So our analytic tibble, which I'll call <span class="in">`sur15`</span> should contains only the twelve variables that appear in our code book.</span>
<span id="cb142-418"><a href="#cb142-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-419"><a href="#cb142-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create_sur15}</span></span>
<span id="cb142-420"><a href="#cb142-420" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 &lt;- sur15_m |&gt;</span></span>
<span id="cb142-421"><a href="#cb142-421" aria-hidden="true" tabindex="-1"></a><span class="in">    select(s_id, r_pre, r_now, comfort_431, </span></span>
<span id="cb142-422"><a href="#cb142-422" aria-hidden="true" tabindex="-1"></a><span class="in">           height_r, weight_r, bmi, </span></span>
<span id="cb142-423"><a href="#cb142-423" aria-hidden="true" tabindex="-1"></a><span class="in">           r_before, english,</span></span>
<span id="cb142-424"><a href="#cb142-424" aria-hidden="true" tabindex="-1"></a><span class="in">           grades_r, medium_r, fiction_r)</span></span>
<span id="cb142-425"><a href="#cb142-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-426"><a href="#cb142-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-427"><a href="#cb142-427" aria-hidden="true" tabindex="-1"></a><span class="fu">## List of Missing Values</span></span>
<span id="cb142-428"><a href="#cb142-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-429"><a href="#cb142-429" aria-hidden="true" tabindex="-1"></a>We can count the number of missing observations in each variable, with ...</span>
<span id="cb142-430"><a href="#cb142-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-431"><a href="#cb142-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r na_pattern_in_sur15}</span></span>
<span id="cb142-432"><a href="#cb142-432" aria-hidden="true" tabindex="-1"></a><span class="in">miss_var_summary(sur15)</span></span>
<span id="cb142-433"><a href="#cb142-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-434"><a href="#cb142-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-435"><a href="#cb142-435" aria-hidden="true" tabindex="-1"></a>We can see the subjects who have missing values in several ways, including...</span>
<span id="cb142-436"><a href="#cb142-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-439"><a href="#cb142-439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-440"><a href="#cb142-440" aria-hidden="true" tabindex="-1"></a><span class="fu">miss_case_summary</span>(sur15)</span>
<span id="cb142-441"><a href="#cb142-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-442"><a href="#cb142-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-445"><a href="#cb142-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-446"><a href="#cb142-446" aria-hidden="true" tabindex="-1"></a>sur15[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">complete.cases</span>(sur15)),]</span>
<span id="cb142-447"><a href="#cb142-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-448"><a href="#cb142-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-449"><a href="#cb142-449" aria-hidden="true" tabindex="-1"></a>In our sample of respondents, we have:</span>
<span id="cb142-450"><a href="#cb142-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-451"><a href="#cb142-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>49 subjects with no missing values, </span>
<span id="cb142-452"><a href="#cb142-452" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1 subject (<span class="in">`s_id`</span> = 516) who is missing <span class="in">`grades_r`</span>, </span>
<span id="cb142-453"><a href="#cb142-453" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2 subjects (<span class="in">`s_id`</span> = 504 and 529) who are missing <span class="in">`height_r`</span> and <span class="in">`bmi`</span>, and </span>
<span id="cb142-454"><a href="#cb142-454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1 subject (<span class="in">`s_id`</span> = 550) who is missing <span class="in">`weight_r`</span> and <span class="in">`bmi`</span>. </span>
<span id="cb142-455"><a href="#cb142-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-456"><a href="#cb142-456" aria-hidden="true" tabindex="-1"></a>So we'll have to keep that missingness in mind when we do work with <span class="in">`bmi`</span> or <span class="in">`grades_r`</span> in the analyses that follow.</span>
<span id="cb142-457"><a href="#cb142-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-458"><a href="#cb142-458" aria-hidden="true" tabindex="-1"></a><span class="fu"># Codebook and Data Description</span></span>
<span id="cb142-459"><a href="#cb142-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-460"><a href="#cb142-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variable Descriptions</span></span>
<span id="cb142-461"><a href="#cb142-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-462"><a href="#cb142-462" aria-hidden="true" tabindex="-1"></a>The 12 variables in our tidy data set <span class="in">`sur15`</span> for this demonstration are as follows. The Type column indicates the number of levels in each categorical (factor) variable. Recall that we have missing data in <span class="in">`height_r`</span>, <span class="in">`weight_r`</span>, <span class="in">`bmi`</span> and <span class="in">`grades_r`</span> and I've indicated this in the codebook table below. As for the Type information, I'm using Quant to indicate quantitative variables, and Cat-x indicates a categorical variable (factor) with x levels.</span>
<span id="cb142-463"><a href="#cb142-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-464"><a href="#cb142-464" aria-hidden="true" tabindex="-1"></a>Variable      | Type  | Description / Levels</span>
<span id="cb142-465"><a href="#cb142-465" aria-hidden="true" tabindex="-1"></a>--------- | :---: | --------------------------------------------</span>
<span id="cb142-466"><a href="#cb142-466" aria-hidden="true" tabindex="-1"></a><span class="in">`s_id`</span>        | ID    | subject code (501-533)</span>
<span id="cb142-467"><a href="#cb142-467" aria-hidden="true" tabindex="-1"></a><span class="in">`r_pre`</span>       | Quant | 0 (SD) - 100 (SA) with Prior to taking 431, I was totally confident and comfortable with using R.</span>
<span id="cb142-468"><a href="#cb142-468" aria-hidden="true" tabindex="-1"></a><span class="in">`r_now`</span>       | Quant | 0 (SD) - 100 (SA) with Right now, I am totally confident and comfortable with using R.</span>
<span id="cb142-469"><a href="#cb142-469" aria-hidden="true" tabindex="-1"></a><span class="in">`comfort_431`</span> | Quant | 0 (SD) - 100 (SA) with I am very comfortable with my understanding of the material discussed so far in 431.</span>
<span id="cb142-470"><a href="#cb142-470" aria-hidden="true" tabindex="-1"></a><span class="in">`height_r`</span>    | Quant | What is your height, in inches <span class="co">[</span><span class="ot">**2 NA**</span><span class="co">]</span></span>
<span id="cb142-471"><a href="#cb142-471" aria-hidden="true" tabindex="-1"></a><span class="in">`weight_r`</span>    | Quant | What is your weight, in pounds <span class="co">[</span><span class="ot">**1 NA**</span><span class="co">]</span></span>
<span id="cb142-472"><a href="#cb142-472" aria-hidden="true" tabindex="-1"></a><span class="in">`bmi`</span>         | Quant | 703 x <span class="in">`weight`</span>/(<span class="in">`height`</span> squared) <span class="co">[</span><span class="ot">**3 NA**</span><span class="co">]</span></span>
<span id="cb142-473"><a href="#cb142-473" aria-hidden="true" tabindex="-1"></a><span class="in">`r_before`</span>     | Cat-2 | yes, no: Before taking 431, had you ever used R before?</span>
<span id="cb142-474"><a href="#cb142-474" aria-hidden="true" tabindex="-1"></a><span class="in">`english`</span>     | Cat-2 | yes, no: Is English the language you speak better than any other?</span>
<span id="cb142-475"><a href="#cb142-475" aria-hidden="true" tabindex="-1"></a><span class="in">`grades_r`</span>  | Cat-3 | Individual, Partner, Group: In your graduate and undergraduate educational experience, which of the following types of assignments have you received the HIGHEST grades for? <span class="co">[</span><span class="ot">**1 NA**</span><span class="co">]</span></span>
<span id="cb142-476"><a href="#cb142-476" aria-hidden="true" tabindex="-1"></a><span class="in">`medium_r`</span>   | Cat-3 | Movies, TV, Other: Which medium do you use most to get your fictional stories (containing plot)?</span>
<span id="cb142-477"><a href="#cb142-477" aria-hidden="true" tabindex="-1"></a><span class="in">`fiction_r`</span>  | Cat-4 | Comedy, Drama, Fantasy/SF, Other: Which type of fictional stories do you consume most?</span>
<span id="cb142-478"><a href="#cb142-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-479"><a href="#cb142-479" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analytic Tibble</span></span>
<span id="cb142-480"><a href="#cb142-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-481"><a href="#cb142-481" aria-hidden="true" tabindex="-1"></a>Now, I'll prove that <span class="in">`sur15`</span> is a tibble by printing it.</span>
<span id="cb142-482"><a href="#cb142-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-485"><a href="#cb142-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-486"><a href="#cb142-486" aria-hidden="true" tabindex="-1"></a>sur15</span>
<span id="cb142-487"><a href="#cb142-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-488"><a href="#cb142-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-489"><a href="#cb142-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Summary</span></span>
<span id="cb142-490"><a href="#cb142-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-491"><a href="#cb142-491" aria-hidden="true" tabindex="-1"></a><span class="fu">### `data_description()`</span></span>
<span id="cb142-492"><a href="#cb142-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-493"><a href="#cb142-493" aria-hidden="true" tabindex="-1"></a>Here's a <span class="in">`data_description()`</span> result to show some information about the distribution of each quantitative variables in the <span class="in">`sur15`</span> tibble.</span>
<span id="cb142-494"><a href="#cb142-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-497"><a href="#cb142-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-498"><a href="#cb142-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb142-499"><a href="#cb142-499" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_distribution</span>(sur15 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>s_id))</span>
<span id="cb142-500"><a href="#cb142-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-501"><a href="#cb142-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-502"><a href="#cb142-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### `data_codebook()`</span></span>
<span id="cb142-503"><a href="#cb142-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-504"><a href="#cb142-504" aria-hidden="true" tabindex="-1"></a>And here's the <span class="in">`data_codebook()`</span> result, which adds in tabulations of the categorical variables.</span>
<span id="cb142-505"><a href="#cb142-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-508"><a href="#cb142-508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-509"><a href="#cb142-509" aria-hidden="true" tabindex="-1"></a><span class="fu">data_codebook</span>(sur15 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>s_id))</span>
<span id="cb142-510"><a href="#cb142-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-511"><a href="#cb142-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-512"><a href="#cb142-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-513"><a href="#cb142-513" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis A: Compare 2 Population Means using Paired Samples</span></span>
<span id="cb142-514"><a href="#cb142-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-515"><a href="#cb142-515" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Question</span></span>
<span id="cb142-516"><a href="#cb142-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-517"><a href="#cb142-517" aria-hidden="true" tabindex="-1"></a>We'll compare the <span class="in">`r_now`</span> scores to <span class="in">`r_pre`</span> scores. The scores are paired by subject, as each subject gives us both a <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> score, and computing and assessing within-subject differences in comfort with R makes sense, because we are interested in the change in each person's comfort level. We'll generally use <span class="in">`r_now - r_pre`</span> in our calculations, so that positive numbers indicate improvements in confidence. **Note that we'll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project B Study 1 work, as well.**</span>
<span id="cb142-518"><a href="#cb142-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-519"><a href="#cb142-519" aria-hidden="true" tabindex="-1"></a>So, our research question might be something like:</span>
<span id="cb142-520"><a href="#cb142-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-521"><a href="#cb142-521" aria-hidden="true" tabindex="-1"></a>What is a typical change in comfort with R experienced by students in 431 through the first couple of months in the course?</span>
<span id="cb142-522"><a href="#cb142-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-523"><a href="#cb142-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing the Data</span></span>
<span id="cb142-524"><a href="#cb142-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-525"><a href="#cb142-525" aria-hidden="true" tabindex="-1"></a><span class="fu">### Compute and summarize the paired differences</span></span>
<span id="cb142-526"><a href="#cb142-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-527"><a href="#cb142-527" aria-hidden="true" tabindex="-1"></a>The natural first step is to compute paired differences between the <span class="in">`r_now`</span> and <span class="in">`r_pre`</span> samples, and then use graphical and numerical summaries to assess whether the sample (of differences) can be assumed to follow a Normal distribution. First, we'll calculate the paired differences.</span>
<span id="cb142-528"><a href="#cb142-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-529"><a href="#cb142-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r compute_paired_differences}</span></span>
<span id="cb142-530"><a href="#cb142-530" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 &lt;- sur15 |&gt;</span></span>
<span id="cb142-531"><a href="#cb142-531" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(r_diff = r_now - r_pre)</span></span>
<span id="cb142-532"><a href="#cb142-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-533"><a href="#cb142-533" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt; reframe(lovedist(r_diff))</span></span>
<span id="cb142-534"><a href="#cb142-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-535"><a href="#cb142-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-536"><a href="#cb142-536" aria-hidden="true" tabindex="-1"></a>OK. It appears that we have successfully subtracted the PRE data from the NOW data, and everyone has a difference of at least zero. But we have a lot of people (8) who have a value of 0. Now, we'll assess whether or not a Normal distribution might be a reasonable model for the data.</span>
<span id="cb142-537"><a href="#cb142-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-538"><a href="#cb142-538" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graphical Summaries to Assess Normality</span></span>
<span id="cb142-539"><a href="#cb142-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-540"><a href="#cb142-540" aria-hidden="true" tabindex="-1"></a>We should start by looking at the distribution of these 53 values of <span class="in">`r_diff`</span>.  As we've seen, there's a floor effect at zero.</span>
<span id="cb142-541"><a href="#cb142-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-542"><a href="#cb142-542" aria-hidden="true" tabindex="-1"></a>A histogram with 53 values won't give us a lot of information. Perhaps we should focus instead on a Normal Q-Q plot and boxplot with violin? We'll draw all three here.</span>
<span id="cb142-543"><a href="#cb142-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-546"><a href="#cb142-546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-547"><a href="#cb142-547" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">x =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb142-548"><a href="#cb142-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"slateblue"</span>, <span class="at">col =</span> <span class="st">"white"</span>, </span>
<span id="cb142-549"><a href="#cb142-549" aria-hidden="true" tabindex="-1"></a>                   <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb142-550"><a href="#cb142-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"R Comfort Rating Difference"</span>) </span>
<span id="cb142-551"><a href="#cb142-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-552"><a href="#cb142-552" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">sample =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb142-553"><a href="#cb142-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_qq</span>(<span class="at">col =</span> <span class="st">"slateblue"</span>) <span class="sc">+</span> <span class="fu">geom_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb142-554"><a href="#cb142-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Rating Difference"</span>) </span>
<span id="cb142-555"><a href="#cb142-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-556"><a href="#cb142-556" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sur15, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"n = 53"</span>, <span class="at">y =</span> r_diff)) <span class="sc">+</span></span>
<span id="cb142-557"><a href="#cb142-557" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb142-558"><a href="#cb142-558" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"slateblue"</span>, <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb142-559"><a href="#cb142-559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Current - PreClass Difference in R Comfort Rating"</span>,</span>
<span id="cb142-560"><a href="#cb142-560" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb142-561"><a href="#cb142-561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span>
<span id="cb142-562"><a href="#cb142-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-563"><a href="#cb142-563" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">-</span> p3 <span class="sc">+</span></span>
<span id="cb142-564"><a href="#cb142-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">height =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb142-565"><a href="#cb142-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">"Most Students Improved R Comfort Ratings during 431"</span>)</span>
<span id="cb142-566"><a href="#cb142-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-567"><a href="#cb142-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-568"><a href="#cb142-568" aria-hidden="true" tabindex="-1"></a>With just 53 observations, it will be a little difficult to get a clear picture of whether a Normal approximation is reasonable or not. I would conclude that a bootstrap approach would be a better choice here than a Normal model for the paired differences, owing to the floor effect (many zeros) in the paired differences. The data are a bit skewed, although they don't quite sneak over the 0.2 cutoff for skew~1~.</span>
<span id="cb142-569"><a href="#cb142-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-570"><a href="#cb142-570" aria-hidden="true" tabindex="-1"></a><span class="fu">### Did Pairing Help Reduce Nuisance Variation?</span></span>
<span id="cb142-571"><a href="#cb142-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-572"><a href="#cb142-572" aria-hidden="true" tabindex="-1"></a>We would expect a strong correlation between the <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> scores in this repeated measures analysis where each subject is assessing both their confidence before the class and then again during the class. To assess whether pairing helped reduce nuisance variation, I'll build a scatterplot of the <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> scores, supplemented by a Pearson correlation coefficient. Since we have so many ties in the data, with two or more points in the same place, I'll use <span class="in">`geom_jitter`</span> rather than <span class="in">`geom_point`</span> to plot the points. The larger the correlation, the more that pairing will help reduce the impact of differences between subjects on the <span class="in">`r_pre`</span> score on the comparison we're trying to make. </span>
<span id="cb142-573"><a href="#cb142-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-574"><a href="#cb142-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r scatterplot_for_paired_diffs}</span></span>
<span id="cb142-575"><a href="#cb142-575" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sur15, aes(x = r_pre, y = r_now)) +</span></span>
<span id="cb142-576"><a href="#cb142-576" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_jitter(col = "slateblue") +</span></span>
<span id="cb142-577"><a href="#cb142-577" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_smooth(formula = y ~ x, method = "lm", col = "red") +</span></span>
<span id="cb142-578"><a href="#cb142-578" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = "Jittered Scatterplot shows moderately strong relationship",</span></span>
<span id="cb142-579"><a href="#cb142-579" aria-hidden="true" tabindex="-1"></a><span class="in">         subtitle = "especially for those starting above 0")</span></span>
<span id="cb142-580"><a href="#cb142-580" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-581"><a href="#cb142-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-582"><a href="#cb142-582" aria-hidden="true" tabindex="-1"></a>For people with a <span class="in">`r_pre`</span> score greater than zero, we see a pretty strong linear relationship between <span class="in">`r_pre`</span> and <span class="in">`r_now`</span>.</span>
<span id="cb142-583"><a href="#cb142-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-584"><a href="#cb142-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r correlation_paired_diffs}</span></span>
<span id="cb142-585"><a href="#cb142-585" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt; select(r_pre, r_now) |&gt; cor() |&gt; </span></span>
<span id="cb142-586"><a href="#cb142-586" aria-hidden="true" tabindex="-1"></a><span class="in">    round_half_up(digits = 3) |&gt; kable()</span></span>
<span id="cb142-587"><a href="#cb142-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-588"><a href="#cb142-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-589"><a href="#cb142-589" aria-hidden="true" tabindex="-1"></a>The Pearson correlation is quite strong at <span class="in">`r round_half_up(cor(sur15$r_pre, sur15$r_now), 3)`</span> so that a linear model using the <span class="in">`r_pre`</span> score accounts for a reasonably large fraction (<span class="in">`r round_half_up(100*(cor(sur15$r_pre, sur15$r_now)^2),1)`</span>%) of the variation in <span class="in">`r_now`</span> scores.</span>
<span id="cb142-590"><a href="#cb142-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-591"><a href="#cb142-591" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the Pearson correlation had been small but still positive (perhaps less than 0.2), we might conclude that pairing wouldn't be exceptionally helpful, but if the samples are meant to be paired, we should still do a paired samples analysis, but such a small correlation would imply that an independent samples comparison would come to about the same conclusion.</span>
<span id="cb142-592"><a href="#cb142-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-593"><a href="#cb142-593" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Analysis</span></span>
<span id="cb142-594"><a href="#cb142-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-595"><a href="#cb142-595" aria-hidden="true" tabindex="-1"></a>As you'll recall, we have two main methods for building confidence intervals in a paired samples analysis:</span>
<span id="cb142-596"><a href="#cb142-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-597"><a href="#cb142-597" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Paired t test</span>
<span id="cb142-598"><a href="#cb142-598" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Bootstrap, using <span class="in">`smean.cl.boot`</span></span>
<span id="cb142-599"><a href="#cb142-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-600"><a href="#cb142-600" aria-hidden="true" tabindex="-1"></a>Let's run each in this demonstration just so you have the code, even though, as mentioned, I'd be most interested in what the bootstrap approach suggests, owing to the modest non-Normality we see in the sample of differences. I'll even throw in a Wilcoxon signed rank test approach here, even though I wouldn't recommend you include that in Project B. In each case, we'll build a 90% confidence interval for the population mean (or pseudo-median, in the case of the signed rank test) of the <span class="in">`r_now - r_pre`</span> differences. </span>
<span id="cb142-601"><a href="#cb142-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-602"><a href="#cb142-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Paired t test approach</span></span>
<span id="cb142-603"><a href="#cb142-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-604"><a href="#cb142-604" aria-hidden="true" tabindex="-1"></a>Here is a 90% confidence interval for the population mean of the paired <span class="in">`r_now - r_pre`</span> differences.</span>
<span id="cb142-605"><a href="#cb142-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-606"><a href="#cb142-606" aria-hidden="true" tabindex="-1"></a><span class="in">```{r paired_t_test}</span></span>
<span id="cb142-607"><a href="#cb142-607" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(sur15$r_diff, conf.level = .90) |&gt; </span></span>
<span id="cb142-608"><a href="#cb142-608" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy() |&gt;</span></span>
<span id="cb142-609"><a href="#cb142-609" aria-hidden="true" tabindex="-1"></a><span class="in">  select(estimate, conf.low, conf.high)</span></span>
<span id="cb142-610"><a href="#cb142-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-611"><a href="#cb142-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-612"><a href="#cb142-612" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The point estimate for the population mean of the differences is 35.45, indicating that the average subject rated agreement with the statement about confidence in R 35 points higher now than when they started the class.</span>
<span id="cb142-613"><a href="#cb142-613" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the population mean of the differences is (28.9, 42.1)</span>
<span id="cb142-614"><a href="#cb142-614" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure\footnote{In this case, a one-sided test might also have been a good choice, since we don't anticipate people will actually admit to being less confident about R after taking the course.}. We conclude from the confidence interval (which does not contain zero) that there is some evidence of a difference between the <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> scores.</span>
<span id="cb142-615"><a href="#cb142-615" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of the paired t procedure are </span>
<span id="cb142-616"><a href="#cb142-616" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences are independent of each other, </span>
<span id="cb142-617"><a href="#cb142-617" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences represent a random sample of the population of possible matched differences, </span>
<span id="cb142-618"><a href="#cb142-618" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>and that the matched differences are drawn from a Normally distributed population. - The last of these assumptions is hard to justify given these data.</span>
<span id="cb142-619"><a href="#cb142-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-620"><a href="#cb142-620" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Wilcoxon signed rank test approach</span></span>
<span id="cb142-621"><a href="#cb142-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-622"><a href="#cb142-622" aria-hidden="true" tabindex="-1"></a>Here is a 90% confidence interval for the population pseudo-median of the paired <span class="in">`r_now - r_pre`</span> differences, as estimated by the Wilcoxon signed rank approach.</span>
<span id="cb142-623"><a href="#cb142-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-624"><a href="#cb142-624" aria-hidden="true" tabindex="-1"></a><span class="in">```{r signed_rank_test_and_CI}</span></span>
<span id="cb142-625"><a href="#cb142-625" aria-hidden="true" tabindex="-1"></a><span class="in">wilcox.test(sur15$r_diff, conf.level = .90, conf.int = TRUE, exact = FALSE) |&gt;</span></span>
<span id="cb142-626"><a href="#cb142-626" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy() |&gt;</span></span>
<span id="cb142-627"><a href="#cb142-627" aria-hidden="true" tabindex="-1"></a><span class="in">  select(estimate, conf.low, conf.high)</span></span>
<span id="cb142-628"><a href="#cb142-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-629"><a href="#cb142-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-630"><a href="#cb142-630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The point estimate for the population pseudo-median of the differences is 40, indicating that the average subject rated agreement with the statement about confidence in R 40 points higher now than when they started the class. Note that this is meaningfully different from the sample median difference, which was 30, and that's because there was some skew in the sample data. The interpretation of the Wilcoxon approach is easiest for data that are light-tailed or heavy-tailed, but still generally symmetric.</span>
<span id="cb142-631"><a href="#cb142-631" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the population pseudo-median of the differences is (35, 47.5)</span>
<span id="cb142-632"><a href="#cb142-632" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval and testing procedure. We conclude from the confidence interval (which does not contain zero) that there is some evidence of a meaningful difference between <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> scores.</span>
<span id="cb142-633"><a href="#cb142-633" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of the Wilcoxon signed rank procedure are </span>
<span id="cb142-634"><a href="#cb142-634" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences are independent of each other, </span>
<span id="cb142-635"><a href="#cb142-635" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences represent a random sample of the population of possible matched differences, </span>
<span id="cb142-636"><a href="#cb142-636" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>and that the matched differences are drawn from a population that is symmetric, but potentially light-tailed, or even outlier-prone </span>
<span id="cb142-637"><a href="#cb142-637" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>The last of these assumptions is hard to justify given these data.</span>
<span id="cb142-638"><a href="#cb142-638" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb142-639"><a href="#cb142-639" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bootstrap approach for the mean from paired samples</span></span>
<span id="cb142-640"><a href="#cb142-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-641"><a href="#cb142-641" aria-hidden="true" tabindex="-1"></a>Here is a 90% confidence interval for the population mean of the paired <span class="in">`r_now - r_pre`</span> differences, as estimated by a bootstrap approach using a random seed of <span class="in">`431`</span>. (*Note*: when you set a seed for this or other analyses in the project, pick something other than <span class="in">`431`</span>.)</span>
<span id="cb142-642"><a href="#cb142-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-643"><a href="#cb142-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bootstrap_for_paired_samples}</span></span>
<span id="cb142-644"><a href="#cb142-644" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(431)</span></span>
<span id="cb142-645"><a href="#cb142-645" aria-hidden="true" tabindex="-1"></a><span class="in">smean.cl.boot(sur15$r_diff, conf.int = 0.90)</span></span>
<span id="cb142-646"><a href="#cb142-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-647"><a href="#cb142-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-648"><a href="#cb142-648" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The point estimate for the population mean of the differences is 35.45, indicating that the average subject rated agreement with the statement about confidence in R 35 points higher now than when they started the class.</span>
<span id="cb142-649"><a href="#cb142-649" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the population mean of the differences is fairly close to what we got from the paired t test, as it turns out.</span>
<span id="cb142-650"><a href="#cb142-650" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure, and so we can discuss a range of reasonable estimates for the true difference in <span class="in">`r_pre`</span> and <span class="in">`r_now`</span> scores.</span>
<span id="cb142-651"><a href="#cb142-651" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of this bootstrap procedure are </span>
<span id="cb142-652"><a href="#cb142-652" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences are independent of each other, and</span>
<span id="cb142-653"><a href="#cb142-653" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the matched differences represent a random sample of the population of possible matched differences, </span>
<span id="cb142-654"><a href="#cb142-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-655"><a href="#cb142-655" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb142-656"><a href="#cb142-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-657"><a href="#cb142-657" aria-hidden="true" tabindex="-1"></a>Subjects appear to improve in their comfort with R an average of 35.45 points on the 0-100 scale, with a 90% confidence interval for that average improvement of (28.9, 42.1) points. This conclusion is motivated by a bootstrap estimate to compare paired responses from students before and after the first couple of months of the course, and I feel this is the most justified approach based on my assessment of Normality in the data from these 53 students. </span>
<span id="cb142-658"><a href="#cb142-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-659"><a href="#cb142-659" aria-hidden="true" tabindex="-1"></a>A natural next step would be to look at values of something like this over multiple years, or perhaps comparing students at more than just two stages. It would also be appealing to measure comfort with R at the earlier time, and then return to the students later, rather than asking them to remember where they were at the start a couple of months later. There are several other possible next steps here, too, depending on what population you might decide to target.</span>
<span id="cb142-660"><a href="#cb142-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-661"><a href="#cb142-661" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis B: Compare 2 Population Means using Independent Samples</span></span>
<span id="cb142-662"><a href="#cb142-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-663"><a href="#cb142-663" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Question</span></span>
<span id="cb142-664"><a href="#cb142-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-665"><a href="#cb142-665" aria-hidden="true" tabindex="-1"></a>We'll compare <span class="in">`bmi`</span> by <span class="in">`english`</span> in this analysis using independent samples. We're comparing the mean <span class="in">`bmi`</span> of the population represented by respondents who speak English best to the mean <span class="in">`bmi`</span> of the population represented by the respondents who speak some other language better. There is nothing to suggest that the two samples (English <span class="in">`bmi`</span> and non-English <span class="in">`bmi`</span> values) are paired or matched in any way. Plus, as we'll see, there are different numbers of English and non-English preferring subjects, so there's no way their <span class="in">`bmi`</span> values could be paired. As a result, we're going to be interested in looking at the two samples separately to help us understand issues related to hypothesis testing assumptions. **Note that we'll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project Study B work, as well.**</span>
<span id="cb142-666"><a href="#cb142-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-667"><a href="#cb142-667" aria-hidden="true" tabindex="-1"></a>Our research question is:</span>
<span id="cb142-668"><a href="#cb142-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-669"><a href="#cb142-669" aria-hidden="true" tabindex="-1"></a>Did students who speak English best have meaningfully different average body mass index values than students who speak some other language better than they speak English?</span>
<span id="cb142-670"><a href="#cb142-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-671"><a href="#cb142-671" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing the Data</span></span>
<span id="cb142-672"><a href="#cb142-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-673"><a href="#cb142-673" aria-hidden="true" tabindex="-1"></a>I'll start by looking at the range of the <span class="in">`bmi`</span> data within each language group</span>
<span id="cb142-674"><a href="#cb142-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-675"><a href="#cb142-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bmi_by_english}</span></span>
<span id="cb142-676"><a href="#cb142-676" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt; group_by(english) |&gt; </span></span>
<span id="cb142-677"><a href="#cb142-677" aria-hidden="true" tabindex="-1"></a><span class="in">  reframe(lovedist(bmi))</span></span>
<span id="cb142-678"><a href="#cb142-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-679"><a href="#cb142-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-680"><a href="#cb142-680" aria-hidden="true" tabindex="-1"></a>As we have previously seen, we have three missing BMI values. We could either impute these values, or remove those cases for this analysis. In this case, I'll assume missingness completely at random, and simply remove the three missing values.</span>
<span id="cb142-681"><a href="#cb142-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-682"><a href="#cb142-682" aria-hidden="true" tabindex="-1"></a>So for this analysis, I'll create a new data set called <span class="in">`sur15_B`</span> that contains only the variables I will use in Analysis B, and only the cases where <span class="in">`bmi`</span> is available.</span>
<span id="cb142-683"><a href="#cb142-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-684"><a href="#cb142-684" aria-hidden="true" tabindex="-1"></a><span class="fu">### A New Data Set including only those with `bmi` data</span></span>
<span id="cb142-685"><a href="#cb142-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-686"><a href="#cb142-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r drop_missing_bmi}</span></span>
<span id="cb142-687"><a href="#cb142-687" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_B &lt;- sur15 |&gt;</span></span>
<span id="cb142-688"><a href="#cb142-688" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(complete.cases(bmi)) |&gt;</span></span>
<span id="cb142-689"><a href="#cb142-689" aria-hidden="true" tabindex="-1"></a><span class="in">  select(s_id, english, bmi)</span></span>
<span id="cb142-690"><a href="#cb142-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-691"><a href="#cb142-691" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt; group_by(english) |&gt; </span></span>
<span id="cb142-692"><a href="#cb142-692" aria-hidden="true" tabindex="-1"></a><span class="in">  reframe(lovedist(bmi))</span></span>
<span id="cb142-693"><a href="#cb142-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-694"><a href="#cb142-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-695"><a href="#cb142-695" aria-hidden="true" tabindex="-1"></a>Next, we'll use graphical and numerical summaries to assess whether the samples (of Yes and No respondents, separately) can *each* be modeled appropriately by a Normal distribution. </span>
<span id="cb142-696"><a href="#cb142-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-697"><a href="#cb142-697" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graphical Summaries</span></span>
<span id="cb142-698"><a href="#cb142-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-699"><a href="#cb142-699" aria-hidden="true" tabindex="-1"></a>Let's build a comparison boxplot (with notches and violins) to start. This will give me a message (which I'll suppress here with <span class="in">`#| message: false`</span> in the code chunk) about the notch exceeding the third quartile in the No group.</span>
<span id="cb142-700"><a href="#cb142-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-701"><a href="#cb142-701" aria-hidden="true" tabindex="-1"></a><span class="in">```{r boxplot_for_b}</span></span>
<span id="cb142-702"><a href="#cb142-702" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb142-703"><a href="#cb142-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-704"><a href="#cb142-704" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sur15_B, aes(x = english, y = bmi, fill = english)) + </span></span>
<span id="cb142-705"><a href="#cb142-705" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(alpha = 0.3) +</span></span>
<span id="cb142-706"><a href="#cb142-706" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(width = 0.3, notch = TRUE) +</span></span>
<span id="cb142-707"><a href="#cb142-707" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb142-708"><a href="#cb142-708" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "BMI data somewhat right skewed in each group",</span></span>
<span id="cb142-709"><a href="#cb142-709" aria-hidden="true" tabindex="-1"></a><span class="in">       subtitle = "n = 50 Students in 431: Fall 2015",</span></span>
<span id="cb142-710"><a href="#cb142-710" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "Speaks English better than all other languages?", y = "Body Mass Index") </span></span>
<span id="cb142-711"><a href="#cb142-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-712"><a href="#cb142-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-713"><a href="#cb142-713" aria-hidden="true" tabindex="-1"></a>There are at least a couple of candidate outliers in each group on the high end, which suggest some potential for meaningful skew. </span>
<span id="cb142-714"><a href="#cb142-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-715"><a href="#cb142-715" aria-hidden="true" tabindex="-1"></a>We could also build a pair of Normal Q-Q plots.</span>
<span id="cb142-716"><a href="#cb142-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-717"><a href="#cb142-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r qqplots_for_b}</span></span>
<span id="cb142-718"><a href="#cb142-718" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sur15_B, aes(sample = bmi, col = english)) +</span></span>
<span id="cb142-719"><a href="#cb142-719" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_qq() + geom_qq_line() +</span></span>
<span id="cb142-720"><a href="#cb142-720" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ english, labeller = "label_both") +</span></span>
<span id="cb142-721"><a href="#cb142-721" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(col = "none") +</span></span>
<span id="cb142-722"><a href="#cb142-722" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = "Observed BMI values",</span></span>
<span id="cb142-723"><a href="#cb142-723" aria-hidden="true" tabindex="-1"></a><span class="in">       title = "BMI isn't well fit by a Normal model in either group")</span></span>
<span id="cb142-724"><a href="#cb142-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-725"><a href="#cb142-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-726"><a href="#cb142-726" aria-hidden="true" tabindex="-1"></a>There's room for concern about whether a test that requires Normal distributions in the populations is a good choice here. With these small sample sizes, we'd probably be better off not making too many strong assumptions.</span>
<span id="cb142-727"><a href="#cb142-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-728"><a href="#cb142-728" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Summaries</span></span>
<span id="cb142-729"><a href="#cb142-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-730"><a href="#cb142-730" aria-hidden="true" tabindex="-1"></a>We have 16 No and 34 Yes respondents to the English language question who have known BMI values.</span>
<span id="cb142-731"><a href="#cb142-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-732"><a href="#cb142-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r numerical_summaries_B}</span></span>
<span id="cb142-733"><a href="#cb142-733" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_B |&gt; group_by(english) |&gt; reframe(lovedist(bmi))</span></span>
<span id="cb142-734"><a href="#cb142-734" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-735"><a href="#cb142-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-736"><a href="#cb142-736" aria-hidden="true" tabindex="-1"></a>It looks like the right skew is large enough, at least in the Yes (speaks English best) group to warrant avoiding tests that require Normality. So again it looks like it's not reasonable to assume Normality here, or even symmetry.</span>
<span id="cb142-737"><a href="#cb142-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-738"><a href="#cb142-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Analysis</span></span>
<span id="cb142-739"><a href="#cb142-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-740"><a href="#cb142-740" aria-hidden="true" tabindex="-1"></a>As you'll recall, we have three main methods for building confidence intervals in an independent samples analysis:</span>
<span id="cb142-741"><a href="#cb142-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-742"><a href="#cb142-742" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Welch's t test (t test without assuming equal variances)</span>
<span id="cb142-743"><a href="#cb142-743" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Pooled t test (t test with equal variances assumed)</span>
<span id="cb142-744"><a href="#cb142-744" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Bootstrap, using <span class="in">`bootdif`</span></span>
<span id="cb142-745"><a href="#cb142-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-746"><a href="#cb142-746" aria-hidden="true" tabindex="-1"></a>Let's run each here just so you have the code, even though, as mentioned, I'd be most interested in what the bootstrap approach suggests, owing to the fact that the samples aren't well described by Normal models or even symmetric ones.  I'll even throw in a Wilcoxon Rank Sum approach here, even though I wouldn't recommend you include that in Project B.In each case, we'll build a 90% confidence interval for the population mean (or another measure of central tendency, in the case of the Rank Sum test) comparing <span class="in">`bmi`</span> for people who answered Yes and No to the question about English being the language they speak best.</span>
<span id="cb142-747"><a href="#cb142-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-748"><a href="#cb142-748" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Welch's t test approach</span></span>
<span id="cb142-749"><a href="#cb142-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-750"><a href="#cb142-750" aria-hidden="true" tabindex="-1"></a>With a somewhat unbalanced design (16 No and 34 Yes), the assumption of equal population variances will probably require us to look at the sample variances. </span>
<span id="cb142-751"><a href="#cb142-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-752"><a href="#cb142-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r variances_for_B}</span></span>
<span id="cb142-753"><a href="#cb142-753" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_B |&gt; group_by(english) |&gt;</span></span>
<span id="cb142-754"><a href="#cb142-754" aria-hidden="true" tabindex="-1"></a><span class="in">  summarise(n = n(), mean = mean(bmi), variance = var(bmi))</span></span>
<span id="cb142-755"><a href="#cb142-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-756"><a href="#cb142-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-757"><a href="#cb142-757" aria-hidden="true" tabindex="-1"></a>That's a pretty substantial difference in variance with the Yes group a good deal more than 50% larger than the No group, so we might expect the Welch t test and pooled t test to look fairly different, and that would motivate me to focus on the Welch approach over the pooled t test. Of course, neither is a great choice here, due to the samples showing some non-Normality. Regardless, here is a 90% confidence interval for the difference between the "No" group and the "Yes" group population mean <span class="in">`bmi`</span> based on Welch's test.</span>
<span id="cb142-758"><a href="#cb142-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-759"><a href="#cb142-759" aria-hidden="true" tabindex="-1"></a><span class="in">```{r Welch_t_test}</span></span>
<span id="cb142-760"><a href="#cb142-760" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(bmi ~ english, data = sur15_B, conf.level = 0.90) |&gt;</span></span>
<span id="cb142-761"><a href="#cb142-761" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy() |&gt;</span></span>
<span id="cb142-762"><a href="#cb142-762" aria-hidden="true" tabindex="-1"></a><span class="in">  select(estimate, conf.low, conf.high)</span></span>
<span id="cb142-763"><a href="#cb142-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-764"><a href="#cb142-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-765"><a href="#cb142-765" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The point estimates for the two population <span class="in">`bmi`</span> means are 23.52 for No and 24.14 for Yes, so the average student who speaks English best has a BMI estimated to be about 0.62 points higher than the average for a student who speaks another language better than English, based on our samples. </span>
<span id="cb142-766"><a href="#cb142-766" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the difference (English - non-English) of the population means is (-1.2, 2.4).</span>
<span id="cb142-767"><a href="#cb142-767" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure. We conclude from the confidence interval (which contains zero) only that the difference between the true means of the English and non-English <span class="in">`bmi`</span> levels is neither clearly positive nor negative.</span>
<span id="cb142-768"><a href="#cb142-768" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of the Welch's t test are </span>
<span id="cb142-769"><a href="#cb142-769" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group are drawn independently of each other, </span>
<span id="cb142-770"><a href="#cb142-770" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group represent a random sample of the population of interest, </span>
<span id="cb142-771"><a href="#cb142-771" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>and that the samples in each group are drawn from a Normally distributed population. </span>
<span id="cb142-772"><a href="#cb142-772" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The last of these assumptions is hard to justify given these data.</span>
<span id="cb142-773"><a href="#cb142-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-774"><a href="#cb142-774" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Pooled t test (t test with equal variances)</span></span>
<span id="cb142-775"><a href="#cb142-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-776"><a href="#cb142-776" aria-hidden="true" tabindex="-1"></a>The pooled t test, of course, actually adds an assumption (that either the sample sizes or the population variances are equal) to the assumptions of the Welch test. As mentioned above, the large difference in the sample variances and sample sizes makes this test unattractive, in addition to the problems with assuming Normality. Regardless, here is a 90% confidence interval for the difference between the non-English and English population mean <span class="in">`bmi`</span> based on the pooled t test.</span>
<span id="cb142-777"><a href="#cb142-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-778"><a href="#cb142-778" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pooled_t_test}</span></span>
<span id="cb142-779"><a href="#cb142-779" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(bmi ~ english, data = sur15_B, conf.level = .90, var.equal = TRUE) |&gt;</span></span>
<span id="cb142-780"><a href="#cb142-780" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy() |&gt;</span></span>
<span id="cb142-781"><a href="#cb142-781" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(estimate = estimate1 - estimate2) |&gt;</span></span>
<span id="cb142-782"><a href="#cb142-782" aria-hidden="true" tabindex="-1"></a><span class="in">  select(estimate, conf.low, conf.high)</span></span>
<span id="cb142-783"><a href="#cb142-783" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-784"><a href="#cb142-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-785"><a href="#cb142-785" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The point estimates for the two population <span class="in">`bmi`</span> means are still 23.52 for No and 24.14 for Yes, so the average student who speaks English best has a BMI estimated to be about 0.62 points higher than the average for a student who speaks another language better than English, based on our samples. </span>
<span id="cb142-786"><a href="#cb142-786" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the difference (English - non-English) of the population means is now (-1.5, 2.7) based on the pooled t procedure.</span>
<span id="cb142-787"><a href="#cb142-787" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure. We conclude again that there is no strong evidence to conclude a meaningful difference between the true means of the English and non-English <span class="in">`bmi`</span> levels.</span>
<span id="cb142-788"><a href="#cb142-788" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of the pooled t test are </span>
<span id="cb142-789"><a href="#cb142-789" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group are drawn independently of each other, </span>
<span id="cb142-790"><a href="#cb142-790" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group represent a random sample of the population of interest, </span>
<span id="cb142-791"><a href="#cb142-791" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>the samples in each group are drawn from a Normally distributed population, </span>
<span id="cb142-792"><a href="#cb142-792" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>*and* that either the sample sizes or the population variances are equal.</span>
<span id="cb142-793"><a href="#cb142-793" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Normality assumption remains hard to justify given these data, so we should look at alternatives.</span>
<span id="cb142-794"><a href="#cb142-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-795"><a href="#cb142-795" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Wilcoxon-Mann-Whitney rank sum test</span></span>
<span id="cb142-796"><a href="#cb142-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-797"><a href="#cb142-797" aria-hidden="true" tabindex="-1"></a>The first test we'll look that doesn't require Normality is the Wilcoxon-Mann-Whitney rank sum test. The main problem with this approach is that it doesn't estimate the difference in population means, but rather it estimates a location shift for the distribution as a whole. Here is a 90% confidence interval for the difference between the non-English and English population <span class="in">`bmi`</span> distributions based on the rank sum approach.</span>
<span id="cb142-798"><a href="#cb142-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-799"><a href="#cb142-799" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rank_sum_test}</span></span>
<span id="cb142-800"><a href="#cb142-800" aria-hidden="true" tabindex="-1"></a><span class="in">wilcox.test(bmi ~ english, data = sur15_B,</span></span>
<span id="cb142-801"><a href="#cb142-801" aria-hidden="true" tabindex="-1"></a><span class="in">            conf.level = .90, conf.int = TRUE, </span></span>
<span id="cb142-802"><a href="#cb142-802" aria-hidden="true" tabindex="-1"></a><span class="in">            exact = FALSE) |&gt;</span></span>
<span id="cb142-803"><a href="#cb142-803" aria-hidden="true" tabindex="-1"></a><span class="in">  tidy() |&gt;</span></span>
<span id="cb142-804"><a href="#cb142-804" aria-hidden="true" tabindex="-1"></a><span class="in">  select(estimate, conf.low, conf.high)</span></span>
<span id="cb142-805"><a href="#cb142-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-806"><a href="#cb142-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-807"><a href="#cb142-807" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The estimated location shift in population <span class="in">`bmi`</span> across the two language groups is 0.13.</span>
<span id="cb142-808"><a href="#cb142-808" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the location shift (English - non-English) of the populations is (-1.4, 1.9).</span>
<span id="cb142-809"><a href="#cb142-809" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure. We see potential true locations of the difference between English and non-English <span class="in">`bmi`</span> levels that include both positive and negative values.</span>
<span id="cb142-810"><a href="#cb142-810" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The assumptions of the rank sum test are </span>
<span id="cb142-811"><a href="#cb142-811" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group are drawn independently of each other, </span>
<span id="cb142-812"><a href="#cb142-812" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>*and* that the samples in each group represent a random sample of the population of interest, </span>
<span id="cb142-813"><a href="#cb142-813" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>and that the data in each population (English and non-English) are symmetric.</span>
<span id="cb142-814"><a href="#cb142-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-815"><a href="#cb142-815" aria-hidden="true" tabindex="-1"></a>That last assumption is difficult to justify.</span>
<span id="cb142-816"><a href="#cb142-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-817"><a href="#cb142-817" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bootstrap for comparing means from two independent samples</span></span>
<span id="cb142-818"><a href="#cb142-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-819"><a href="#cb142-819" aria-hidden="true" tabindex="-1"></a>The other approach we have for independent samples comparisons that doesn't require Normality is the bootstrap, and specifically, the <span class="in">`bootdif`</span> function. This approach returns to estimating the difference in population means, but gives a different answer depending on the choice of random number seed. Here is a 90% confidence interval for the difference between the English and non-English population <span class="in">`bmi`</span> distributions based on the bootstrap using a seed of <span class="in">`431`</span>. (*Note*: when you set a seed for this or other analyses in the project, pick something other than <span class="in">`431`</span>.)</span>
<span id="cb142-820"><a href="#cb142-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-821"><a href="#cb142-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{r bootdif_for_B}</span></span>
<span id="cb142-822"><a href="#cb142-822" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: false</span></span>
<span id="cb142-823"><a href="#cb142-823" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(431) </span></span>
<span id="cb142-824"><a href="#cb142-824" aria-hidden="true" tabindex="-1"></a><span class="in">bootdif(sur15_B$bmi, sur15_B$english, conf.level = 0.90)</span></span>
<span id="cb142-825"><a href="#cb142-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-826"><a href="#cb142-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-827"><a href="#cb142-827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The population mean BMI in those who said Yes is estimated to be about 0.62 points higher than the population mean BMI for those who said No, based on our samples. So the mean differences' point estimate is 0.62</span>
<span id="cb142-828"><a href="#cb142-828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our 90% confidence interval for the difference (Yes - No) of the population means is (-1.12, 2.34).</span>
<span id="cb142-829"><a href="#cb142-829" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, I've assumed a two-sided confidence interval procedure. We conclude from the confidence interval that the difference between the true means of the English and non-English <span class="in">`bmi`</span> levels could be either positive or negative, according to our analysis.</span>
<span id="cb142-830"><a href="#cb142-830" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of this bootstrap procedure are:</span>
<span id="cb142-831"><a href="#cb142-831" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each group are drawn independently of each other, </span>
<span id="cb142-832"><a href="#cb142-832" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>*and* that the samples in each group represent a random sample of the population of interest. </span>
<span id="cb142-833"><a href="#cb142-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-834"><a href="#cb142-834" aria-hidden="true" tabindex="-1"></a>So, I think the bootstrap procedure would be most appropriate here, due to the non-Normality (and in particular the asymmetry) in the samples. </span>
<span id="cb142-835"><a href="#cb142-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-836"><a href="#cb142-836" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb142-837"><a href="#cb142-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-838"><a href="#cb142-838" aria-hidden="true" tabindex="-1"></a>We find a range of possible values which crosses zero for the difference between the population mean BMI for those who speak English best and those who speak another language best, based on our sample of respondents with complete data on BMI. This conclusion is motivated by a bootstrap estimate to compare the two groups (English and non-English) with complete data on BMI. I feel this is the most justified approach based on the apparent skew in the data (particularly among those who speak English best) in these students. </span>
<span id="cb142-839"><a href="#cb142-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-840"><a href="#cb142-840" aria-hidden="true" tabindex="-1"></a>Then, if this were an actual Project B Study 1, I'd discuss the other issues that go into a conclusion, including limitations of this study and suggestions about logical next steps. But I'll be lazy and skip that for now.</span>
<span id="cb142-841"><a href="#cb142-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-842"><a href="#cb142-842" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis C: Comparing 3+ Population Means via ANOVA</span></span>
<span id="cb142-843"><a href="#cb142-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-844"><a href="#cb142-844" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Question</span></span>
<span id="cb142-845"><a href="#cb142-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-846"><a href="#cb142-846" aria-hidden="true" tabindex="-1"></a>We'll compare <span class="in">`comfort_431`</span> by <span class="in">`grades_r`</span> in this analysis, using the analysis of variance, and related tools. We're comparing the mean <span class="in">`comfort_431`</span> scores of the population represented by the respondents who got their best grades_r on individual work, to the population represented by the respondents who got their best grades_r with a partner, to the population represented by the respondents who got their best grades_r on group work. There is no link between subjects across the three <span class="in">`grades_r`</span> groups, so the samples are independent. Plus, as we'll see, there are different numbers of subjects in the three <span class="in">`grades_r`</span> groups, so there's no way their <span class="in">`comfort_431`</span> values could be matched. As a result, we're going to be interested in looking at the three samples separately to help us understand issues related to hypothesis testing assumptions. **Note that we'll use a 90% confidence level throughout this demonstration project for all analyses, and I encourage you to do this in your actual Project B Study 1 work, as well.**</span>
<span id="cb142-847"><a href="#cb142-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-848"><a href="#cb142-848" aria-hidden="true" tabindex="-1"></a>If this were an actual Study 1, rather than a demonstration, I'd build a research question here, but I won't.</span>
<span id="cb142-849"><a href="#cb142-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-850"><a href="#cb142-850" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing the Data</span></span>
<span id="cb142-851"><a href="#cb142-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-852"><a href="#cb142-852" aria-hidden="true" tabindex="-1"></a>I'll start by looking at the range of the <span class="in">`comfort_431`</span> data within each <span class="in">`grades_r`</span> group.</span>
<span id="cb142-853"><a href="#cb142-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-854"><a href="#cb142-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{r describe_comfort431_by_grades_r}</span></span>
<span id="cb142-855"><a href="#cb142-855" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt; group_by(grades_r) |&gt; reframe(lovedist(comfort_431))</span></span>
<span id="cb142-856"><a href="#cb142-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-857"><a href="#cb142-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-858"><a href="#cb142-858" aria-hidden="true" tabindex="-1"></a>We have only 6 respondents in each of the Partner and Group <span class="in">`grades_r`</span> categories, so that will make it difficult to say much about the distributions of <span class="in">`comfort_431`</span> in those populations.</span>
<span id="cb142-859"><a href="#cb142-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-860"><a href="#cb142-860" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dropping the subject with a missing `grades_r` value</span></span>
<span id="cb142-861"><a href="#cb142-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-862"><a href="#cb142-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r describe_grades_r}</span></span>
<span id="cb142-863"><a href="#cb142-863" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb142-864"><a href="#cb142-864" aria-hidden="true" tabindex="-1"></a><span class="in">describe(sur15$grades_r) |&gt; html()</span></span>
<span id="cb142-865"><a href="#cb142-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-866"><a href="#cb142-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-867"><a href="#cb142-867" aria-hidden="true" tabindex="-1"></a>As you can see, we have one subject with a missing value for the <span class="in">`grades_r`</span> variable. We'll drop that subject for the remainder of Analysis 2 (and also for Analysis 3 to come). While I'm at it, I'll also select only those variables that we might use in Analysis C. That combined effort will yield the new data frame: <span class="in">`sur15_C`</span>, which I will use for the remainder of Analysis C.</span>
<span id="cb142-868"><a href="#cb142-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-869"><a href="#cb142-869" aria-hidden="true" tabindex="-1"></a><span class="in">```{r drop_missing_grades_r_subject}</span></span>
<span id="cb142-870"><a href="#cb142-870" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_C &lt;- sur15 |&gt;</span></span>
<span id="cb142-871"><a href="#cb142-871" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(complete.cases(grades_r)) |&gt;</span></span>
<span id="cb142-872"><a href="#cb142-872" aria-hidden="true" tabindex="-1"></a><span class="in">  select(s_id, grades_r, comfort_431)</span></span>
<span id="cb142-873"><a href="#cb142-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-874"><a href="#cb142-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-875"><a href="#cb142-875" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graphical Summaries</span></span>
<span id="cb142-876"><a href="#cb142-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-877"><a href="#cb142-877" aria-hidden="true" tabindex="-1"></a>Since we are exploring the distributions of three independent samples, I'll plot each of the groups in a comparison boxplot, as a start.</span>
<span id="cb142-878"><a href="#cb142-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-879"><a href="#cb142-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r comparison_boxplot_analysis_2}</span></span>
<span id="cb142-880"><a href="#cb142-880" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sur15_C, aes(x = grades_r, y = comfort_431, fill = grades_r)) +</span></span>
<span id="cb142-881"><a href="#cb142-881" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_violin(alpha = 0.3) +</span></span>
<span id="cb142-882"><a href="#cb142-882" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(width = 0.3) +</span></span>
<span id="cb142-883"><a href="#cb142-883" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_flip() +</span></span>
<span id="cb142-884"><a href="#cb142-884" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb142-885"><a href="#cb142-885" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Comfort with 431 by Type of Assignment that produces best grades_r",</span></span>
<span id="cb142-886"><a href="#cb142-886" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Comfort with 431 Materials (0-100)",</span></span>
<span id="cb142-887"><a href="#cb142-887" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "")</span></span>
<span id="cb142-888"><a href="#cb142-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-889"><a href="#cb142-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-890"><a href="#cb142-890" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Notice that the boxplot notches would have been messy (they extend outside the levels of the boxes) in this case due to the small numbers of subjects in the Partner and Group <span class="in">`grades_r`</span> groups. </span>
<span id="cb142-891"><a href="#cb142-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-892"><a href="#cb142-892" aria-hidden="true" tabindex="-1"></a>The sample sizes are so small that histograms for those two levels of the <span class="in">`grades_r`</span> factor (Partner and Group) tell us nothing of substantial value.</span>
<span id="cb142-893"><a href="#cb142-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-894"><a href="#cb142-894" aria-hidden="true" tabindex="-1"></a><span class="in">```{r comparison_histograms_analysis_2}</span></span>
<span id="cb142-895"><a href="#cb142-895" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(sur15_C, aes(x = comfort_431)) +</span></span>
<span id="cb142-896"><a href="#cb142-896" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(aes(fill = grades_r), bins = 10, col = "white") +</span></span>
<span id="cb142-897"><a href="#cb142-897" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(~ grades_r, labeller = "label_both") +</span></span>
<span id="cb142-898"><a href="#cb142-898" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(fill = "none") +</span></span>
<span id="cb142-899"><a href="#cb142-899" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Comfort with 431 by Type of Assignment that produces best grades_r",</span></span>
<span id="cb142-900"><a href="#cb142-900" aria-hidden="true" tabindex="-1"></a><span class="in">       y = "Comfort with 431 Materials (0-100)",</span></span>
<span id="cb142-901"><a href="#cb142-901" aria-hidden="true" tabindex="-1"></a><span class="in">       x = "")</span></span>
<span id="cb142-902"><a href="#cb142-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-903"><a href="#cb142-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-904"><a href="#cb142-904" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In addition, the Individual data look as though they may be either skewed to the left a bit or at least have one potential outlier. </span>
<span id="cb142-905"><a href="#cb142-905" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With these tiny sample sizes (less than 10 observations) these plots don't really help much. All of the values in each group are within the stated response levels (0-100) but otherwise, there's not a lot to go on. ANOVA is quite robust, so we'll run it, but I expect that a Kruskal-Wallis approach may also be useful here.</span>
<span id="cb142-906"><a href="#cb142-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-907"><a href="#cb142-907" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Summaries</span></span>
<span id="cb142-908"><a href="#cb142-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-909"><a href="#cb142-909" aria-hidden="true" tabindex="-1"></a>With just six observations in the Partner and Group <span class="in">`grades_r`</span> levels, there's not much to see in numerical summaries, either. </span>
<span id="cb142-910"><a href="#cb142-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-911"><a href="#cb142-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r num_summaries_analysis2}</span></span>
<span id="cb142-912"><a href="#cb142-912" aria-hidden="true" tabindex="-1"></a><span class="in">sur15_C |&gt; group_by(grades_r) |&gt; reframe(lovedist(comfort_431))</span></span>
<span id="cb142-913"><a href="#cb142-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-914"><a href="#cb142-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-915"><a href="#cb142-915" aria-hidden="true" tabindex="-1"></a>We have 40 Individual, 6 Partner and 6 Group subjects with known comfort levels. </span>
<span id="cb142-916"><a href="#cb142-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-917"><a href="#cb142-917" aria-hidden="true" tabindex="-1"></a>The conclusion I draw from all of this is that we need to run both ANOVA and Kruskal-Wallis approaches, but that we probably can't trust either of them too much, with such small sample sizes in the non-Individual <span class="in">`grades_r`</span> levels. Anything below 10 subjects is just too small, and, practically, I'd consider collapsing the groups to <span class="in">`Individual`</span> vs. <span class="in">`All Other`</span>. But for this demonstration, I'll press on.</span>
<span id="cb142-918"><a href="#cb142-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-919"><a href="#cb142-919" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Analysis</span></span>
<span id="cb142-920"><a href="#cb142-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-921"><a href="#cb142-921" aria-hidden="true" tabindex="-1"></a>As you'll recall, we have at least two available methods for building statistical inferences when comparing more than two independent samples.</span>
<span id="cb142-922"><a href="#cb142-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-923"><a href="#cb142-923" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analysis of Variance</span>
<span id="cb142-924"><a href="#cb142-924" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The Kruskal-Wallis Test</span>
<span id="cb142-925"><a href="#cb142-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-926"><a href="#cb142-926" aria-hidden="true" tabindex="-1"></a>There is also a bootstrap approach but we'll defer discussion of that until 432.</span>
<span id="cb142-927"><a href="#cb142-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-928"><a href="#cb142-928" aria-hidden="true" tabindex="-1"></a>Let's run both methods here just so you have the code, even though we don't have large enough data samples in the <span class="in">`Partner`</span> and <span class="in">`Group`</span> levels to justify statistical inference at all. In each case, we'll build hypothesis tests, and compare the distributions of <span class="in">`comfort_431`</span> across levels of <span class="in">`grades_r`</span> using a 90% confidence level.</span>
<span id="cb142-929"><a href="#cb142-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-930"><a href="#cb142-930" aria-hidden="true" tabindex="-1"></a><span class="fu">### Kruskal-Wallis Test</span></span>
<span id="cb142-931"><a href="#cb142-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-932"><a href="#cb142-932" aria-hidden="true" tabindex="-1"></a>I'll start with the Kruskal-Wallis test, which at least doesn't require me to assume Normality in the three populations. The null hypothesis here is that there is no location shift in the distributions of comfort in 431 across the three levels of <span class="in">`grades_r`</span>. Put another way, the location parameters of the distributions are the same across the three <span class="in">`grades_r`</span> levels. The Kruskal-Wallis test is the extension of the Wilcoxon-Mann-Whitney rank sum test to studies involving more than two independent samples.</span>
<span id="cb142-933"><a href="#cb142-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-934"><a href="#cb142-934" aria-hidden="true" tabindex="-1"></a><span class="in">```{r kruskal-wallis_test_for_2}</span></span>
<span id="cb142-935"><a href="#cb142-935" aria-hidden="true" tabindex="-1"></a><span class="in">kruskal.test(comfort_431 ~ grades_r, data = sur15_C)</span></span>
<span id="cb142-936"><a href="#cb142-936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-937"><a href="#cb142-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-938"><a href="#cb142-938" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This result suggests only that the separation we observe between the <span class="in">`comfort_431`</span> scores for the three <span class="in">`grades_r`</span> categories is consistent with some true differences between those groups. </span>
<span id="cb142-939"><a href="#cb142-939" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions of the Kruskal-Wallis test are the same as those of the Wilcoxon-Mann-Whitney rank sum test, specifically that </span>
<span id="cb142-940"><a href="#cb142-940" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each category are drawn independently of each other, </span>
<span id="cb142-941"><a href="#cb142-941" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>*and* that the samples in each category represent a random sample of the population of interest, </span>
<span id="cb142-942"><a href="#cb142-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-943"><a href="#cb142-943" aria-hidden="true" tabindex="-1"></a>The main problem here is that the sample size is so small that we can't tell whether this result is truly more or less reasonable than an ANOVA approach. We really need a minimum of 15 observations (and ideally more like 30) in each group to let our histograms and boxplots have any chance to be informative on these points. So let's look at the ANOVA results.</span>
<span id="cb142-944"><a href="#cb142-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-945"><a href="#cb142-945" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Variance</span></span>
<span id="cb142-946"><a href="#cb142-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-947"><a href="#cb142-947" aria-hidden="true" tabindex="-1"></a>The Analysis of Variance compares the means of <span class="in">`comfort_431`</span> in the three <span class="in">`grades_r`</span> populations. We can run the analysis using either of two approaches, each of which we'll show in what follows.</span>
<span id="cb142-948"><a href="#cb142-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-949"><a href="#cb142-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r anova_analysis_2_via_lm}</span></span>
<span id="cb142-950"><a href="#cb142-950" aria-hidden="true" tabindex="-1"></a><span class="in">lm(comfort_431 ~ grades_r, data = sur15_C) |&gt;</span></span>
<span id="cb142-951"><a href="#cb142-951" aria-hidden="true" tabindex="-1"></a><span class="in">  anova()</span></span>
<span id="cb142-952"><a href="#cb142-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-953"><a href="#cb142-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-954"><a href="#cb142-954" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Here, we'd conclude only that the results we have are not particularly consistent with an assumption that there are no differences between the population mean <span class="in">`comfort_431`</span> scores for the three <span class="in">`grades_r`</span> categories. </span>
<span id="cb142-955"><a href="#cb142-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The <span class="in">`grades_r`</span> account for $\eta^2 = \frac{3504.1}{3504.1 + 14004.7} = 0.2$ or 20% of the variation in <span class="in">`comfort_431`</span> scores in our sample.</span>
<span id="cb142-956"><a href="#cb142-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The natural next question is to try to identify which pairs of <span class="in">`grades_r`</span> categories show larger estimated differences, and we'll tackle that in a moment with Bonferroni/Holm and Tukey HSD approaches.</span>
<span id="cb142-957"><a href="#cb142-957" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ANOVA is the natural extension of the pooled t test for two independent samples, and so it has the same set of assumptions when we compare population means across multiple categories (here, the three <span class="in">`grades_r`</span> categories)...</span>
<span id="cb142-958"><a href="#cb142-958" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each category are drawn independently of each other, </span>
<span id="cb142-959"><a href="#cb142-959" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>that the samples in each category represent a random sample of the population of interest,</span>
<span id="cb142-960"><a href="#cb142-960" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>the samples in each category are drawn from a Normally distributed population, </span>
<span id="cb142-961"><a href="#cb142-961" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span>*and* that either the sample sizes or the population variances are equal across the categories.</span>
<span id="cb142-962"><a href="#cb142-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-963"><a href="#cb142-963" aria-hidden="true" tabindex="-1"></a>The main problem here is that the sample size is so small that we can't tell whether this result is truly reasonable or not. We really need a minimum of 15 observations (and ideally more like 30) in each group to let our histograms and boxplots have any chance to be informative on these points. We'll move on to looking at the pairwise comparisons, though, in this demonstration.</span>
<span id="cb142-964"><a href="#cb142-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-965"><a href="#cb142-965" aria-hidden="true" tabindex="-1"></a><span class="fu">### Holm approach to Pairwise Comparisons of Means</span></span>
<span id="cb142-966"><a href="#cb142-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-967"><a href="#cb142-967" aria-hidden="true" tabindex="-1"></a>We have two approaches available for dealing with multiple comparisons. If we had not pre-planned the full set of pairwise comparisons of <span class="in">`comfort_431`</span> across the <span class="in">`grades_r`</span> categories, or if we wanted to use a fairly conservative approach, we could apply a Holm correction to our comparisons. This works reasonably well even with an unbalanced design, such as we have here. </span>
<span id="cb142-968"><a href="#cb142-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-969"><a href="#cb142-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r holm_pairwise_comparisons_analysis2}</span></span>
<span id="cb142-970"><a href="#cb142-970" aria-hidden="true" tabindex="-1"></a><span class="in">pairwise.t.test(sur15_C$comfort_431, sur15_C$grades_r, </span></span>
<span id="cb142-971"><a href="#cb142-971" aria-hidden="true" tabindex="-1"></a><span class="in">                p.adjust = "holm")</span></span>
<span id="cb142-972"><a href="#cb142-972" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-973"><a href="#cb142-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-974"><a href="#cb142-974" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Our process detects positive differences between the mean of the Partner category and the means of the other two categories, but suggests that the difference between Individual and Group means covers both positive and negative values.</span>
<span id="cb142-975"><a href="#cb142-975" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The assumptions here include the ANOVA assumptions, which are no more or less justified than they were before. We do not, however, require that our pairwise comparisons be pre-planned.</span>
<span id="cb142-976"><a href="#cb142-976" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You can learn more about the Holm method <span class="co">[</span><span class="ot">on its Wikipedia page</span><span class="co">](https://en.wikipedia.org/wiki/Holm%E2%80%93Bonferroni_method)</span>.</span>
<span id="cb142-977"><a href="#cb142-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-978"><a href="#cb142-978" aria-hidden="true" tabindex="-1"></a><span class="fu">### Tukey's Honestly Significant Differences approach to Pairwise Comparisons of Means</span></span>
<span id="cb142-979"><a href="#cb142-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-980"><a href="#cb142-980" aria-hidden="true" tabindex="-1"></a>The Tukey HSD approach requires us to use the <span class="in">`aov`</span> approach to specifying the ANOVA model, as opposed to the <span class="in">`anova with lm`</span> approach we took above. The results for <span class="in">`aov`</span> are identical, as you can see below.</span>
<span id="cb142-981"><a href="#cb142-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-982"><a href="#cb142-982" aria-hidden="true" tabindex="-1"></a><span class="in">```{r show_aov_analysis2}</span></span>
<span id="cb142-983"><a href="#cb142-983" aria-hidden="true" tabindex="-1"></a><span class="in">aov(sur15_C$comfort_431 ~ sur15_C$grades_r) |&gt; summary()</span></span>
<span id="cb142-984"><a href="#cb142-984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-985"><a href="#cb142-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-986"><a href="#cb142-986" aria-hidden="true" tabindex="-1"></a>Now, we run the Tukey HSD comparisons, both in a plot and table of results. As specified previously, we'll use a 90% confidence level across the set of comparisons.</span>
<span id="cb142-987"><a href="#cb142-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-988"><a href="#cb142-988" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tukey_HSD_analysis2}</span></span>
<span id="cb142-989"><a href="#cb142-989" aria-hidden="true" tabindex="-1"></a><span class="in">TukeyHSD(aov(sur15_C$comfort_431 ~ sur15_C$grades_r), conf.level = 0.90)</span></span>
<span id="cb142-990"><a href="#cb142-990" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-991"><a href="#cb142-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-992"><a href="#cb142-992" aria-hidden="true" tabindex="-1"></a>The confidence intervals suggest that the mean Partner scores are lower than both the mean Individual and Group scores, while the Group and Individual scores show differences from each other that could have either sign. </span>
<span id="cb142-993"><a href="#cb142-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-994"><a href="#cb142-994" aria-hidden="true" tabindex="-1"></a>Note that in the plot below, we see these results a bit more clearly after we adjust the margins of the plot and use the <span class="in">`las = 1`</span> bit at the end of the plotting call to get the x and y axis labels to be horizontal.</span>
<span id="cb142-995"><a href="#cb142-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-996"><a href="#cb142-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot_Tukey_HSD_analysis2}</span></span>
<span id="cb142-997"><a href="#cb142-997" aria-hidden="true" tabindex="-1"></a><span class="in">mar.default &lt;- c(5,6,4,2) + 0.1</span></span>
<span id="cb142-998"><a href="#cb142-998" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = mar.default + c(0, 4, 0, 0))</span></span>
<span id="cb142-999"><a href="#cb142-999" aria-hidden="true" tabindex="-1"></a><span class="in">plot(TukeyHSD(aov(sur15_C$comfort_431 ~ sur15_C$grades_r),</span></span>
<span id="cb142-1000"><a href="#cb142-1000" aria-hidden="true" tabindex="-1"></a><span class="in">              conf.level = 0.90), las = 1)</span></span>
<span id="cb142-1001"><a href="#cb142-1001" aria-hidden="true" tabindex="-1"></a><span class="in">par(mar = mar.default)</span></span>
<span id="cb142-1002"><a href="#cb142-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1003"><a href="#cb142-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1004"><a href="#cb142-1004" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb142-1005"><a href="#cb142-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1006"><a href="#cb142-1006" aria-hidden="true" tabindex="-1"></a>Our conclusions are:</span>
<span id="cb142-1007"><a href="#cb142-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1008"><a href="#cb142-1008" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>that the sample size is just too small in the non-Individual <span class="in">`grades_r`</span> categories to draw very firm conclusions, but</span>
<span id="cb142-1009"><a href="#cb142-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>despite this, there appears to be evidence of some difference in <span class="in">`comfort_431`</span> across the three <span class="in">`grades_r`</span> categories, according to either an ANOVA or Kruskal-Wallis approach, at the 90% confidence level, and</span>
<span id="cb142-1010"><a href="#cb142-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>specifically, it appears from our 90% pairwise confidence intervals that the population means of the Group and Individual comfort levels are comparable and both are higher than the population mean of the Partner comfort levels.</span>
<span id="cb142-1011"><a href="#cb142-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1012"><a href="#cb142-1012" aria-hidden="true" tabindex="-1"></a>Note that I've made no effort here to write these conclusions in the format we're looking for in your Study 1 work.</span>
<span id="cb142-1013"><a href="#cb142-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1014"><a href="#cb142-1014" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis D: Two-Way (2 x 2) Contingency Table</span></span>
<span id="cb142-1015"><a href="#cb142-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1016"><a href="#cb142-1016" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Question</span></span>
<span id="cb142-1017"><a href="#cb142-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1018"><a href="#cb142-1018" aria-hidden="true" tabindex="-1"></a>We'll look at the association of <span class="in">`r_before`</span> with <span class="in">`english`</span> in this analysis. The <span class="in">`r_before`</span> variable and the <span class="in">`english`</span> variable each have two levels, and suppose we are interested in whether <span class="in">`english`</span> has an impact on <span class="in">`r_before`</span>, so we'll build a contingency table with <span class="in">`english`</span> in the rows and <span class="in">`r_before`</span> in the columns. **Note that we'll use a 90% confidence level and the add 2 successes and 2 failures Bayesian augmentation, and I encourage you to do this in your actual Project B Study 1 work, as well.** I'll remind you that in your Project B, we're requiring you to have a minimum number of observations within each cell of the table that I cannot meet here with this tiny sample size.</span>
<span id="cb142-1019"><a href="#cb142-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1020"><a href="#cb142-1020" aria-hidden="true" tabindex="-1"></a>If this were an actual Study 1, rather than a demonstration, I'd build a research question here, but I have decided to leave that work to you.</span>
<span id="cb142-1021"><a href="#cb142-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1022"><a href="#cb142-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing the Data</span></span>
<span id="cb142-1023"><a href="#cb142-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1024"><a href="#cb142-1024" aria-hidden="true" tabindex="-1"></a>Let's look at the 2x2 table we get. </span>
<span id="cb142-1025"><a href="#cb142-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1026"><a href="#cb142-1026" aria-hidden="true" tabindex="-1"></a><span class="in">```{r english_vs_priorr}</span></span>
<span id="cb142-1027"><a href="#cb142-1027" aria-hidden="true" tabindex="-1"></a><span class="in">table(sur15$english, sur15$r_before)</span></span>
<span id="cb142-1028"><a href="#cb142-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1029"><a href="#cb142-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1030"><a href="#cb142-1030" aria-hidden="true" tabindex="-1"></a>Those names could use some work, I think.</span>
<span id="cb142-1031"><a href="#cb142-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1032"><a href="#cb142-1032" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The row names, in order, should be something like "English" (where "Yes" is now) and "Not English" with "English" first</span>
<span id="cb142-1033"><a href="#cb142-1033" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The column names, respectively, should be "Prior R user" and "No Prior R", with "Prior R User" first.</span>
<span id="cb142-1034"><a href="#cb142-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1037"><a href="#cb142-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-1038"><a href="#cb142-1038" aria-hidden="true" tabindex="-1"></a>sur15_D <span class="ot">&lt;-</span> sur15 <span class="sc">|&gt;</span></span>
<span id="cb142-1039"><a href="#cb142-1039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(s_id, english, r_before) <span class="sc">|&gt;</span></span>
<span id="cb142-1040"><a href="#cb142-1040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">english_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(english),</span>
<span id="cb142-1041"><a href="#cb142-1041" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Not English"</span> <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb142-1042"><a href="#cb142-1042" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"English"</span> <span class="ot">=</span> <span class="st">"Yes"</span>),</span>
<span id="cb142-1043"><a href="#cb142-1043" aria-hidden="true" tabindex="-1"></a>         <span class="at">english_r =</span> <span class="fu">fct_relevel</span>(english_r, <span class="st">"English"</span>),</span>
<span id="cb142-1044"><a href="#cb142-1044" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_before_r =</span> <span class="fu">fct_recode</span>(<span class="fu">factor</span>(r_before),</span>
<span id="cb142-1045"><a href="#cb142-1045" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"No Prior R"</span> <span class="ot">=</span> <span class="st">"No"</span>,</span>
<span id="cb142-1046"><a href="#cb142-1046" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Prior R user"</span> <span class="ot">=</span> <span class="st">"Yes"</span>),</span>
<span id="cb142-1047"><a href="#cb142-1047" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_before_r =</span> <span class="fu">fct_relevel</span>(r_before_r, <span class="st">"Prior R user"</span>))</span>
<span id="cb142-1048"><a href="#cb142-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1049"><a href="#cb142-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1052"><a href="#cb142-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-1053"><a href="#cb142-1053" aria-hidden="true" tabindex="-1"></a>sur15_D <span class="sc">|&gt;</span> <span class="fu">tabyl</span>(english_r, r_before_r) </span>
<span id="cb142-1054"><a href="#cb142-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1055"><a href="#cb142-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1056"><a href="#cb142-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Analysis</span></span>
<span id="cb142-1057"><a href="#cb142-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1058"><a href="#cb142-1058" aria-hidden="true" tabindex="-1"></a>I **strongly encourage** you to use the Bayesian augmentation where we add two successes and add two failures, as recommended in Agresti and Coull\footnote{Agresti A Coull BA 1988 Approximate is Better than "Exact" for Interval Estimation of Binomial Proportions. The American Statistician 52(2), 119-126. http://www.jstor.org/stable/2685469}, and to use 90% confidence levels. To accomplish this I'll use the <span class="in">`twoby2`</span> function in the <span class="in">`Epi`</span> package.</span>
<span id="cb142-1059"><a href="#cb142-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1060"><a href="#cb142-1060" aria-hidden="true" tabindex="-1"></a><span class="in">```{r twoby2_analysis4}</span></span>
<span id="cb142-1061"><a href="#cb142-1061" aria-hidden="true" tabindex="-1"></a><span class="in">t1 &lt;- table(sur15_D$english_r, sur15_D$r_before_r)</span></span>
<span id="cb142-1062"><a href="#cb142-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1063"><a href="#cb142-1063" aria-hidden="true" tabindex="-1"></a><span class="in">twoby2(t1 + 2, conf.level = 0.90) </span></span>
<span id="cb142-1064"><a href="#cb142-1064" aria-hidden="true" tabindex="-1"></a><span class="in">  # uses Bayesian augmentation, 90% confidence level</span></span>
<span id="cb142-1065"><a href="#cb142-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1066"><a href="#cb142-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1067"><a href="#cb142-1067" aria-hidden="true" tabindex="-1"></a>Note what I did to add two observations to each cell of the table. We can draw conclusions now about:</span>
<span id="cb142-1068"><a href="#cb142-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1069"><a href="#cb142-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The individual probabilities of being a prior R user in the English and non-English groups, and 90% confidence intervals for each at the top of the output, so that, for instance, we estimate the probability of prior R usage among subjects for whom English is not their best language at 0.45, with 90% confidence interval (0.29, 0.63).</span>
<span id="cb142-1070"><a href="#cb142-1070" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The relative risk of Prior R use given English vs. Prior R use given non-English, which is estimated to be 1.07, and based on its 90% confidence interval is clearly not detectably different from 1 at $\alpha = 0.10$.</span>
<span id="cb142-1071"><a href="#cb142-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The odds ratio describing the odds of Prior R use given English vs. Non-English, which is estimated to be 1.14, and is clearly not detectably different from 1 at $\alpha = 0.10$.</span>
<span id="cb142-1072"><a href="#cb142-1072" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The difference in probability of Prior R use for English vs. non-English subjects, which is estimated to be 0.033, with a 90% confidence interval of (-0.18, 0.24) and is not detectably different from 0 at $\alpha = 0.10$.</span>
<span id="cb142-1073"><a href="#cb142-1073" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The chi-square test of independence, which assesses the null hypothesis of no association between language preference and prior R usage, using either Fisher's exact test\footnote{I use Fisher's exact test with small-ish 2x2 tables where R will run it, if you have to choose between the methods.} or the Pearson chi-square test (labeled asymptotic here.) The evidence does not let us reject the null hypothesis.</span>
<span id="cb142-1074"><a href="#cb142-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1075"><a href="#cb142-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking Assumptions</span></span>
<span id="cb142-1076"><a href="#cb142-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1077"><a href="#cb142-1077" aria-hidden="true" tabindex="-1"></a>Since each cell in our (non-augmented) 2x2 table is at least 5, R throws no warning messages. We should be reasonably comfortable with the chi-square test of independence here. If every cell was 10 or more, we'd be even more comfortable.</span>
<span id="cb142-1078"><a href="#cb142-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1079"><a href="#cb142-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">### What If We Wanted to Type in the Table Ourselves?</span></span>
<span id="cb142-1080"><a href="#cb142-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1081"><a href="#cb142-1081" aria-hidden="true" tabindex="-1"></a>With the <span class="in">`twobytwo`</span> function available in the <span class="in">`Love-boost.R`</span> script, we can directly obtain 90% confidence intervals. For example, suppose we had the following data, pulled from our 2016 survey:</span>
<span id="cb142-1082"><a href="#cb142-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1083"><a href="#cb142-1083" aria-hidden="true" tabindex="-1"></a>2016 Survey    | Drank Tea Recently | Didn't Drink Tea</span>
<span id="cb142-1084"><a href="#cb142-1084" aria-hidden="true" tabindex="-1"></a>-------------: | -----------------: | ---------------:</span>
<span id="cb142-1085"><a href="#cb142-1085" aria-hidden="true" tabindex="-1"></a>Not Born in US | 21 | 10</span>
<span id="cb142-1086"><a href="#cb142-1086" aria-hidden="true" tabindex="-1"></a>US Born        | 20 | 18</span>
<span id="cb142-1087"><a href="#cb142-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1088"><a href="#cb142-1088" aria-hidden="true" tabindex="-1"></a>Suppose we wanted to use <span class="in">`twobytwo`</span> and the +2/+4 Bayesian augmentation (adding 2 to the count in each cell of our 2x2 table) and a 90% confidence interval for this comparison, to see whether the population proportions who drank tea recently differ between those born in and out of the US.</span>
<span id="cb142-1089"><a href="#cb142-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1090"><a href="#cb142-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```{r twobytwo for new example}</span></span>
<span id="cb142-1091"><a href="#cb142-1091" aria-hidden="true" tabindex="-1"></a><span class="in">twobytwo(21+2, 10+2, 20+2, 18+2,</span></span>
<span id="cb142-1092"><a href="#cb142-1092" aria-hidden="true" tabindex="-1"></a><span class="in">         "Not US Born", "US Born", "Drank Tea", "No Tea",</span></span>
<span id="cb142-1093"><a href="#cb142-1093" aria-hidden="true" tabindex="-1"></a><span class="in">         conf.level = 0.90)</span></span>
<span id="cb142-1094"><a href="#cb142-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1095"><a href="#cb142-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1096"><a href="#cb142-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb142-1097"><a href="#cb142-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1098"><a href="#cb142-1098" aria-hidden="true" tabindex="-1"></a>Our primary conclusions about the study we've done here in Analysis D should be motivated by the fact that the 90% confidence intervals for the RR and the OR cross 1, and that the probability difference isn't detectably different from 0, either, with 90% confidence.</span>
<span id="cb142-1099"><a href="#cb142-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1100"><a href="#cb142-1100" aria-hidden="true" tabindex="-1"></a>Then we'd write more about limitations and opportunities for further work, were this an actual Study 1, instead of just a demonstration. </span>
<span id="cb142-1101"><a href="#cb142-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1102"><a href="#cb142-1102" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis E: Two-Way (3 x 4) Contingency Table</span></span>
<span id="cb142-1103"><a href="#cb142-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1104"><a href="#cb142-1104" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Question</span></span>
<span id="cb142-1105"><a href="#cb142-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1106"><a href="#cb142-1106" aria-hidden="true" tabindex="-1"></a>We'll look at the association of two categorical factors we created earlier: <span class="in">`medium_r`</span> and <span class="in">`fiction_r`</span> in this analysis. We're interested in whether there is an association between the ways in which subjects consumed their fiction, and the type of fiction they most enjoy. The <span class="in">`medium_r`</span> data have three levels, and the <span class="in">`fiction_r`</span> data have four levels. **Note that we'll use a 90% confidence level and I encourage you to do this in your actual Project B Study 1 work, as well.**</span>
<span id="cb142-1107"><a href="#cb142-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1108"><a href="#cb142-1108" aria-hidden="true" tabindex="-1"></a>If this were an actual Study 1, rather than a demonstration, I'd build a research question here, but I have decided to leave that work to you.</span>
<span id="cb142-1109"><a href="#cb142-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1110"><a href="#cb142-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Describing the Data</span></span>
<span id="cb142-1111"><a href="#cb142-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1112"><a href="#cb142-1112" aria-hidden="true" tabindex="-1"></a>Let's store this initial table of interest as <span class="in">`table_E1`</span> </span>
<span id="cb142-1113"><a href="#cb142-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1116"><a href="#cb142-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-1117"><a href="#cb142-1117" aria-hidden="true" tabindex="-1"></a>table_E1 <span class="ot">&lt;-</span> <span class="fu">table</span>(sur15<span class="sc">$</span>medium_r, sur15<span class="sc">$</span>fiction_r)</span>
<span id="cb142-1118"><a href="#cb142-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1119"><a href="#cb142-1119" aria-hidden="true" tabindex="-1"></a>table_E1</span>
<span id="cb142-1120"><a href="#cb142-1120" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1121"><a href="#cb142-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1122"><a href="#cb142-1122" aria-hidden="true" tabindex="-1"></a>We could add the marginal totals, I suppose.</span>
<span id="cb142-1123"><a href="#cb142-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1124"><a href="#cb142-1124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r medium_fiction_table}</span></span>
<span id="cb142-1125"><a href="#cb142-1125" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 |&gt;</span></span>
<span id="cb142-1126"><a href="#cb142-1126" aria-hidden="true" tabindex="-1"></a><span class="in">  tabyl(medium_r, fiction_r) |&gt;</span></span>
<span id="cb142-1127"><a href="#cb142-1127" aria-hidden="true" tabindex="-1"></a><span class="in">  adorn_totals(where = c("row", "col"))</span></span>
<span id="cb142-1128"><a href="#cb142-1128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1129"><a href="#cb142-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1130"><a href="#cb142-1130" aria-hidden="true" tabindex="-1"></a>Note that we don't meet the Cochran conditions here. In particular, we still have a 0 cell, and that might motivate us to consider collapsing or removing the "Other" category from the <span class="in">`fiction_r`</span> variable. </span>
<span id="cb142-1131"><a href="#cb142-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1132"><a href="#cb142-1132" aria-hidden="true" tabindex="-1"></a>**NOTE**: In doing your project B, I would only proceed once I'd identified variables (after whatever collapsing you decide to do) that meet the Cochran conditions (described below.)</span>
<span id="cb142-1133"><a href="#cb142-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1134"><a href="#cb142-1134" aria-hidden="true" tabindex="-1"></a>I'll leave it alone for now, and see what happens, returning to this later. The research question, if I'd written would need to address whether which medium (Movies, TV or other) you like is associated with which genre (Comedy, Drama, Fantasy/SF) you prefer.</span>
<span id="cb142-1135"><a href="#cb142-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1136"><a href="#cb142-1136" aria-hidden="true" tabindex="-1"></a><span class="fu">## Main Analysis</span></span>
<span id="cb142-1137"><a href="#cb142-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1138"><a href="#cb142-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">### Running the Pearson $\chi^2$ Test</span></span>
<span id="cb142-1139"><a href="#cb142-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1140"><a href="#cb142-1140" aria-hidden="true" tabindex="-1"></a>We'll run the Pearson $\chi^2$ test using:</span>
<span id="cb142-1141"><a href="#cb142-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1142"><a href="#cb142-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r pearson_chi-square_table_E1}</span></span>
<span id="cb142-1143"><a href="#cb142-1143" aria-hidden="true" tabindex="-1"></a><span class="in">chisq.test(table_E1)</span></span>
<span id="cb142-1144"><a href="#cb142-1144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1145"><a href="#cb142-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1146"><a href="#cb142-1146" aria-hidden="true" tabindex="-1"></a>Note the warning, because our table does not meet the Cochran conditions.</span>
<span id="cb142-1147"><a href="#cb142-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1148"><a href="#cb142-1148" aria-hidden="true" tabindex="-1"></a><span class="fu">### Running Fisher's Exact Test</span></span>
<span id="cb142-1149"><a href="#cb142-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1150"><a href="#cb142-1150" aria-hidden="true" tabindex="-1"></a>**NOTE**: In doing your project B, I would only proceed once I'd identified variables (after whatever collapsing you decide to do) that meet the Cochran conditions (described below.) I would not run Fisher's test.</span>
<span id="cb142-1151"><a href="#cb142-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1152"><a href="#cb142-1152" aria-hidden="true" tabindex="-1"></a>Given a small overall sample size, the <span class="in">`fisher.test`</span> command will also produce a Fisher's exact test, which may be a little more appropriate here, given the presence of cells with small counts.</span>
<span id="cb142-1153"><a href="#cb142-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1154"><a href="#cb142-1154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fisher_exact_for_table_E1}</span></span>
<span id="cb142-1155"><a href="#cb142-1155" aria-hidden="true" tabindex="-1"></a><span class="in">fisher.test(table_E1)</span></span>
<span id="cb142-1156"><a href="#cb142-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1157"><a href="#cb142-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1158"><a href="#cb142-1158" aria-hidden="true" tabindex="-1"></a>Based on the Fisher test, we would get only a slightly different conclusion than the Pearson test. However, </span>
<span id="cb142-1159"><a href="#cb142-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1160"><a href="#cb142-1160" aria-hidden="true" tabindex="-1"></a>a. Our conclusions are quite dependent on the choice of $\alpha$ level.</span>
<span id="cb142-1161"><a href="#cb142-1161" aria-hidden="true" tabindex="-1"></a>b. Neither test is really appropriate, since we have very small cell counts, including a zero.</span>
<span id="cb142-1162"><a href="#cb142-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1163"><a href="#cb142-1163" aria-hidden="true" tabindex="-1"></a><span class="fu">### Checking Assumptions - The Cochran Conditions</span></span>
<span id="cb142-1164"><a href="#cb142-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1165"><a href="#cb142-1165" aria-hidden="true" tabindex="-1"></a>The "Cochran conditions", which require that we have:</span>
<span id="cb142-1166"><a href="#cb142-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1167"><a href="#cb142-1167" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>no cells with 0 counts</span>
<span id="cb142-1168"><a href="#cb142-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>at least 80% of the cells in our table with counts of 5 or higher</span>
<span id="cb142-1169"><a href="#cb142-1169" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>expected counts in each cell of the table should be 5 or more</span>
<span id="cb142-1170"><a href="#cb142-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1171"><a href="#cb142-1171" aria-hidden="true" tabindex="-1"></a>We don't meet those Cochran conditions here. In addition, since each cell in our 3x4 table is NOT at least 5, R throws a warning message when we run the Pearson $\chi^2$ test, and since we don't meet the Cochran conditions, the <span class="in">`fisher.test`</span> results are questionable, as well. We should consider whether collapsing or deleting some of the rows or columns might be more reasonable. And we'll do this next.</span>
<span id="cb142-1172"><a href="#cb142-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1173"><a href="#cb142-1173" aria-hidden="true" tabindex="-1"></a><span class="fu">### An Association Plot for the 3x4 Table</span></span>
<span id="cb142-1174"><a href="#cb142-1174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1175"><a href="#cb142-1175" aria-hidden="true" tabindex="-1"></a>The <span class="in">`assocplot`</span> function in R produces a plot that indicates deviations from the assumption of independence of rows and columns in a two-way table. For instance, using our original table, we have:</span>
<span id="cb142-1176"><a href="#cb142-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1177"><a href="#cb142-1177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r assoc_plot_table_E1, fig.height = 6}</span></span>
<span id="cb142-1178"><a href="#cb142-1178" aria-hidden="true" tabindex="-1"></a><span class="in">assocplot(table_E1)</span></span>
<span id="cb142-1179"><a href="#cb142-1179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1180"><a href="#cb142-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1181"><a href="#cb142-1181" aria-hidden="true" tabindex="-1"></a>We can see that the independence model really doesn't work well for the cells with larger shapes here, which we note especially in the Fantasy/SF category, and to some extent in the Comedy category.</span>
<span id="cb142-1182"><a href="#cb142-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1183"><a href="#cb142-1183" aria-hidden="true" tabindex="-1"></a>**Hint**: Finding a better scheme for visualizing a contingency table's relationship to independence (or simply the table itself), especially if it's using the <span class="in">`gt`</span> package, would be a good idea to explore further in Analysis E, too, especially if you're looking to learn to build savvy tables. But this is not necessary, certainly.</span>
<span id="cb142-1184"><a href="#cb142-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1185"><a href="#cb142-1185" aria-hidden="true" tabindex="-1"></a><span class="fu">### A 2x3 Table, After Collapsing (Lumping) Some Small Rows and Columns</span></span>
<span id="cb142-1186"><a href="#cb142-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1187"><a href="#cb142-1187" aria-hidden="true" tabindex="-1"></a>Suppose we instead decided to drop down to a study of TV vs. Other media (combining Movies and Other) and also collapsed the Fantasy/SF and Other columns (so the remaining subjects form a 2x3 table), in an effort to remove zero cells, and reduce the incidence of cells with counts below 5.</span>
<span id="cb142-1188"><a href="#cb142-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1189"><a href="#cb142-1189" aria-hidden="true" tabindex="-1"></a>First, we'll combine the Movies and Other groups to create <span class="in">`medium_2`</span> from <span class="in">`medium_r`</span> using <span class="in">`fct_recode`</span>.</span>
<span id="cb142-1190"><a href="#cb142-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1191"><a href="#cb142-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```{r create_medium_2}</span></span>
<span id="cb142-1192"><a href="#cb142-1192" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 &lt;- sur15 |&gt;</span></span>
<span id="cb142-1193"><a href="#cb142-1193" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(medium_2 = fct_recode(medium_r, </span></span>
<span id="cb142-1194"><a href="#cb142-1194" aria-hidden="true" tabindex="-1"></a><span class="in">                                "Not TV" = "Movies",</span></span>
<span id="cb142-1195"><a href="#cb142-1195" aria-hidden="true" tabindex="-1"></a><span class="in">                                "TV" = "TV",</span></span>
<span id="cb142-1196"><a href="#cb142-1196" aria-hidden="true" tabindex="-1"></a><span class="in">                                "Not TV" = "Other"))</span></span>
<span id="cb142-1197"><a href="#cb142-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1198"><a href="#cb142-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1199"><a href="#cb142-1199" aria-hidden="true" tabindex="-1"></a>Or, we can use the <span class="in">`fct_lump`</span> function to lump together the two categories with the smallest overall counts directly, in creating <span class="in">`fiction_3`</span> from <span class="in">`fiction_r`</span>.</span>
<span id="cb142-1200"><a href="#cb142-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1201"><a href="#cb142-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lump_fiction_r_to_get_fiction_3}</span></span>
<span id="cb142-1202"><a href="#cb142-1202" aria-hidden="true" tabindex="-1"></a><span class="in">sur15 &lt;- sur15 |&gt;</span></span>
<span id="cb142-1203"><a href="#cb142-1203" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(fiction_3 = fct_lump(fiction_r, 2))</span></span>
<span id="cb142-1204"><a href="#cb142-1204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1205"><a href="#cb142-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1206"><a href="#cb142-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1207"><a href="#cb142-1207" aria-hidden="true" tabindex="-1"></a>Let's call the collapsed table <span class="in">`table_E2`</span>. </span>
<span id="cb142-1208"><a href="#cb142-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1209"><a href="#cb142-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table_E2}</span></span>
<span id="cb142-1210"><a href="#cb142-1210" aria-hidden="true" tabindex="-1"></a><span class="in">table_E2 &lt;- </span></span>
<span id="cb142-1211"><a href="#cb142-1211" aria-hidden="true" tabindex="-1"></a><span class="in">  table(sur15$medium_2, sur15$fiction_3)</span></span>
<span id="cb142-1212"><a href="#cb142-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1213"><a href="#cb142-1213" aria-hidden="true" tabindex="-1"></a><span class="in">table_E2</span></span>
<span id="cb142-1214"><a href="#cb142-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1215"><a href="#cb142-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1216"><a href="#cb142-1216" aria-hidden="true" tabindex="-1"></a>This new 2x3 table loses some fidelity, but gains in that each cell now contains at least 5 subjects. I'll remind you that in your Project B, we're requiring you to have even more than that in each cell.</span>
<span id="cb142-1217"><a href="#cb142-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1218"><a href="#cb142-1218" aria-hidden="true" tabindex="-1"></a><span class="fu">### Chi-Square Testing for the 2x3 Table</span></span>
<span id="cb142-1219"><a href="#cb142-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1220"><a href="#cb142-1220" aria-hidden="true" tabindex="-1"></a>And here are the results from chi-square testing...</span>
<span id="cb142-1221"><a href="#cb142-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1222"><a href="#cb142-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table_E2_testing}</span></span>
<span id="cb142-1223"><a href="#cb142-1223" aria-hidden="true" tabindex="-1"></a><span class="in">chisq.test(table_E2)</span></span>
<span id="cb142-1224"><a href="#cb142-1224" aria-hidden="true" tabindex="-1"></a><span class="in">fisher.test(table_E2)</span></span>
<span id="cb142-1225"><a href="#cb142-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1226"><a href="#cb142-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1227"><a href="#cb142-1227" aria-hidden="true" tabindex="-1"></a>For the project, once all of the cells have at least 5 observations, I recommend the use of the Pearson approach, unless the table is square (# of rows = # of columns), in which case the Fisher test is also a reasonable choice. Generally, the Fisher test is more appropriate when the sample sizes are small. In this case, of course, it doesn't matter much after collapsing cells and forming this 2x3 table. We'll close with the association plot for this smaller table, which suggests that the independence model inverts its errors for Comedy as compared to the other two categories. </span>
<span id="cb142-1228"><a href="#cb142-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1229"><a href="#cb142-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table_E2_assocplot, fig.height = 4}</span></span>
<span id="cb142-1230"><a href="#cb142-1230" aria-hidden="true" tabindex="-1"></a><span class="in">assocplot(table_E2)</span></span>
<span id="cb142-1231"><a href="#cb142-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb142-1232"><a href="#cb142-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1233"><a href="#cb142-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb142-1234"><a href="#cb142-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1235"><a href="#cb142-1235" aria-hidden="true" tabindex="-1"></a>Using the collapsed <span class="in">`table_E2`</span> to meet the Cochran conditions, and either the Pearson or Fisher test we detect no strong association between the favorite consumption method and favorite genre. I'd also spend a bit of time talking about the results of the <span class="in">`assocplot`</span>, I think, or at least make some effort to indicate where the independence assumption holds less well, even though it doesn't reach the point where we can reject it with 90% confidence.</span>
<span id="cb142-1236"><a href="#cb142-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1237"><a href="#cb142-1237" aria-hidden="true" tabindex="-1"></a>Again, it's your job to identify and discuss your conclusions, as expected in the instructions for Project B Study 1. This is just a demonstration.</span>
<span id="cb142-1238"><a href="#cb142-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1239"><a href="#cb142-1239" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session Information</span></span>
<span id="cb142-1240"><a href="#cb142-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1241"><a href="#cb142-1241" aria-hidden="true" tabindex="-1"></a>End your report with the session information, in its own section. This will be Section 8 for you, but it's Section 9 for me because I did all five analyses, whereas you will only do four.</span>
<span id="cb142-1242"><a href="#cb142-1242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-1245"><a href="#cb142-1245" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb142-1246"><a href="#cb142-1246" aria-hidden="true" tabindex="-1"></a><span class="fu">session_info</span>()</span>
<span id="cb142-1247"><a href="#cb142-1247" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>